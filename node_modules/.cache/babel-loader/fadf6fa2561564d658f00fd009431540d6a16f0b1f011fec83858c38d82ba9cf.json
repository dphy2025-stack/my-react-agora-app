{"ast":null,"code":"import React, { useRef, useContext, useState, useReducer, useEffect, createContext } from 'react';\nimport AgoraRTC, { createClient, AgoraVideoPlayer, createMicrophoneAndCameraTracks } from 'agora-rtc-react';\nimport AgoraRTM, { createLazyChannel, createLazyClient } from 'agora-rtm-react';\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\n\n// A type of promise-like that resolves synchronously and supports only one observer\n\nconst _iteratorSymbol = /*#__PURE__*/typeof Symbol !== \"undefined\" ? Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\")) : \"@@iterator\";\nconst _asyncIteratorSymbol = /*#__PURE__*/typeof Symbol !== \"undefined\" ? Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\")) : \"@@asyncIterator\";\n\n// Asynchronously call a function and send errors to recovery continuation\nfunction _catch(body, recover) {\n  try {\n    var result = body();\n  } catch (e) {\n    return recover(e);\n  }\n  if (result && result.then) {\n    return result.then(void 0, recover);\n  }\n  return result;\n}\nvar RtcContext = React.createContext({});\nvar RtcProvider = RtcContext.Provider;\nvar RtcConsumer = RtcContext.Consumer;\nvar remoteTrackState;\n(function (remoteTrackState) {\n  remoteTrackState[remoteTrackState[\"yes\"] = 0] = \"yes\";\n  remoteTrackState[remoteTrackState[\"subbed\"] = 1] = \"subbed\";\n  remoteTrackState[remoteTrackState[\"no\"] = 2] = \"no\";\n})(remoteTrackState || (remoteTrackState = {}));\nvar layout;\n(function (layout) {\n  layout[layout[\"grid\"] = 0] = \"grid\";\n  layout[layout[\"pin\"] = 1] = \"pin\";\n})(layout || (layout = {}));\nvar ToggleState;\n(function (ToggleState) {\n  ToggleState[ToggleState[\"disabled\"] = 0] = \"disabled\";\n  ToggleState[ToggleState[\"enabled\"] = 1] = \"enabled\";\n  ToggleState[ToggleState[\"disabling\"] = 2] = \"disabling\";\n  ToggleState[ToggleState[\"enabling\"] = 3] = \"enabling\";\n})(ToggleState || (ToggleState = {}));\nvar initialValue = {\n  rtcProps: {\n    appId: '',\n    channel: '',\n    role: 'host'\n  },\n  rtmProps: {}\n};\nvar PropsContext = React.createContext(initialValue);\nvar PropsProvider = PropsContext.Provider;\nvar MaxUidContext = React.createContext([]);\nvar MaxUidProvider = MaxUidContext.Provider;\nvar MaxUidConsumer = MaxUidContext.Consumer;\nvar MinUidContext = React.createContext([]);\nvar MinUidProvider = MinUidContext.Provider;\nvar MinUidConsumer = MinUidContext.Consumer;\nvar TracksContext = React.createContext({});\nvar TracksProvider = TracksContext.Provider;\nvar initState = {\n  max: [{\n    uid: 0,\n    hasAudio: remoteTrackState.no,\n    hasVideo: remoteTrackState.no\n  }],\n  min: [],\n  isScreensharing: false\n};\nvar reducer = function reducer(state, action) {\n  var stateUpdate = initState;\n  var uids = [].concat(state.max, state.min).map(function (u) {\n    return u.uid;\n  });\n  switch (action.type) {\n    case 'Screensharing':\n      {\n        stateUpdate = _extends({}, state, {\n          isScreensharing: action.value[0]\n        });\n        console.log('!Screensharingstate', state, stateUpdate);\n      }\n      break;\n    case 'update-user-video':\n      {\n        stateUpdate = {\n          min: state.min.map(function (user) {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: remoteTrackState.subbed,\n                hasVideo: remoteTrackState.subbed\n              };\n            } else {\n              return user;\n            }\n          }),\n          max: state.max.map(function (user) {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: remoteTrackState.subbed,\n                hasVideo: remoteTrackState.subbed\n              };\n            } else {\n              return user;\n            }\n          }),\n          isScreensharing: state.isScreensharing\n        };\n      }\n      break;\n    case 'user-joined':\n      {\n        if (uids.indexOf(action.value[0].uid) === -1) {\n          var minUpdate = [].concat(state.min, [{\n            uid: action.value[0].uid,\n            hasAudio: remoteTrackState.no,\n            hasVideo: remoteTrackState.no\n          }]);\n          if (minUpdate.length === 1 && state.max[0].uid === 0) {\n            stateUpdate = {\n              max: minUpdate,\n              min: state.max,\n              isScreensharing: state.isScreensharing\n            };\n          } else {\n            stateUpdate = {\n              min: minUpdate,\n              max: state.max,\n              isScreensharing: state.isScreensharing\n            };\n          }\n        }\n      }\n      break;\n    case 'user-unpublished':\n      {\n        if (state.max[0].uid === action.value[0].uid) {\n          stateUpdate = {\n            max: [{\n              uid: action.value[0].uid,\n              hasAudio: action.value[1] === 'audio' ? remoteTrackState.no : state.max[0].hasAudio,\n              hasVideo: action.value[1] === 'video' ? remoteTrackState.no : state.max[0].hasVideo\n            }],\n            min: state.min,\n            isScreensharing: state.isScreensharing\n          };\n        } else {\n          var UIKitUser = state.min.find(function (user) {\n            return user.uid === action.value[0].uid;\n          });\n          if (UIKitUser) {\n            var _minUpdate = [].concat(state.min.filter(function (user) {\n              return user.uid !== action.value[0].uid;\n            }), [{\n              uid: action.value[0].uid,\n              hasAudio: action.value[1] === 'audio' ? remoteTrackState.no : UIKitUser.hasAudio,\n              hasVideo: action.value[1] === 'video' ? remoteTrackState.no : UIKitUser.hasVideo\n            }]);\n            stateUpdate = {\n              min: _minUpdate,\n              max: state.max,\n              isScreensharing: state.isScreensharing\n            };\n          }\n        }\n      }\n      break;\n    case 'user-published':\n      {\n        if (state.max[0].uid === action.value[0].uid) {\n          stateUpdate = {\n            max: [{\n              uid: action.value[0].uid,\n              hasAudio: action.value[1] === 'audio' ? remoteTrackState.subbed : state.max[0].hasAudio,\n              hasVideo: action.value[1] === 'video' ? remoteTrackState.subbed : state.max[0].hasVideo\n            }],\n            min: state.min,\n            isScreensharing: state.isScreensharing\n          };\n        } else {\n          stateUpdate = {\n            min: state.min.map(function (user) {\n              if (user.uid !== action.value[0].uid) {\n                return user;\n              } else {\n                return {\n                  uid: user.uid,\n                  hasAudio: action.value[1] === 'audio' ? remoteTrackState.subbed : user.hasAudio,\n                  hasVideo: action.value[1] === 'video' ? remoteTrackState.subbed : user.hasVideo\n                };\n              }\n            }),\n            max: state.max,\n            isScreensharing: state.isScreensharing\n          };\n        }\n      }\n      break;\n    case 'user-left':\n      {\n        if (state.max[0].uid === action.value[0].uid) {\n          var _minUpdate2 = [].concat(state.min);\n          stateUpdate = {\n            max: [_minUpdate2.pop()],\n            min: _minUpdate2,\n            isScreensharing: state.isScreensharing\n          };\n        } else {\n          stateUpdate = {\n            min: state.min.filter(function (user) {\n              return user.uid !== action.value[0].uid;\n            }),\n            max: state.max,\n            isScreensharing: state.isScreensharing\n          };\n        }\n      }\n      break;\n    case 'user-swap':\n      {\n        if (state.max[0].uid === action.value[0].uid) ;else {\n          stateUpdate = {\n            max: [action.value[0]],\n            min: [].concat(state.min.filter(function (user) {\n              return user.uid !== action.value[0].uid;\n            }), [state.max[0]]),\n            isScreensharing: state.isScreensharing\n          };\n        }\n      }\n      break;\n    case 'local-user-mute-video':\n      {\n        stateUpdate = {\n          min: state.min.map(function (user) {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: user.hasAudio,\n                hasVideo: action.value[0]\n              };\n            } else {\n              return user;\n            }\n          }),\n          max: state.max.map(function (user) {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: user.hasAudio,\n                hasVideo: action.value[0]\n              };\n            } else {\n              return user;\n            }\n          }),\n          isScreensharing: state.isScreensharing\n        };\n      }\n      break;\n    case 'local-user-mute-audio':\n      {\n        stateUpdate = {\n          min: state.min.map(function (user) {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: action.value[0],\n                hasVideo: user.hasVideo\n              };\n            } else {\n              return user;\n            }\n          }),\n          max: state.max.map(function (user) {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: action.value[0],\n                hasVideo: user.hasVideo\n              };\n            } else {\n              return user;\n            }\n          }),\n          isScreensharing: state.isScreensharing\n        };\n      }\n      break;\n    case 'remote-user-mute-video':\n      {\n        stateUpdate = {\n          min: state.min.map(function (user) {\n            if (user.uid === action.value[0].uid) {\n              return {\n                uid: user.uid,\n                hasVideo: action.value[1],\n                hasAudio: user.hasAudio\n              };\n            } else return user;\n          }),\n          max: state.max.map(function (user) {\n            if (user.uid === action.value[0].uid) return {\n              uid: user.uid,\n              hasVideo: action.value[1],\n              hasAudio: user.hasAudio\n            };else return user;\n          }),\n          isScreensharing: state.isScreensharing\n        };\n      }\n      break;\n    case 'remote-user-mute-audio':\n      {\n        stateUpdate = {\n          min: state.min.map(function (user) {\n            if (user.uid === action.value[0].uid) return {\n              uid: user.uid,\n              hasAudio: action.value[1],\n              hasVideo: user.hasVideo\n            };else return user;\n          }),\n          max: state.max.map(function (user) {\n            if (user.uid === action.value[0].uid) return {\n              uid: user.uid,\n              hasAudio: action.value[1],\n              hasVideo: user.hasVideo\n            };else return user;\n          }),\n          isScreensharing: state.isScreensharing\n        };\n      }\n      break;\n    case 'leave-channel':\n      stateUpdate = initState;\n      break;\n    case 'ActiveSpeaker':\n      {\n        if (state.max[0].uid === action.value[0]) {\n          stateUpdate = _extends({}, state);\n        } else {\n          stateUpdate = {\n            max: [state.min.find(function (user) {\n              return user.uid === action.value[0];\n            })],\n            min: [].concat(state.min.filter(function (user) {\n              return user.uid !== action.value[0];\n            }), [state.max[0]]),\n            isScreensharing: state.isScreensharing\n          };\n        }\n      }\n      break;\n  }\n  console.log('!state-update', _extends({}, state, stateUpdate), stateUpdate);\n  return _extends({}, state, stateUpdate);\n};\nvar startScreenshare = function startScreenshare(appId, channel, track, screenshareToken, screenshareUid, tokenUrl, enableDualStream) {\n  try {\n    var init = function init() {\n      try {\n        try {\n          console.log(screenClient);\n          if (tokenUrl) {\n            screenClient.on('token-privilege-will-expire', function () {\n              try {\n                console.log('token will expire');\n                return Promise.resolve(fetch(tokenUrl + '/rtc/' + channel + '/publisher/uid/' + uid + '/')).then(function (res) {\n                  return Promise.resolve(res.json()).then(function (data) {\n                    var token = data.rtcToken;\n                    screenClient.renewToken(token);\n                  });\n                });\n              } catch (e) {\n                return Promise.reject(e);\n              }\n            });\n            screenClient.on('token-privilege-did-expire', function () {\n              try {\n                return Promise.resolve(fetch(tokenUrl + '/rtc/' + channel + '/publisher/uid/' + uid + '/')).then(function (res) {\n                  return Promise.resolve(res.json()).then(function (data) {\n                    var token = data.rtcToken;\n                    screenClient.renewToken(token);\n                  });\n                });\n              } catch (e) {\n                return Promise.reject(e);\n              }\n            });\n          }\n          track.on('track-ended', function () {\n            screenClient.leave();\n            screenClient.removeAllListeners();\n          });\n        } catch (e) {\n          console.log(e);\n        }\n        return Promise.resolve();\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    };\n    var join = function join() {\n      try {\n        screenClient.setClientRole('host');\n        var _temp3 = function () {\n          if (tokenUrl) {\n            var _temp4 = _catch(function () {\n              return Promise.resolve(fetch(tokenUrl + '/rtc/' + channel + '/publisher/uid/' + uid + '/')).then(function (res) {\n                return Promise.resolve(res.json()).then(function (data) {\n                  var token = data.rtcToken;\n                  return Promise.resolve(screenClient.join(appId, channel, token, uid)).then(function (_screenClient$join) {\n                    returnedUid = _screenClient$join;\n                  });\n                });\n              });\n            }, function (e) {\n              console.log(e);\n            });\n            if (_temp4 && _temp4.then) return _temp4.then(function () {});\n          } else {\n            return Promise.resolve(screenClient.join(appId, channel, screenshareToken || null, uid || 0)).then(function (_screenClient$join2) {\n              returnedUid = _screenClient$join2;\n            });\n          }\n        }();\n        return Promise.resolve(_temp3 && _temp3.then ? _temp3.then(function () {}) : void 0);\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    };\n    var publish = function publish() {\n      try {\n        var _temp10 = function _temp10() {\n          var _temp6 = function () {\n            if (track.enabled) {\n              var _temp9 = function () {\n                if (!localVideoTrackHasPublished) {\n                  return Promise.resolve(screenClient.publish([track]).then(function () {\n                    localVideoTrackHasPublished = true;\n                  })).then(function () {});\n                }\n              }();\n              if (_temp9 && _temp9.then) return _temp9.then(function () {});\n            }\n          }();\n          if (_temp6 && _temp6.then) return _temp6.then(function () {});\n        };\n        var _temp11 = function () {\n          if (enableDualStream) {\n            return Promise.resolve(screenClient.enableDualStream()).then(function () {});\n          }\n        }();\n        return Promise.resolve(_temp11 && _temp11.then ? _temp11.then(_temp10) : _temp10(_temp11));\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    };\n    var screenClient = AgoraRTC.createClient({\n      mode: 'live',\n      role: 'host',\n      codec: 'vp8'\n    });\n    var returnedUid = 0;\n    var uid = screenshareUid || 1;\n    var localVideoTrackHasPublished = false;\n    var stop = function stop() {\n      try {\n        var _temp13 = _catch(function () {\n          track.close();\n          return Promise.resolve(screenClient.leave()).then(function () {\n            screenClient.removeAllListeners();\n          });\n        }, function (e) {\n          console.log(e);\n        });\n        return Promise.resolve(_temp13 && _temp13.then ? _temp13.then(function () {}) : void 0);\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    };\n    stopScreenshare = stop;\n    return Promise.resolve(init()).then(function () {\n      return Promise.resolve(join()).then(function () {\n        return Promise.resolve(publish()).then(function () {\n          if (returnedUid) console.log(returnedUid);\n        });\n      });\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\nvar stopScreenshare = function stopScreenshare() {};\nvar useClient = createClient({\n  codec: 'vp8',\n  mode: 'live'\n});\nvar RtcConfigure = function RtcConfigure(props) {\n  var uid = useRef();\n  var screenTrack = useRef();\n  var isScreensharingRef = useRef(false);\n  var _useContext = useContext(TracksContext),\n    localVideoTrack = _useContext.localVideoTrack,\n    localAudioTrack = _useContext.localAudioTrack;\n  var _useContext2 = useContext(PropsContext),\n    callbacks = _useContext2.callbacks,\n    rtcProps = _useContext2.rtcProps;\n  var _useState = useState(false),\n    ready = _useState[0],\n    setReady = _useState[1];\n  var _useState2 = useState(false),\n    channelJoined = _useState2[0],\n    setChannelJoined = _useState2[1];\n  var joinRes = null;\n  var canJoin = useRef(new Promise(function (resolve, reject) {\n    joinRes = resolve;\n    console.log(reject);\n  }));\n  var client = useClient();\n  if (rtcProps.customRtcClient) {\n    client.removeAllListeners();\n    client = rtcProps.customRtcClient;\n  }\n  var localVideoTrackHasPublished = false;\n  var localAudioTrackHasPublished = false;\n  var mediaStore = useRef({});\n  var callActive = props.callActive;\n  if (callActive === undefined) {\n    callActive = true;\n  }\n  var _useReducer = useReducer(reducer, initState),\n    uidState = _useReducer[0],\n    dispatch = _useReducer[1];\n  useEffect(function () {\n    var init = function init() {\n      try {\n        try {\n          console.log(client);\n          client.on('user-joined', function () {\n            try {\n              for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n                args[_key] = arguments[_key];\n              }\n              var remoteUser = args[0];\n              if (remoteUser.uid === props.screenshareUid && isScreensharingRef.current || remoteUser.uid === 1 && isScreensharingRef.current) {} else {\n                mediaStore.current[remoteUser.uid] = {};\n              }\n              dispatch({\n                type: 'user-joined',\n                value: args\n              });\n              return Promise.resolve();\n            } catch (e) {\n              return Promise.reject(e);\n            }\n          });\n          client.on('user-published', function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n            try {\n              var remoteUser = args[0],\n                mediaType = args[1];\n              console.log('user-published', remoteUser.uid);\n              if (remoteUser.uid === props.screenshareUid && isScreensharingRef.current || remoteUser.uid === 1 && isScreensharingRef.current) {\n                dispatch({\n                  type: 'user-published',\n                  value: args\n                });\n              } else {\n                client.subscribe(remoteUser, mediaType).then(function (_e) {\n                  mediaStore.current[remoteUser.uid][mediaType + 'Track'] = remoteUser[mediaType + 'Track'];\n                  if (mediaType === 'audio') {\n                    var _remoteUser$audioTrac;\n                    (_remoteUser$audioTrac = remoteUser.audioTrack) === null || _remoteUser$audioTrac === void 0 ? void 0 : _remoteUser$audioTrac.play();\n                  } else {\n                    if (rtcProps.enableDualStream && rtcProps.dualStreamMode) {\n                      client.setStreamFallbackOption(remoteUser.uid, rtcProps.dualStreamMode);\n                    }\n                  }\n                  dispatch({\n                    type: 'user-published',\n                    value: args\n                  });\n                })[\"catch\"](function (e) {\n                  return console.log(e);\n                });\n              }\n              return Promise.resolve();\n            } catch (e) {\n              return Promise.reject(e);\n            }\n          });\n          client.on('user-unpublished', function () {\n            try {\n              for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n                args[_key3] = arguments[_key3];\n              }\n              var remoteUser = args[0],\n                mediaType = args[1];\n              console.log('user-unpublished', remoteUser.uid);\n              if (mediaType === 'audio') {\n                var _remoteUser$audioTrac2;\n                (_remoteUser$audioTrac2 = remoteUser.audioTrack) === null || _remoteUser$audioTrac2 === void 0 ? void 0 : _remoteUser$audioTrac2.stop();\n              }\n              dispatch({\n                type: 'user-unpublished',\n                value: args\n              });\n              return Promise.resolve();\n            } catch (e) {\n              return Promise.reject(e);\n            }\n          });\n          client.on('connection-state-change', function () {\n            try {\n              for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n                args[_key4] = arguments[_key4];\n              }\n              var curState = args[0],\n                prevState = args[1],\n                reason = args[2];\n              console.log('connection', prevState, curState, reason);\n              if (curState === 'CONNECTED') {\n                setChannelJoined(true);\n              } else if (curState === 'DISCONNECTED') {\n                try {\n                  stopScreenshare();\n                  isScreensharingRef.current = false;\n                } catch (e) {\n                  console.log('stopscreenshare', e);\n                }\n                dispatch({\n                  type: 'leave-channel',\n                  value: null\n                });\n              } else {\n                setChannelJoined(false);\n              }\n              return Promise.resolve();\n            } catch (e) {\n              return Promise.reject(e);\n            }\n          });\n          client.on('user-left', function () {\n            for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n              args[_key5] = arguments[_key5];\n            }\n            dispatch({\n              type: 'user-left',\n              value: args\n            });\n          });\n          if (rtcProps.tokenUrl) {\n            var tokenUrl = rtcProps.tokenUrl,\n              channel = rtcProps.channel,\n              _uid = rtcProps.uid;\n            client.on('token-privilege-will-expire', function () {\n              try {\n                console.log('token will expire');\n                return Promise.resolve(fetch(tokenUrl + '/rtc/' + channel + '/publisher/uid/' + (_uid || 0) + '/')).then(function (res) {\n                  return Promise.resolve(res.json()).then(function (data) {\n                    var token = data.rtcToken;\n                    client.renewToken(token);\n                  });\n                });\n              } catch (e) {\n                return Promise.reject(e);\n              }\n            });\n            client.on('token-privilege-did-expire', function () {\n              try {\n                return Promise.resolve(fetch(tokenUrl + '/rtc/' + channel + '/publisher/uid/' + (_uid || 0) + '/')).then(function (res) {\n                  return Promise.resolve(res.json()).then(function (data) {\n                    var token = data.rtcToken;\n                    client.renewToken(token);\n                  });\n                });\n              } catch (e) {\n                return Promise.reject(e);\n              }\n            });\n          }\n          if (callbacks) {\n            var events = Object.keys(callbacks);\n            events.map(function (e) {\n              try {\n                client.on(e, function () {\n                  ;\n                  for (var _len6 = arguments.length, args = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {\n                    args[_key6] = arguments[_key6];\n                  }\n                  callbacks[e].apply(null, args);\n                });\n              } catch (e) {\n                console.log(e);\n              }\n            });\n          }\n          ;\n          joinRes(true);\n          setReady(true);\n        } catch (e) {\n          console.log('!!!', e);\n        }\n        return Promise.resolve();\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    };\n    if (joinRes) {\n      init();\n      return function () {\n        try {\n          client.removeAllListeners();\n        } catch (e) {\n          console.log(e);\n        }\n      };\n    } else return function () {};\n  }, [rtcProps.appId]);\n  useEffect(function () {\n    var join = function join() {\n      try {\n        return Promise.resolve(canJoin.current).then(function () {\n          var tokenUrl = rtcProps.tokenUrl,\n            channel = rtcProps.channel,\n            userUid = rtcProps.uid,\n            appId = rtcProps.appId,\n            token = rtcProps.token;\n          var _temp3 = function () {\n            if (client && !ignore) {\n              if (rtcProps.role === 'audience') {\n                client.setClientRole(rtcProps.role);\n              } else {\n                client.setClientRole('host');\n              }\n              var _temp4 = function () {\n                if (tokenUrl) {\n                  var _temp5 = _catch(function () {\n                    return Promise.resolve(fetch(tokenUrl + '/rtc/' + channel + '/publisher/uid/' + (userUid || 0) + '/')).then(function (res) {\n                      return Promise.resolve(res.json()).then(function (data) {\n                        var token = data.rtcToken;\n                        return Promise.resolve(client.join(appId, channel, token, userUid || 0)).then(function (_client$join) {\n                          uid.current = _client$join;\n                        });\n                      });\n                    });\n                  }, function (e) {\n                    console.log(e);\n                  });\n                  if (_temp5 && _temp5.then) return _temp5.then(function () {});\n                } else {\n                  return Promise.resolve(client.join(appId, channel, token || null, userUid || 0)).then(function (_client$join2) {\n                    uid.current = _client$join2;\n                  });\n                }\n              }();\n              if (_temp4 && _temp4.then) return _temp4.then(function () {});\n            } else {\n              console.error('trying to join before RTC Engine was initialized');\n            }\n          }();\n          if (_temp3 && _temp3.then) return _temp3.then(function () {});\n        });\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    };\n    var ignore = false;\n    if (callActive) {\n      join();\n      console.log('Attempted join: ', rtcProps.channel);\n    } else {\n      console.log('In precall - waiting to join');\n    }\n    return function () {\n      ignore = true;\n      if (callActive) {\n        console.log('Leaving channel');\n        try {\n          stopScreenshare();\n          isScreensharingRef.current = false;\n        } catch (e) {\n          console.log(e);\n        }\n        canJoin.current = client.leave()[\"catch\"](function (err) {\n          return console.log(err);\n        });\n      }\n    };\n  }, [rtcProps.channel, rtcProps.uid, callActive, rtcProps.tokenUrl]);\n  useEffect(function () {\n    var publish = function publish() {\n      try {\n        var _temp15 = function _temp15() {\n          function _temp10() {\n            var _temp8 = function () {\n              if (localVideoTrack !== null && localVideoTrack !== void 0 && localVideoTrack.enabled && channelJoined) {\n                var _temp13 = function () {\n                  if (!localVideoTrackHasPublished) {\n                    return Promise.resolve(client.publish([localVideoTrack]).then(function () {\n                      localVideoTrackHasPublished = true;\n                    })).then(function () {});\n                  }\n                }();\n                if (_temp13 && _temp13.then) return _temp13.then(function () {});\n              }\n            }();\n            if (_temp8 && _temp8.then) return _temp8.then(function () {});\n          }\n          var _temp9 = function () {\n            if (localAudioTrack !== null && localAudioTrack !== void 0 && localAudioTrack.enabled && channelJoined) {\n              var _temp14 = function () {\n                if (!localAudioTrackHasPublished) {\n                  return Promise.resolve(client.publish([localAudioTrack]).then(function () {\n                    localAudioTrackHasPublished = true;\n                  })).then(function () {});\n                }\n              }();\n              if (_temp14 && _temp14.then) return _temp14.then(function () {});\n            }\n          }();\n          return _temp9 && _temp9.then ? _temp9.then(_temp10) : _temp10(_temp9);\n        };\n        var _temp16 = function () {\n          if (rtcProps.enableDualStream) {\n            return Promise.resolve(client.enableDualStream()).then(function () {});\n          }\n        }();\n        return Promise.resolve(_temp16 && _temp16.then ? _temp16.then(_temp15) : _temp15(_temp16));\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    };\n    console.log('Publish', localVideoTrack, localAudioTrack, callActive);\n    if (callActive) {\n      publish();\n    }\n  }, [callActive, localVideoTrack === null || localVideoTrack === void 0 ? void 0 : localVideoTrack.enabled, localAudioTrack === null || localAudioTrack === void 0 ? void 0 : localAudioTrack.enabled, channelJoined]);\n  useEffect(function () {\n    if (localVideoTrack && localAudioTrack !== null) {\n      mediaStore.current[0] = {\n        audioTrack: localAudioTrack,\n        videoTrack: localVideoTrack\n      };\n      dispatch({\n        type: 'update-user-video',\n        value: [localAudioTrack, localVideoTrack]\n      });\n    }\n  }, [rtcProps.channel, channelJoined]);\n  useEffect(function () {\n    if (channelJoined && rtcProps.token) {\n      client.renewToken(rtcProps.token).then(function (e) {\n        return console.log('renewed token', e);\n      });\n    }\n  }, [rtcProps.token, channelJoined]);\n  useEffect(function () {\n    if (rtcProps.role) {\n      client.setClientRole(rtcProps.role).then(function (e) {\n        return console.log('changed role', e);\n      });\n    }\n  }, [rtcProps.role, channelJoined]);\n  useEffect(function () {\n    var enableActiveSpeaker = function enableActiveSpeaker() {\n      try {\n        var _temp18 = function () {\n          if (rtcProps.activeSpeaker && rtcProps.layout !== layout.grid) {\n            client.on('volume-indicator', function (volumes) {\n              var highestvolumeObj = volumes.reduce(function (highestVolume, volume) {\n                if (highestVolume === null) {\n                  return volume;\n                } else {\n                  if (volume.level > highestVolume.level) {\n                    return volume;\n                  }\n                  return highestVolume;\n                }\n              }, null);\n              var activeSpeaker = highestvolumeObj ? highestvolumeObj.uid : undefined;\n              var mapActiveSpeakerToZero = activeSpeaker === uid.current ? 0 : activeSpeaker;\n              if (activeSpeaker !== undefined) {\n                dispatch({\n                  type: 'ActiveSpeaker',\n                  value: [mapActiveSpeakerToZero]\n                });\n              }\n            });\n            return Promise.resolve(client.enableAudioVolumeIndicator()).then(function () {});\n          }\n        }();\n        return Promise.resolve(_temp18 && _temp18.then ? _temp18.then(function () {}) : void 0);\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    };\n    if (callActive) {\n      enableActiveSpeaker();\n    }\n    return function () {\n      client.removeAllListeners('volume-indicator');\n    };\n  }, [rtcProps.activeSpeaker, rtcProps.layout]);\n  var toggleScreensharing = function toggleScreensharing() {\n    try {\n      var start = function start() {\n        try {\n          dispatch({\n            type: 'Screensharing',\n            value: [true]\n          });\n          return Promise.resolve(AgoraRTC.createScreenVideoTrack({}, 'disable')).then(function (_AgoraRTC$createScree) {\n            screenTrack.current = _AgoraRTC$createScree;\n            var uid = rtcProps.screenshareUid || 1;\n            mediaStore.current[uid] = {\n              videoTrack: screenTrack.current\n            };\n            screenTrack.current.on('track-ended', function () {\n              isScreensharingRef.current = false;\n              dispatch({\n                type: 'Screensharing',\n                value: [false]\n              });\n            });\n            isScreensharingRef.current = true;\n            return Promise.resolve(startScreenshare(rtcProps.appId, rtcProps.channel, screenTrack.current, rtcProps.screenshareToken, rtcProps.screenshareUid, rtcProps.tokenUrl, rtcProps.enableDualStream)).then(function () {});\n          });\n        } catch (e) {\n          return Promise.reject(e);\n        }\n      };\n      var stop = function stop() {\n        stopScreenshare();\n        isScreensharingRef.current = false;\n      };\n      if (isScreensharingRef.current) {\n        stop();\n      } else {\n        start();\n      }\n      return Promise.resolve();\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  return React.createElement(RtcProvider, {\n    value: {\n      client: client,\n      mediaStore: mediaStore.current,\n      localVideoTrack: localVideoTrack,\n      localAudioTrack: localAudioTrack,\n      dispatch: dispatch,\n      localUid: uid,\n      channelJoined: channelJoined,\n      toggleScreensharing: toggleScreensharing,\n      isScreensharing: isScreensharingRef.current\n    }\n  }, React.createElement(MaxUidProvider, {\n    value: uidState.max\n  }, React.createElement(MinUidProvider, {\n    value: uidState.min\n  }, ready ? props.children : null)));\n};\nvar icons = {\n  videocam: React.createElement(React.Fragment, null, React.createElement(\"polygon\", {\n    points: '23 7 16 12 23 17 23 7'\n  }), React.createElement(\"rect\", {\n    x: '1',\n    y: '5',\n    width: '15',\n    height: '14',\n    rx: '2',\n    ry: '2'\n  })),\n  videocamOff: React.createElement(React.Fragment, null, React.createElement(\"path\", {\n    d: 'M16 16v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h2m5.66 0H14a2 2 0 0 1 2 2v3.34l1 1L23 7v10'\n  }), React.createElement(\"line\", {\n    x1: '1',\n    y1: '1',\n    x2: '23',\n    y2: '23'\n  })),\n  remoteSwap: React.createElement(React.Fragment, null, React.createElement(\"polyline\", {\n    points: '15 3 21 3 21 9'\n  }), React.createElement(\"polyline\", {\n    points: '9 21 3 21 3 15'\n  }), React.createElement(\"line\", {\n    x1: '21',\n    y1: '3',\n    x2: '14',\n    y2: '10'\n  }), React.createElement(\"line\", {\n    x1: '3',\n    y1: '21',\n    x2: '10',\n    y2: '14'\n  })),\n  callEnd: React.createElement(React.Fragment, null, React.createElement(\"path\", {\n    d: 'M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91'\n  }), React.createElement(\"line\", {\n    x1: '23',\n    y1: '1',\n    x2: '1',\n    y2: '23'\n  })),\n  mic: React.createElement(React.Fragment, null, React.createElement(\"path\", {\n    d: 'M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z'\n  }), React.createElement(\"path\", {\n    d: 'M19 10v2a7 7 0 0 1-14 0v-2'\n  }), React.createElement(\"line\", {\n    x1: '12',\n    y1: '19',\n    x2: '12',\n    y2: '23'\n  }), React.createElement(\"line\", {\n    x1: '8',\n    y1: '23',\n    x2: '16',\n    y2: '23'\n  })),\n  micOff: React.createElement(React.Fragment, null, React.createElement(\"line\", {\n    x1: '1',\n    y1: '1',\n    x2: '23',\n    y2: '23'\n  }), React.createElement(\"path\", {\n    d: 'M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6'\n  }), React.createElement(\"path\", {\n    d: 'M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23'\n  }), React.createElement(\"line\", {\n    x1: '12',\n    y1: '19',\n    x2: '12',\n    y2: '23'\n  }), React.createElement(\"line\", {\n    x1: '8',\n    y1: '23',\n    x2: '16',\n    y2: '23'\n  })),\n  screen: React.createElement(React.Fragment, null, React.createElement(\"rect\", {\n    x: '2',\n    y: '3',\n    width: '20',\n    height: '14',\n    rx: '2',\n    ry: '2'\n  }), React.createElement(\"line\", {\n    x1: '8',\n    y1: '21',\n    x2: '16',\n    y2: '21'\n  }), React.createElement(\"line\", {\n    x1: '12',\n    y1: '17',\n    x2: '12',\n    y2: '21'\n  })),\n  stop: React.createElement(React.Fragment, null, React.createElement(\"line\", {\n    x1: '18',\n    y1: '6',\n    x2: '6',\n    y2: '18'\n  }), React.createElement(\"line\", {\n    x1: '6',\n    y1: '6',\n    x2: '18',\n    y2: '18'\n  }))\n};\nvar BtnTemplate = function BtnTemplate(props) {\n  var onClick = props.onClick,\n    name = props.name,\n    disabled = props.disabled,\n    style = props.style;\n  var _useContext = useContext(PropsContext),\n    styleProps = _useContext.styleProps;\n  var _ref = styleProps || {},\n    theme = _ref.theme,\n    BtnTemplateStyles = _ref.BtnTemplateStyles,\n    iconSize = _ref.iconSize,\n    customIcon = _ref.customIcon;\n  return React.createElement(\"div\", {\n    style: _extends({}, {\n      width: 35,\n      height: 35,\n      borderRadius: '100%',\n      borderWidth: 2,\n      borderStyle: 'solid',\n      borderColor: '#fff',\n      backgroundColor: 'rgba(0,80,180,0.2)',\n      alignItems: 'center',\n      justifyContent: 'center',\n      display: 'flex',\n      cursor: disabled ? 'auto' : 'pointer',\n      margin: 4\n    }, BtnTemplateStyles, style),\n    onClick: onClick\n  }, customIcon ? React.createElement(\"img\", {\n    src: customIcon[name],\n    alt: name\n  }) : React.createElement(\"svg\", {\n    style: {\n      width: iconSize || 24,\n      height: iconSize || 24\n    },\n    xmlns: 'http://www.w3.org/2000/svg',\n    width: '24',\n    height: '24',\n    viewBox: '0 0 24 24',\n    fill: 'none',\n    opacity: disabled ? '0.5' : '1',\n    stroke: theme || '#fff',\n    strokeWidth: '2',\n    strokeLinecap: 'round',\n    strokeLinejoin: 'round'\n  }, icons[name]));\n};\nfunction EndCall() {\n  var _useContext = useContext(PropsContext),\n    styleProps = _useContext.styleProps,\n    callbacks = _useContext.callbacks;\n  var _ref = styleProps || {},\n    localBtnStyles = _ref.localBtnStyles;\n  var _ref2 = localBtnStyles || {},\n    endCall = _ref2.endCall;\n  return React.createElement(BtnTemplate, {\n    style: endCall || {\n      backgroundColor: '#ef5588',\n      borderColor: '#f00'\n    },\n    name: 'callEnd',\n    onClick: function onClick() {\n      return (callbacks === null || callbacks === void 0 ? void 0 : callbacks.EndCall) && callbacks.EndCall();\n    }\n  });\n}\nvar LocalContext = createContext({});\nvar LocalUserContext = function LocalUserContext(props) {\n  var max = useContext(MaxUidContext);\n  var min = useContext(MinUidContext);\n  var localUser;\n  if (max[0].uid === 0) {\n    localUser = max[0];\n  } else {\n    localUser = min.find(function (u) {\n      return u.uid === 0;\n    });\n  }\n  return React.createElement(LocalContext.Provider, {\n    value: localUser\n  }, props.children);\n};\nvar muteAudio = function (user, dispatch, localAudioTrack, callbacks) {\n  try {\n    var _temp4 = function () {\n      if (user.uid === 0) {\n        var localState = user.hasAudio;\n        var _temp5 = function () {\n          if (localState === ToggleState.enabled || localState === ToggleState.disabled) {\n            var newState = localState === ToggleState.enabled ? ToggleState.disabling : ToggleState.enabling;\n            dispatch({\n              type: 'local-user-mute-audio',\n              value: [newState]\n            });\n            callbacks && callbacks['local-user-mute-audio'] && callbacks['local-user-mute-audio'](newState);\n            var _temp6 = _catch(function () {\n              return Promise.resolve(localAudioTrack === null || localAudioTrack === void 0 ? void 0 : localAudioTrack.setEnabled(localState !== ToggleState.enabled)).then(function () {\n                newState = localState === ToggleState.enabled ? ToggleState.disabled : ToggleState.enabled;\n                callbacks && callbacks['local-user-mute-audio'] && callbacks['local-user-mute-audio'](newState);\n                dispatch({\n                  type: 'local-user-mute-audio',\n                  value: [localState === ToggleState.enabled ? ToggleState.disabled : ToggleState.enabled]\n                });\n              });\n            }, function () {\n              dispatch({\n                type: 'local-user-mute-audio',\n                value: [localState]\n              });\n            });\n            if (_temp6 && _temp6.then) return _temp6.then(function () {});\n          }\n        }();\n        if (_temp5 && _temp5.then) return _temp5.then(function () {});\n      }\n    }();\n    return Promise.resolve(_temp4 && _temp4.then ? _temp4.then(function () {}) : void 0);\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\nfunction LocalAudioMute() {\n  var _useContext = useContext(PropsContext),\n    styleProps = _useContext.styleProps,\n    callbacks = _useContext.callbacks;\n  var _ref = styleProps || {},\n    localBtnStyles = _ref.localBtnStyles;\n  var _ref2 = localBtnStyles || {},\n    muteLocalAudio = _ref2.muteLocalAudio;\n  var _useContext2 = useContext(RtcContext),\n    dispatch = _useContext2.dispatch,\n    localAudioTrack = _useContext2.localAudioTrack;\n  var local = useContext(LocalContext);\n  return React.createElement(\"div\", null, React.createElement(BtnTemplate, {\n    style: muteLocalAudio,\n    name: local.hasAudio === ToggleState.enabled ? 'mic' : 'micOff',\n    onClick: function onClick() {\n      return localAudioTrack && muteAudio(local, dispatch, localAudioTrack, callbacks);\n    }\n  }));\n}\nfunction Screenshare() {\n  var _useContext = useContext(PropsContext),\n    styleProps = _useContext.styleProps;\n  var _ref = styleProps || {},\n    localBtnStyles = _ref.localBtnStyles;\n  var _ref2 = localBtnStyles || {},\n    screenshare = _ref2.screenshare;\n  var _useContext2 = useContext(RtcContext),\n    toggleScreensharing = _useContext2.toggleScreensharing,\n    isScreensharing = _useContext2.isScreensharing;\n  return React.createElement(\"div\", null, React.createElement(BtnTemplate, {\n    style: screenshare,\n    name: isScreensharing ? 'stop' : 'screen',\n    onClick: function onClick() {\n      return toggleScreensharing();\n    }\n  }));\n}\nvar muteVideo = function (user, dispatch, localVideoTrack, callbacks) {\n  try {\n    var _temp4 = function () {\n      if (user.uid === 0) {\n        var localState = user.hasVideo;\n        var _temp5 = function () {\n          if (localState === ToggleState.enabled || localState === ToggleState.disabled) {\n            var newState = localState === ToggleState.enabled ? ToggleState.disabling : ToggleState.enabling;\n            dispatch({\n              type: 'local-user-mute-video',\n              value: [newState]\n            });\n            callbacks && callbacks['local-user-mute-video'] && callbacks['local-user-mute-video'](newState);\n            var _temp6 = _catch(function () {\n              return Promise.resolve(localVideoTrack === null || localVideoTrack === void 0 ? void 0 : localVideoTrack.setEnabled(localState !== ToggleState.enabled)).then(function () {\n                newState = localState === ToggleState.enabled ? ToggleState.disabled : ToggleState.enabled;\n                callbacks && callbacks['local-user-mute-video'] && callbacks['local-user-mute-video'](newState);\n                dispatch({\n                  type: 'local-user-mute-video',\n                  value: [newState]\n                });\n              });\n            }, function () {\n              dispatch({\n                type: 'local-user-mute-video',\n                value: [localState]\n              });\n            });\n            if (_temp6 && _temp6.then) return _temp6.then(function () {});\n          }\n        }();\n        if (_temp5 && _temp5.then) return _temp5.then(function () {});\n      }\n    }();\n    return Promise.resolve(_temp4 && _temp4.then ? _temp4.then(function () {}) : void 0);\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\nfunction LocalVideoMute() {\n  var _useContext = useContext(PropsContext),\n    styleProps = _useContext.styleProps,\n    callbacks = _useContext.callbacks;\n  var _ref = styleProps || {},\n    localBtnStyles = _ref.localBtnStyles;\n  var _ref2 = localBtnStyles || {},\n    muteLocalVideo = _ref2.muteLocalVideo;\n  var _useContext2 = useContext(RtcContext),\n    dispatch = _useContext2.dispatch,\n    localVideoTrack = _useContext2.localVideoTrack;\n  var local = useContext(LocalContext);\n  return React.createElement(\"div\", null, React.createElement(BtnTemplate, {\n    style: muteLocalVideo,\n    name: local.hasVideo === ToggleState.enabled ? 'videocam' : 'videocamOff',\n    onClick: function onClick() {\n      return localVideoTrack && muteVideo(local, dispatch, localVideoTrack, callbacks);\n    }\n  }));\n}\nfunction LocalControls() {\n  var _useContext = useContext(PropsContext),\n    styleProps = _useContext.styleProps,\n    rtcProps = _useContext.rtcProps;\n  var _ref = styleProps || {},\n    localBtnContainer = _ref.localBtnContainer;\n  return React.createElement(\"div\", {\n    style: _extends({}, {\n      backgroundColor: '#007bff',\n      width: '100%',\n      height: 70,\n      zIndex: 10,\n      display: 'flex',\n      flexDirection: 'row',\n      justifyContent: 'space-evenly',\n      alignItems: 'center'\n    }, localBtnContainer)\n  }, rtcProps.role !== 'audience' && React.createElement(LocalVideoMute, null), rtcProps.role !== 'audience' && React.createElement(LocalAudioMute, null), rtcProps.role !== 'audience' && rtcProps.enableScreensharing && React.createElement(Screenshare, null), React.createElement(EndCall, null));\n}\nvar rtmStatusEnum;\n(function (rtmStatusEnum) {\n  rtmStatusEnum[rtmStatusEnum[\"initFailed\"] = 0] = \"initFailed\";\n  rtmStatusEnum[rtmStatusEnum[\"offline\"] = 1] = \"offline\";\n  rtmStatusEnum[rtmStatusEnum[\"initialising\"] = 2] = \"initialising\";\n  rtmStatusEnum[rtmStatusEnum[\"loggingIn\"] = 3] = \"loggingIn\";\n  rtmStatusEnum[rtmStatusEnum[\"loggedIn\"] = 4] = \"loggedIn\";\n  rtmStatusEnum[rtmStatusEnum[\"connected\"] = 5] = \"connected\";\n  rtmStatusEnum[rtmStatusEnum[\"loginFailed\"] = 6] = \"loginFailed\";\n})(rtmStatusEnum || (rtmStatusEnum = {}));\nvar clientRoleRaw;\n(function (clientRoleRaw) {\n  clientRoleRaw[clientRoleRaw[\"broadcaster\"] = 0] = \"broadcaster\";\n  clientRoleRaw[clientRoleRaw[\"audience\"] = 1] = \"audience\";\n})(clientRoleRaw || (clientRoleRaw = {}));\nvar mutingDevice;\n(function (mutingDevice) {\n  mutingDevice[mutingDevice[\"camera\"] = 0] = \"camera\";\n  mutingDevice[mutingDevice[\"microphone\"] = 1] = \"microphone\";\n})(mutingDevice || (mutingDevice = {}));\nvar popUpStateEnum;\n(function (popUpStateEnum) {\n  popUpStateEnum[popUpStateEnum[\"closed\"] = 0] = \"closed\";\n  popUpStateEnum[popUpStateEnum[\"muteMic\"] = 1] = \"muteMic\";\n  popUpStateEnum[popUpStateEnum[\"muteCamera\"] = 2] = \"muteCamera\";\n  popUpStateEnum[popUpStateEnum[\"unmuteMic\"] = 3] = \"unmuteMic\";\n  popUpStateEnum[popUpStateEnum[\"unmuteCamera\"] = 4] = \"unmuteCamera\";\n})(popUpStateEnum || (popUpStateEnum = {}));\nvar RtmContext = createContext(null);\nvar RtmProvider = RtmContext.Provider;\nvar RtmConsumer = RtmContext.Consumer;\nfunction RemoteVideoMute(props) {\n  var _useContext = useContext(PropsContext),\n    styleProps = _useContext.styleProps;\n  var _useContext2 = useContext(RtmContext),\n    sendMuteRequest = _useContext2.sendMuteRequest,\n    uidMap = _useContext2.uidMap;\n  var _ref = styleProps || {},\n    remoteBtnStyles = _ref.remoteBtnStyles;\n  var _ref2 = remoteBtnStyles || {},\n    muteRemoteVideo = _ref2.muteRemoteVideo;\n  var UIKitUser = props.UIKitUser;\n  var isMuted = UIKitUser.hasVideo === remoteTrackState.no;\n  return UIKitUser.uid !== 0 && uidMap[UIKitUser.uid] ? React.createElement(\"div\", null, React.createElement(BtnTemplate, {\n    name: UIKitUser.hasVideo === remoteTrackState.subbed ? 'videocam' : 'videocamOff',\n    style: muteRemoteVideo,\n    onClick: function onClick() {\n      return sendMuteRequest(mutingDevice.camera, UIKitUser.uid, !isMuted);\n    }\n  })) : null;\n}\nfunction RemoteAudioMute(props) {\n  var _useContext = useContext(PropsContext),\n    styleProps = _useContext.styleProps;\n  var _ref = styleProps || {},\n    remoteBtnStyles = _ref.remoteBtnStyles;\n  var _useContext2 = useContext(RtmContext),\n    sendMuteRequest = _useContext2.sendMuteRequest,\n    uidMap = _useContext2.uidMap;\n  var _ref2 = remoteBtnStyles || {},\n    muteRemoteAudio = _ref2.muteRemoteAudio;\n  var UIKitUser = props.UIKitUser;\n  var isMuted = UIKitUser.hasAudio === remoteTrackState.no;\n  return UIKitUser.uid !== 0 && uidMap[UIKitUser.uid] ? React.createElement(\"div\", null, React.createElement(BtnTemplate, {\n    style: muteRemoteAudio,\n    name: UIKitUser.hasAudio === remoteTrackState.subbed ? 'mic' : 'micOff',\n    onClick: function onClick() {\n      return sendMuteRequest(mutingDevice.microphone, UIKitUser.uid, !isMuted);\n    }\n  })) : null;\n}\nfunction SwapUser(props) {\n  var _useContext = useContext(RtcContext),\n    dispatch = _useContext.dispatch;\n  var UIKitUser = props.UIKitUser;\n  return React.createElement(\"div\", null, React.createElement(BtnTemplate, {\n    name: 'remoteSwap',\n    onClick: function onClick() {\n      return dispatch({\n        type: 'user-swap',\n        value: [UIKitUser]\n      });\n    }\n  }));\n}\nvar VideoPlaceholder = function VideoPlaceholder(props) {\n  var _useContext = useContext(PropsContext),\n    styleProps = _useContext.styleProps,\n    rtcProps = _useContext.rtcProps;\n  var _ref = styleProps || {},\n    maxViewStyles = _ref.maxViewStyles,\n    maxViewOverlayContainer = _ref.maxViewOverlayContainer;\n  var user = props.user;\n  var CustomVideoPlaceholder = rtcProps.CustomVideoPlaceholder;\n  return !CustomVideoPlaceholder ? React.createElement(\"div\", {\n    key: user.uid,\n    style: _extends({}, style.max, maxViewStyles)\n  }, React.createElement(\"div\", {\n    style: style.imgContainer\n  }, React.createElement(\"img\", {\n    style: style.img,\n    src: 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJmZWF0aGVyIGZlYXRoZXItdXNlciI+PHBhdGggZD0iTTIwIDIxdi0yYTQgNCAwIDAgMC00LTRIOGE0IDQgMCAwIDAtNCA0djIiPjwvcGF0aD48Y2lyY2xlIGN4PSIxMiIgY3k9IjciIHI9IjQiPjwvY2lyY2xlPjwvc3ZnPg=='\n  })), props.isShown && React.createElement(\"div\", {\n    style: _extends({}, style.btnContainer, maxViewOverlayContainer)\n  }, props.showButtons && React.createElement(React.Fragment, null, !rtcProps.disableRtm && React.createElement(RemoteVideoMute, {\n    UIKitUser: user\n  }), !rtcProps.disableRtm && React.createElement(RemoteAudioMute, {\n    UIKitUser: user\n  }), props.showSwap && React.createElement(SwapUser, {\n    UIKitUser: user\n  })))) : CustomVideoPlaceholder && CustomVideoPlaceholder(_extends({}, props), null);\n};\nvar style = {\n  max: {\n    flex: 1,\n    display: 'flex',\n    backgroundColor: '#007bff33',\n    flexDirection: 'row',\n    position: 'relative'\n  },\n  imgContainer: {\n    flex: 10,\n    display: 'flex',\n    justifyContent: 'center'\n  },\n  img: {\n    width: 100,\n    height: 100,\n    position: 'absolute',\n    alignSelf: 'center',\n    justifySelf: 'center',\n    margin: 'auto',\n    display: 'flex'\n  },\n  btnContainer: {\n    position: 'absolute',\n    margin: 5,\n    flexDirection: 'column',\n    display: 'flex'\n  }\n};\nvar Username = function Username(props) {\n  var _useContext = useContext(RtmContext),\n    usernames = _useContext.usernames;\n  var _useContext2 = useContext(PropsContext),\n    rtmProps = _useContext2.rtmProps,\n    styleProps = _useContext2.styleProps;\n  var user = props.user;\n  return rtmProps !== null && rtmProps !== void 0 && rtmProps.displayUsername ? React.createElement(\"p\", {\n    style: _extends({}, styles.username, styleProps === null || styleProps === void 0 ? void 0 : styleProps.usernameText)\n  }, user.uid === 1 ? 'Screenshare' : usernames[user.uid]) : React.createElement(React.Fragment, null);\n};\nvar styles = {\n  username: {\n    position: 'absolute',\n    background: '#007bffaa',\n    padding: '2px 8px',\n    color: '#fff',\n    margin: 0,\n    bottom: 0,\n    right: 0,\n    zIndex: 90\n  }\n};\nvar MaxVideoView = function MaxVideoView(props) {\n  var _useContext = useContext(RtcContext),\n    mediaStore = _useContext.mediaStore;\n  var _useContext2 = useContext(PropsContext),\n    styleProps = _useContext2.styleProps,\n    rtcProps = _useContext2.rtcProps;\n  var _ref = styleProps || {},\n    maxViewStyles = _ref.maxViewStyles,\n    videoMode = _ref.videoMode,\n    maxViewOverlayContainer = _ref.maxViewOverlayContainer;\n  var renderModeProp = videoMode === null || videoMode === void 0 ? void 0 : videoMode.max;\n  var _useState = useState(false),\n    isShown = _useState[0],\n    setIsShown = _useState[1];\n  var user = props.user;\n  return React.createElement(\"div\", {\n    style: _extends({}, styles$1.container, props.style, maxViewStyles),\n    onMouseEnter: function onMouseEnter() {\n      return setIsShown(true);\n    },\n    onMouseLeave: function onMouseLeave() {\n      return setIsShown(false);\n    }\n  }, user.hasVideo === 1 ? React.createElement(\"div\", {\n    style: styles$1.videoContainer\n  }, !rtcProps.disableRtm && React.createElement(Username, {\n    user: user\n  }), React.createElement(AgoraVideoPlayer, {\n    style: styles$1.videoplayer,\n    config: {\n      fit: renderModeProp || 'cover'\n    },\n    videoTrack: mediaStore[user.uid].videoTrack\n  }), isShown && React.createElement(\"div\", {\n    style: _extends({}, styles$1.overlay, maxViewOverlayContainer)\n  }, !rtcProps.disableRtm && React.createElement(RemoteVideoMute, {\n    UIKitUser: user\n  }), !rtcProps.disableRtm && React.createElement(RemoteAudioMute, {\n    UIKitUser: user\n  }))) : React.createElement(\"div\", {\n    style: styles$1.videoContainer\n  }, !rtcProps.disableRtm && React.createElement(Username, {\n    user: user\n  }), React.createElement(VideoPlaceholder, {\n    user: user,\n    isShown: isShown,\n    showButtons: true\n  })));\n};\nvar styles$1 = {\n  container: {\n    display: 'flex',\n    flex: 1\n  },\n  videoContainer: {\n    display: 'flex',\n    flex: 1,\n    position: 'relative'\n  },\n  videoplayer: {\n    width: '100%',\n    display: 'flex',\n    flex: 1\n  },\n  overlay: {\n    position: 'absolute',\n    margin: 5,\n    flexDirection: 'column',\n    display: 'flex'\n  },\n  username: {\n    position: 'absolute',\n    background: '#007bffaa',\n    padding: '2px 8px',\n    color: '#fff',\n    margin: 0,\n    bottom: 0,\n    right: 0,\n    zIndex: 90\n  }\n};\nvar MinVideoView = function MinVideoView(props) {\n  var _useContext = useContext(RtcContext),\n    mediaStore = _useContext.mediaStore;\n  var _useContext2 = useContext(PropsContext),\n    styleProps = _useContext2.styleProps,\n    rtcProps = _useContext2.rtcProps;\n  var _ref = styleProps || {},\n    minViewStyles = _ref.minViewStyles,\n    videoMode = _ref.videoMode,\n    minViewOverlayContainer = _ref.minViewOverlayContainer;\n  var renderModeProp = videoMode === null || videoMode === void 0 ? void 0 : videoMode.min;\n  var _useState = useState(false),\n    isShown = _useState[0],\n    setIsShown = _useState[1];\n  var user = props.user;\n  return React.createElement(\"div\", {\n    style: _extends({}, {\n      display: 'flex',\n      flex: 1\n    }, minViewStyles),\n    onMouseEnter: function onMouseEnter() {\n      return setIsShown(true);\n    },\n    onMouseLeave: function onMouseLeave() {\n      return setIsShown(false);\n    }\n  }, user.hasVideo === 1 ? React.createElement(\"div\", {\n    style: _extends({}, {\n      display: 'flex',\n      flex: 1,\n      position: 'relative'\n    })\n  }, React.createElement(AgoraVideoPlayer, {\n    style: {\n      flex: 10,\n      display: 'flex'\n    },\n    config: {\n      fit: renderModeProp !== undefined ? renderModeProp : 'cover'\n    },\n    videoTrack: mediaStore[user.uid].videoTrack\n  }), isShown && React.createElement(\"div\", {\n    style: _extends({}, {\n      margin: 4,\n      position: 'absolute',\n      flex: 1,\n      display: 'flex',\n      flexDirection: 'column'\n    }, minViewOverlayContainer)\n  }, !rtcProps.disableRtm && React.createElement(RemoteVideoMute, {\n    UIKitUser: user\n  }), !rtcProps.disableRtm && React.createElement(RemoteAudioMute, {\n    UIKitUser: user\n  }), React.createElement(SwapUser, {\n    UIKitUser: user\n  }))) : React.createElement(VideoPlaceholder, {\n    user: user,\n    isShown: isShown,\n    showButtons: true,\n    showSwap: true\n  }));\n};\nvar styles$2 = {\n  \"test\": \"_3ybTi\",\n  \"scrollbar\": \"_3Sxu7\"\n};\nvar PinnedVideo = function PinnedVideo() {\n  var _useContext = useContext(PropsContext),\n    styleProps = _useContext.styleProps,\n    rtcProps = _useContext.rtcProps;\n  var _ref = styleProps || {},\n    minViewContainer = _ref.minViewContainer,\n    pinnedVideoContainer = _ref.pinnedVideoContainer,\n    maxViewContainer = _ref.maxViewContainer,\n    scrollViewContainer = _ref.scrollViewContainer;\n  var parentRef = useRef(null);\n  var _useState = useState(0),\n    width = _useState[0],\n    setWidth = _useState[1];\n  var _useState2 = useState(0),\n    height = _useState2[0],\n    setHeight = _useState2[1];\n  var isLandscape = width > height;\n  useEffect(function () {\n    var handleResize = function handleResize() {\n      if (parentRef.current) {\n        setWidth(parentRef.current.offsetWidth);\n        setHeight(parentRef.current.offsetHeight);\n      }\n    };\n    window.addEventListener('resize', handleResize);\n    if (parentRef.current) {\n      setWidth(parentRef.current.offsetWidth);\n      setHeight(parentRef.current.offsetHeight);\n    }\n    return function () {\n      window.removeEventListener('resize', handleResize);\n    };\n  }, []);\n  return React.createElement(\"div\", {\n    ref: parentRef,\n    style: _extends({}, {\n      display: 'flex',\n      flex: 1,\n      flexDirection: isLandscape ? 'row' : 'column-reverse',\n      overflow: 'hidden'\n    }, pinnedVideoContainer)\n  }, React.createElement(\"div\", {\n    style: _extends({}, {\n      display: 'flex',\n      flex: isLandscape ? 5 : 4\n    }, maxViewContainer)\n  }, React.createElement(MaxUidConsumer, null, function (maxUsers) {\n    return rtcProps.role === 'audience' && maxUsers[0].uid === 0 ? null : React.createElement(MaxVideoView, {\n      user: maxUsers[0]\n    });\n  })), React.createElement(\"div\", {\n    className: styles$2.scrollbar,\n    style: _extends({}, {\n      overflowY: isLandscape ? 'scroll' : 'hidden',\n      overflowX: !isLandscape ? 'scroll' : 'hidden',\n      display: 'flex',\n      flex: 1,\n      flexDirection: isLandscape ? 'column' : 'row'\n    }, scrollViewContainer)\n  }, React.createElement(MinUidConsumer, null, function (minUsers) {\n    return minUsers.map(function (user) {\n      return rtcProps.role === 'audience' && user.uid === 0 ? null : React.createElement(\"div\", {\n        style: _extends({}, {\n          minHeight: isLandscape ? '35vh' : '99%',\n          minWidth: isLandscape ? '99%' : '40vw',\n          margin: 2,\n          display: 'flex'\n        }, minViewContainer),\n        key: user.uid\n      }, React.createElement(MinVideoView, {\n        user: user\n      }));\n    });\n  })));\n};\nvar GridVideo = function GridVideo() {\n  var _useContext = useContext(PropsContext),\n    styleProps = _useContext.styleProps,\n    rtcProps = _useContext.rtcProps;\n  var _ref = styleProps || {},\n    gridVideoCells = _ref.gridVideoCells,\n    gridVideoContainer = _ref.gridVideoContainer;\n  var max = useContext(MaxUidContext);\n  var min = useContext(MinUidContext);\n  var users = rtcProps.role === 'audience' ? [].concat(max, min).filter(function (user) {\n    return user.uid !== 0;\n  }) : [].concat(max, min);\n  var parentRef = useRef(null);\n  var _useState = useState(window.innerWidth),\n    width = _useState[0],\n    setWidth = _useState[1];\n  var _useState2 = useState(window.innerHeight),\n    height = _useState2[0],\n    setHeight = _useState2[1];\n  var isLandscape = width > height;\n  var unit = 'minmax(0, 1fr) ';\n  useEffect(function () {\n    var handleResize = function handleResize() {\n      if (parentRef.current) {\n        setWidth(parentRef.current.offsetWidth);\n        setHeight(parentRef.current.offsetHeight);\n      }\n    };\n    window.addEventListener('resize', handleResize);\n    if (parentRef.current) {\n      setWidth(parentRef.current.offsetWidth);\n      setHeight(parentRef.current.offsetHeight);\n    }\n    return function () {\n      window.removeEventListener('resize', handleResize);\n    };\n  }, []);\n  return React.createElement(\"div\", {\n    ref: parentRef,\n    style: _extends({}, {\n      width: '100%',\n      height: '100%',\n      display: 'grid',\n      gridTemplateColumns: isLandscape ? users.length > 9 ? unit.repeat(4) : users.length > 4 ? unit.repeat(3) : users.length > 1 ? unit.repeat(2) : unit : users.length > 8 ? unit.repeat(3) : users.length > 2 ? unit.repeat(2) : unit\n    }, gridVideoContainer)\n  }, users.map(function (user) {\n    return React.createElement(MaxVideoView, {\n      user: user,\n      style: _extends({}, {\n        height: '100%',\n        width: '100%'\n      }, gridVideoCells),\n      key: user.uid\n    });\n  }));\n};\nvar useTracks = createMicrophoneAndCameraTracks({\n  encoderConfig: {}\n}, {\n  encoderConfig: {}\n});\nvar TracksConfigure = function TracksConfigure(props) {\n  var _useState = useState(false),\n    ready = _useState[0],\n    setReady = _useState[1];\n  var _useState2 = useState(null),\n    localVideoTrack = _useState2[0],\n    setLocalVideoTrack = _useState2[1];\n  var _useState3 = useState(null),\n    localAudioTrack = _useState3[0],\n    setLocalAudioTrack = _useState3[1];\n  var _useTracks = useTracks(),\n    trackReady = _useTracks.ready,\n    tracks = _useTracks.tracks,\n    error = _useTracks.error;\n  var mediaStore = useRef({});\n  useEffect(function () {\n    if (tracks !== null) {\n      setLocalAudioTrack(tracks[0]);\n      setLocalVideoTrack(tracks[1]);\n      mediaStore.current[0] = {\n        audioTrack: tracks[0],\n        videoTrack: tracks[1]\n      };\n      setReady(true);\n    } else if (error) {\n      console.error(error);\n      setReady(false);\n    }\n    return function () {\n      if (tracks) {\n        var _tracks$, _tracks$2;\n        (_tracks$ = tracks[0]) === null || _tracks$ === void 0 ? void 0 : _tracks$.close();\n        (_tracks$2 = tracks[1]) === null || _tracks$2 === void 0 ? void 0 : _tracks$2.close();\n      }\n    };\n  }, [trackReady, error]);\n  return React.createElement(TracksProvider, {\n    value: {\n      localVideoTrack: localVideoTrack,\n      localAudioTrack: localAudioTrack\n    }\n  }, ready ? props.children : null);\n};\nvar timeNow = function timeNow() {\n  return new Date().getTime();\n};\nvar useChannel = createLazyChannel();\nvar useClient$1 = createLazyClient();\nvar RtmConfigure = function RtmConfigure(props) {\n  var _useContext = useContext(PropsContext),\n    rtcProps = _useContext.rtcProps,\n    rtmProps = _useContext.rtmProps;\n  var _useState = useState(false),\n    isLoggedIn = _useState[0],\n    setLoggedIn = _useState[1];\n  var rtmClient = useClient$1(rtcProps.appId);\n  var channel = useChannel(rtmClient, rtcProps.channel);\n  var localUid = useRef('');\n  var timerValueRef = useRef(5);\n  var local = useContext(LocalContext);\n  var _useContext2 = useContext(PropsContext),\n    rtmCallbacks = _useContext2.rtmCallbacks;\n  var _useState2 = useState({}),\n    uidMap = _useState2[0],\n    setUidMap = _useState2[1];\n  var _useState3 = useState({}),\n    usernames = _useState3[0],\n    setUsernames = _useState3[1];\n  var _useState4 = useState({}),\n    userDataMap = _useState4[0],\n    setUserDataMap = _useState4[1];\n  var _useState5 = useState(popUpStateEnum.closed),\n    popUpState = _useState5[0],\n    setPopUpState = _useState5[1];\n  var _useState6 = useState(rtmStatusEnum.offline),\n    rtmStatus = _useState6[0],\n    setRtmStatus = _useState6[1];\n  var _useContext3 = useContext(RtcContext),\n    rtcUid = _useContext3.localUid,\n    localAudioTrack = _useContext3.localAudioTrack,\n    localVideoTrack = _useContext3.localVideoTrack,\n    dispatch = _useContext3.dispatch,\n    channelJoined = _useContext3.channelJoined;\n  var login = function login() {\n    try {\n      var tokenUrl = rtcProps.tokenUrl;\n      var _temp4 = function () {\n        if (tokenUrl) {\n          var _temp5 = _catch(function () {\n            return Promise.resolve(fetch(tokenUrl + '/rtm/' + ((rtmProps === null || rtmProps === void 0 ? void 0 : rtmProps.uid) || localUid.current))).then(function (res) {\n              return Promise.resolve(res.json()).then(function (data) {\n                var serverToken = data.rtmToken;\n                return Promise.resolve(rtmClient.login({\n                  uid: (rtmProps === null || rtmProps === void 0 ? void 0 : rtmProps.uid) || localUid.current,\n                  token: serverToken\n                })).then(function () {\n                  timerValueRef.current = 5;\n                });\n              });\n            });\n          }, function () {\n            setTimeout(function () {\n              try {\n                timerValueRef.current = timerValueRef.current + timerValueRef.current;\n                login();\n                return Promise.resolve();\n              } catch (e) {\n                return Promise.reject(e);\n              }\n            }, timerValueRef.current * 1000);\n          });\n          if (_temp5 && _temp5.then) return _temp5.then(function () {});\n        } else {\n          var _temp6 = _catch(function () {\n            return Promise.resolve(rtmClient.login({\n              uid: (rtmProps === null || rtmProps === void 0 ? void 0 : rtmProps.uid) || localUid.current,\n              token: (rtmProps === null || rtmProps === void 0 ? void 0 : rtmProps.token) || undefined\n            })).then(function () {\n              timerValueRef.current = 5;\n            });\n          }, function () {\n            setTimeout(function () {\n              try {\n                timerValueRef.current = timerValueRef.current + timerValueRef.current;\n                login();\n                return Promise.resolve();\n              } catch (e) {\n                return Promise.reject(e);\n              }\n            }, timerValueRef.current * 1000);\n          });\n          if (_temp6 && _temp6.then) return _temp6.then(function () {});\n        }\n      }();\n      return Promise.resolve(_temp4 && _temp4.then ? _temp4.then(function () {}) : void 0);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  var joinChannel = function joinChannel() {\n    try {\n      var _temp8 = _catch(function () {\n        return Promise.resolve(channel.join()).then(function () {\n          timerValueRef.current = 5;\n        });\n      }, function () {\n        setTimeout(function () {\n          try {\n            timerValueRef.current = timerValueRef.current + timerValueRef.current;\n            joinChannel();\n            return Promise.resolve();\n          } catch (e) {\n            return Promise.reject(e);\n          }\n        }, timerValueRef.current * 1000);\n      });\n      return Promise.resolve(_temp8 && _temp8.then ? _temp8.then(function () {}) : void 0);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  var init = function init() {\n    try {\n      setRtmStatus(rtmStatusEnum.initialising);\n      rtcProps.uid ? localUid.current = String(rtcProps.uid) : localUid.current = String(timeNow());\n      rtmClient.on('ConnectionStateChanged', function (state, reason) {\n        console.log(state, reason);\n      });\n      rtmClient.on('TokenExpired', function () {\n        try {\n          var tokenUrl = rtcProps.tokenUrl;\n          console.log('token expired - renewing');\n          var _temp11 = function () {\n            if (tokenUrl) {\n              var _temp12 = _catch(function () {\n                return Promise.resolve(fetch(tokenUrl + '/rtm/' + ((rtmProps === null || rtmProps === void 0 ? void 0 : rtmProps.uid) || localUid.current))).then(function (res) {\n                  return Promise.resolve(res.json()).then(function (data) {\n                    var serverToken = data.rtmToken;\n                    return Promise.resolve(rtmClient.renewToken(serverToken)).then(function () {\n                      timerValueRef.current = 5;\n                    });\n                  });\n                });\n              }, function (error) {\n                console.error('TokenExpiredError', error);\n              });\n              if (_temp12 && _temp12.then) return _temp12.then(function () {});\n            }\n          }();\n          return Promise.resolve(_temp11 && _temp11.then ? _temp11.then(function () {}) : void 0);\n        } catch (e) {\n          return Promise.reject(e);\n        }\n      });\n      rtmClient.on('MessageFromPeer', function (message, peerId) {\n        handleReceivedMessage(message, peerId);\n      });\n      channel.on('ChannelMessage', function (message, peerId) {\n        handleReceivedMessage(message, peerId);\n      });\n      channel.on('MemberJoined', function (peerId) {\n        try {\n          return Promise.resolve(sendPeerMessage(createUserData(), peerId)).then(function () {});\n        } catch (e) {\n          return Promise.reject(e);\n        }\n      });\n      channel.on('MemberCountUpdated', function (count) {\n        try {\n          console.log('RTM-MemberCountUpdated: ', count);\n          return Promise.resolve();\n        } catch (e) {\n          return Promise.reject(e);\n        }\n      });\n      if (rtmCallbacks !== null && rtmCallbacks !== void 0 && rtmCallbacks.channel) {\n        Object.keys(rtmCallbacks.channel).map(function (callback) {\n          if (rtmCallbacks.channel) {\n            channel.on(callback, rtmCallbacks.channel[callback]);\n          }\n        });\n      } else if (rtmCallbacks !== null && rtmCallbacks !== void 0 && rtmCallbacks.client) {\n        Object.keys(rtmCallbacks.client).map(function (callback) {\n          if (rtmCallbacks.client) {\n            rtmClient.on(callback, rtmCallbacks.client[callback]);\n          }\n        });\n      }\n      if (rtcProps.tokenUrl) {\n        var tokenUrl = rtcProps.tokenUrl,\n          uid = rtcProps.uid;\n        rtmClient.on('TokenExpired', function () {\n          try {\n            console.log('token expired');\n            return Promise.resolve(fetch(tokenUrl + '/rtm/' + (uid || 0) + '/')).then(function (res) {\n              return Promise.resolve(res.json()).then(function (data) {\n                var token = data.rtmToken;\n                rtmClient.renewToken(token);\n              });\n            });\n          } catch (e) {\n            return Promise.reject(e);\n          }\n        });\n      }\n      setRtmStatus(rtmStatusEnum.loggingIn);\n      return Promise.resolve(login()).then(function () {\n        setRtmStatus(rtmStatusEnum.loggedIn);\n        return Promise.resolve(joinChannel()).then(function () {\n          setRtmStatus(rtmStatusEnum.connected);\n          setUsernames(function (p) {\n            return _extends({}, p, {\n              0: rtmProps === null || rtmProps === void 0 ? void 0 : rtmProps.username\n            });\n          });\n          sendChannelMessage(createUserData());\n        });\n      });\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  var createUserData = function createUserData() {\n    return {\n      messageType: 'UserData',\n      rtmId: (rtmProps === null || rtmProps === void 0 ? void 0 : rtmProps.uid) || localUid.current,\n      rtcId: rtcUid.current,\n      username: rtmProps === null || rtmProps === void 0 ? void 0 : rtmProps.username,\n      role: rtcProps.role === 'audience' ? 1 : 0,\n      uikit: {\n        platform: 'web',\n        framework: 'react',\n        version: '1.2.0'\n      },\n      agora: {\n        rtm: AgoraRTM.VERSION,\n        rtc: AgoraRTC.VERSION\n      }\n    };\n  };\n  var sendMuteRequest = function sendMuteRequest(device, rtcId, mute) {\n    var forced = (rtmProps === null || rtmProps === void 0 ? void 0 : rtmProps.showPopUpBeforeRemoteMute) === false;\n    var payload = {\n      messageType: 'MuteRequest',\n      device: device,\n      rtcId: rtcId,\n      mute: mute,\n      isForceful: forced\n    };\n    var peerId = uidMap[rtcId];\n    if (forced && !mute) {\n      console.log('cannot send force unmute request');\n    } else if (peerId) {\n      sendPeerMessage(payload, peerId);\n    } else {\n      console.log('peer not found');\n    }\n  };\n  var handleReceivedMessage = function handleReceivedMessage(message, peerId) {\n    var messageObject;\n    if (message.messageType === 'RAW') {\n      messageObject = parsePayload(message.rawMessage);\n    } else if (message.messageType === 'TEXT') {\n      messageObject = JSON.parse(message.text);\n    }\n    console.log(messageObject, peerId);\n    if (messageObject) {\n      switch (messageObject.messageType) {\n        case 'UserData':\n          handleReceivedUserDataMessage(messageObject);\n          break;\n        case 'MuteRequest':\n          handleReceivedMuteMessage(messageObject);\n          break;\n        case 'RtmDataRequest':\n          switch (messageObject.type) {\n            case 'ping':\n              handlePing(peerId);\n              break;\n            case 'userData':\n              handleUserDataRequest(peerId);\n              break;\n            default:\n              console.log(peerId);\n          }\n          break;\n        default:\n          console.log('unknown message content');\n      }\n    } else {\n      console.log('unknown rtm message type');\n    }\n  };\n  var handleReceivedUserDataMessage = function handleReceivedUserDataMessage(userData) {\n    setUidMap(function (p) {\n      var _extends2;\n      return _extends({}, p, (_extends2 = {}, _extends2[userData.rtcId] = userData.rtmId, _extends2));\n    });\n    setUsernames(function (p) {\n      var _extends3;\n      return _extends({}, p, (_extends3 = {}, _extends3[userData.rtcId] = userData.username, _extends3));\n    });\n    setUserDataMap(function (p) {\n      var _extends4;\n      return _extends({}, p, (_extends4 = {}, _extends4[userData.rtmId] = userData, _extends4));\n    });\n  };\n  var handleReceivedMuteMessage = function handleReceivedMuteMessage(muteRequest) {\n    if (rtcUid.current === muteRequest.rtcId) {\n      if (muteRequest.isForceful) {\n        if (muteRequest.mute) {\n          if (muteRequest.device === mutingDevice.microphone) {\n            localAudioTrack && muteAudio(local, dispatch, localAudioTrack);\n          } else if (muteRequest.device === mutingDevice.camera) {\n            localVideoTrack && muteVideo(local, dispatch, localVideoTrack);\n          }\n        } else console.error('cannot force unmute');\n      } else {\n        if (muteRequest.device === mutingDevice.microphone) {\n          if (muteRequest.mute) setPopUpState(popUpStateEnum.muteMic);else setPopUpState(popUpStateEnum.unmuteMic);\n        } else if (muteRequest.device === mutingDevice.camera) {\n          if (muteRequest.mute) setPopUpState(popUpStateEnum.muteCamera);else setPopUpState(popUpStateEnum.unmuteCamera);\n        }\n      }\n    }\n  };\n  var handlePing = function handlePing(peerId) {\n    sendPeerMessage({\n      messageType: 'RtmDataRequest',\n      type: 'pong'\n    }, peerId);\n  };\n  var handleUserDataRequest = function handleUserDataRequest(peerId) {\n    sendPeerMessage(createUserData(), peerId);\n  };\n  var sendChannelMessage = function sendChannelMessage(payload) {\n    try {\n      var message = rtmClient.createMessage({\n        text: JSON.stringify(payload),\n        messageType: AgoraRTM.MessageType.TEXT\n      });\n      var _temp14 = _catch(function () {\n        return Promise.resolve(channel.sendMessage(message)).then(function () {});\n      }, function (e) {\n        console.error(e);\n      });\n      return Promise.resolve(_temp14 && _temp14.then ? _temp14.then(function () {}) : void 0);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  var sendPeerMessage = function sendPeerMessage(payload, peerId) {\n    try {\n      var message = rtmClient.createMessage({\n        text: JSON.stringify(payload),\n        messageType: AgoraRTM.MessageType.TEXT\n      });\n      var _temp16 = _catch(function () {\n        return Promise.resolve(rtmClient.sendMessageToPeer(message, String(peerId))).then(function () {});\n      }, function (e) {\n        console.error(e);\n      });\n      return Promise.resolve(_temp16 && _temp16.then ? _temp16.then(function () {}) : void 0);\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  var end = function end() {\n    try {\n      return Promise.resolve(rtmClient.logout()).then(function () {\n        return Promise.resolve(rtmClient.removeAllListeners()).then(function () {});\n      });\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n  useEffect(function () {\n    if (channelJoined) {\n      init();\n      setLoggedIn(true);\n    }\n    return function () {\n      if (channelJoined) {\n        end();\n      }\n    };\n  }, [rtcProps.channel, rtcProps.appId, channelJoined]);\n  return React.createElement(RtmProvider, {\n    value: {\n      rtmStatus: rtmStatus,\n      sendPeerMessage: sendPeerMessage,\n      sendChannelMessage: sendChannelMessage,\n      sendMuteRequest: sendMuteRequest,\n      rtmClient: rtmClient,\n      uidMap: uidMap,\n      usernames: usernames,\n      userDataMap: userDataMap,\n      popUpState: popUpState,\n      setPopUpState: setPopUpState\n    }\n  }, isLoggedIn ? props.children : React.createElement(React.Fragment, null));\n};\nvar enc = new TextEncoder();\nvar dec = new TextDecoder();\nvar createRawMessage = function createRawMessage(msg) {\n  return enc.encode(JSON.stringify(msg));\n};\nvar parsePayload = function parsePayload(data) {\n  return JSON.parse(dec.decode(data));\n};\nfunction PopUp() {\n  var _useContext = useContext(PropsContext),\n    styleProps = _useContext.styleProps;\n  var _useContext2 = useContext(RtmContext),\n    popUpState = _useContext2.popUpState,\n    setPopUpState = _useContext2.setPopUpState;\n  var _ref = styleProps || {},\n    popUpContainer = _ref.popUpContainer;\n  var _useContext3 = useContext(RtcContext),\n    dispatch = _useContext3.dispatch,\n    localVideoTrack = _useContext3.localVideoTrack,\n    localAudioTrack = _useContext3.localAudioTrack;\n  var local = useContext(LocalContext);\n  return popUpState !== popUpStateEnum.closed ? React.createElement(\"div\", {\n    style: _extends({}, styles$3.container, popUpContainer)\n  }, React.createElement(\"div\", {\n    style: {\n      color: '#fff',\n      fontSize: 18,\n      fontWeight: 700\n    }\n  }, popUpState === popUpStateEnum.muteCamera || popUpState === popUpStateEnum.muteMic ? 'Mute ' : 'Unmute ', popUpState === popUpStateEnum.muteCamera || popUpState === popUpStateEnum.unmuteCamera ? 'Camera' : 'Mic', \"?\"), React.createElement(\"div\", {\n    style: {\n      flexDirection: 'row',\n      display: 'flex',\n      width: '100%',\n      justifyContent: 'space-around'\n    }\n  }, React.createElement(\"div\", {\n    onClick: function onClick() {\n      switch (popUpState) {\n        case popUpStateEnum.muteCamera:\n          local.hasVideo && localVideoTrack && muteVideo(local, dispatch, localVideoTrack);\n          break;\n        case popUpStateEnum.muteMic:\n          local.hasAudio && localAudioTrack && muteAudio(local, dispatch, localAudioTrack);\n          break;\n        case popUpStateEnum.unmuteCamera:\n          !local.hasVideo && localVideoTrack && muteVideo(local, dispatch, localVideoTrack);\n          break;\n        case popUpStateEnum.unmuteMic:\n          !local.hasAudio && localAudioTrack && muteAudio(local, dispatch, localAudioTrack);\n          break;\n      }\n      setPopUpState(popUpStateEnum.closed);\n    },\n    style: styles$3.button\n  }, \"Confirm\"), React.createElement(\"div\", {\n    style: styles$3.buttonClose,\n    onClick: function onClick() {\n      return setPopUpState(popUpStateEnum.closed);\n    }\n  }, \"Close\"))) : null;\n}\nvar styles$3 = {\n  button: {\n    color: '#fff',\n    cursor: 'pointer',\n    borderWidth: 2,\n    borderStyle: 'solid',\n    borderColor: '#fff',\n    padding: '2px 4px',\n    borderRadius: 4\n  },\n  buttonClose: {\n    color: '#fff',\n    cursor: 'pointer',\n    borderWidth: 2,\n    borderStyle: 'solid',\n    borderColor: '#fff',\n    padding: '2px 4px',\n    borderRadius: 4\n  },\n  container: {\n    backgroundColor: '#007bffaa',\n    position: 'absolute',\n    width: 240,\n    height: 80,\n    top: '50%',\n    left: '50%',\n    transform: 'translate(-50%, -50%)',\n    zIndex: 100,\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'space-evenly',\n    alignItems: 'center'\n  }\n};\nvar AgoraUIKit = function AgoraUIKit(props) {\n  var styleProps = props.styleProps,\n    rtcProps = props.rtcProps;\n  var _ref = styleProps || {},\n    UIKitContainer = _ref.UIKitContainer;\n  return React.createElement(PropsProvider, {\n    value: props\n  }, React.createElement(\"div\", {\n    style: _extends({}, style$1, UIKitContainer)\n  }, rtcProps.role === 'audience' ? React.createElement(VideocallUI, null) : React.createElement(TracksConfigure, null, React.createElement(VideocallUI, null))));\n};\nvar VideocallUI = function VideocallUI() {\n  var _useContext = useContext(PropsContext),\n    rtcProps = _useContext.rtcProps;\n  return React.createElement(RtcConfigure, {\n    callActive: rtcProps.callActive\n  }, React.createElement(LocalUserContext, null, rtcProps.disableRtm ? React.createElement(React.Fragment, null, (rtcProps === null || rtcProps === void 0 ? void 0 : rtcProps.layout) === layout.grid ? React.createElement(GridVideo, null) : React.createElement(PinnedVideo, null), React.createElement(LocalControls, null)) : React.createElement(RtmConfigure, null, React.createElement(PopUp, null), (rtcProps === null || rtcProps === void 0 ? void 0 : rtcProps.layout) === layout.grid ? React.createElement(GridVideo, null) : React.createElement(PinnedVideo, null), React.createElement(LocalControls, null))));\n};\nvar style$1 = {\n  display: 'flex',\n  flex: 1,\n  minHeight: 0,\n  flexDirection: 'column'\n};\nexport default AgoraUIKit;\nexport { BtnTemplate, EndCall, GridVideo, LocalAudioMute, LocalControls, LocalUserContext, LocalVideoMute, MaxUidContext, MaxVideoView, MinUidContext, MinVideoView, PinnedVideo, PropsContext, RemoteAudioMute, PopUp as RemoteMutePopUp, RemoteVideoMute, RtcConfigure, RtcConsumer, RtcContext, RtcProvider, RtmConfigure, RtmConsumer, RtmContext, RtmProvider, SwapUser, ToggleState, TracksConfigure, TracksContext, VideoPlaceholder, VideocallUI, createRawMessage, icons, layout, muteAudio, muteVideo, mutingDevice, parsePayload, popUpStateEnum, rtmStatusEnum };","map":{"version":3,"names":["_iteratorSymbol","Symbol","iterator","_asyncIteratorSymbol","asyncIterator","_catch","body","recover","result","e","then","RtcContext","React","createContext","RtcProvider","Provider","RtcConsumer","Consumer","remoteTrackState","layout","ToggleState","initialValue","rtcProps","appId","channel","role","rtmProps","PropsContext","PropsProvider","MaxUidContext","MaxUidProvider","MaxUidConsumer","MinUidContext","MinUidProvider","MinUidConsumer","TracksContext","TracksProvider","initState","max","uid","hasAudio","no","hasVideo","min","isScreensharing","reducer","state","action","stateUpdate","uids","concat","map","u","type","_extends","value","console","log","user","subbed","indexOf","minUpdate","length","UIKitUser","find","_minUpdate","filter","_minUpdate2","pop","startScreenshare","track","screenshareToken","screenshareUid","tokenUrl","enableDualStream","init","screenClient","on","Promise","resolve","fetch","res","json","data","token","rtcToken","renewToken","reject","leave","removeAllListeners","join","setClientRole","_temp3","_temp4","_screenClient$join","returnedUid","_screenClient$join2","publish","enabled","_temp9","localVideoTrackHasPublished","_temp6","_temp11","_temp10","AgoraRTC","createClient","mode","codec","stop","close","_temp13","stopScreenshare","useClient","RtcConfigure","props","useRef","screenTrack","isScreensharingRef","_useContext","useContext","localVideoTrack","localAudioTrack","_useContext2","callbacks","_useState","useState","ready","setReady","_useState2","channelJoined","setChannelJoined","joinRes","canJoin","client","customRtcClient","localAudioTrackHasPublished","mediaStore","callActive","undefined","_useReducer","useReducer","uidState","dispatch","useEffect","args","Array","_len","_key","arguments","remoteUser","current","_len2","_key2","mediaType","subscribe","_e","_remoteUser$audioTrac","audioTrack","play","dualStreamMode","setStreamFallbackOption","_len3","_key3","_remoteUser$audioTrac2","_len4","_key4","curState","prevState","reason","_len5","_key5","_uid","events","Object","keys","_len6","_key6","apply","userUid","ignore","_temp5","_client$join","_client$join2","error","err","_temp8","_temp14","_temp16","_temp15","videoTrack","enableActiveSpeaker","activeSpeaker","grid","volumes","highestvolumeObj","reduce","highestVolume","volume","level","mapActiveSpeakerToZero","enableAudioVolumeIndicator","_temp18","toggleScreensharing","start","createScreenVideoTrack","_AgoraRTC$createScree","createElement","localUid","children","icons","videocam","Fragment","points","x","y","width","height","rx","ry","videocamOff","d","x1","y1","x2","y2","remoteSwap","callEnd","mic","micOff","screen","BtnTemplate","onClick","name","disabled","style","styleProps","_ref","theme","BtnTemplateStyles","iconSize","customIcon","borderRadius","borderWidth","borderStyle","borderColor","backgroundColor","alignItems","justifyContent","display","cursor","margin","src","alt","xmlns","viewBox","fill","opacity","stroke","strokeWidth","strokeLinecap","strokeLinejoin","EndCall","localBtnStyles","_ref2","endCall","LocalContext","LocalUserContext","localUser","muteAudio","localState","newState","disabling","enabling","setEnabled","LocalAudioMute","muteLocalAudio","local","Screenshare","screenshare","muteVideo","LocalVideoMute","muteLocalVideo","LocalControls","localBtnContainer","zIndex","flexDirection","enableScreensharing","rtmStatusEnum","clientRoleRaw","mutingDevice","popUpStateEnum","RtmContext","RtmProvider","RtmConsumer","RemoteVideoMute","sendMuteRequest","uidMap","remoteBtnStyles","muteRemoteVideo","isMuted","camera","RemoteAudioMute","muteRemoteAudio","microphone","SwapUser","VideoPlaceholder","maxViewStyles","maxViewOverlayContainer","CustomVideoPlaceholder","key","imgContainer","img","isShown","btnContainer","showButtons","disableRtm","showSwap","flex","position","alignSelf","justifySelf","Username","usernames","displayUsername","styles","username","usernameText","background","padding","color","bottom","right","MaxVideoView","videoMode","renderModeProp","setIsShown","styles$1","container","onMouseEnter","onMouseLeave","videoContainer","AgoraVideoPlayer","videoplayer","config","fit","overlay","MinVideoView","minViewStyles","minViewOverlayContainer","PinnedVideo","minViewContainer","pinnedVideoContainer","maxViewContainer","scrollViewContainer","parentRef","setWidth","setHeight","isLandscape","handleResize","offsetWidth","offsetHeight","window","addEventListener","removeEventListener","ref","overflow","maxUsers","className","styles$2","scrollbar","overflowY","overflowX","minUsers","minHeight","minWidth","GridVideo","gridVideoCells","gridVideoContainer","users","innerWidth","innerHeight","unit","gridTemplateColumns","repeat","useTracks","createMicrophoneAndCameraTracks","encoderConfig","TracksConfigure","setLocalVideoTrack","_useState3","setLocalAudioTrack","_useTracks","trackReady","tracks","_tracks$","_tracks$2","timeNow","Date","getTime","useChannel","createLazyChannel","useClient$1","createLazyClient","RtmConfigure","isLoggedIn","setLoggedIn","rtmClient","timerValueRef","rtmCallbacks","setUidMap","setUsernames","_useState4","userDataMap","setUserDataMap","_useState5","closed","popUpState","setPopUpState","_useState6","offline","rtmStatus","setRtmStatus","_useContext3","rtcUid","login","serverToken","rtmToken","setTimeout","joinChannel","initialising","String","_temp12","message","peerId","handleReceivedMessage","sendPeerMessage","createUserData","count","callback","loggingIn","loggedIn","connected","p","sendChannelMessage","messageType","rtmId","rtcId","uikit","platform","framework","version","agora","rtm","AgoraRTM","VERSION","rtc","device","mute","forced","showPopUpBeforeRemoteMute","payload","isForceful","messageObject","parsePayload","rawMessage","JSON","parse","text","handleReceivedUserDataMessage","handleReceivedMuteMessage","handlePing","handleUserDataRequest","userData","_extends2","_extends3","_extends4","muteRequest","muteMic","unmuteMic","muteCamera","unmuteCamera","createMessage","stringify","MessageType","TEXT","sendMessage","sendMessageToPeer","end","logout","enc","TextEncoder","dec","TextDecoder","createRawMessage","msg","encode","decode","PopUp","popUpContainer","styles$3","fontSize","fontWeight","button","buttonClose","top","left","transform","AgoraUIKit","UIKitContainer","style$1","VideocallUI"],"sources":["D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\node_modules\\babel-plugin-transform-async-to-promises\\helpers.mjs","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\RtcContext.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\PropsContext.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\MaxUidContext.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\MinUidContext.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\TracksContext.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Reducer.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Controls\\Local\\screenshareFunctions.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\RTCConfigure.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Controls\\Icons.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Controls\\BtnTemplate.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Controls\\Local\\EndCall.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\LocalUserContext.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Controls\\Local\\muteAudio.ts","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Controls\\Local\\LocalAudioMute.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Controls\\Local\\Screenshare.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Controls\\Local\\muteVideo.ts","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Controls\\Local\\LocalVideoMute.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Controls\\LocalControls.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\RtmContext.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Controls\\Remote\\RemoteVideoMute.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Controls\\Remote\\RemoteAudioMute.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Controls\\SwapUser.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\VideoPlaceholder.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Username.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\MaxVideoView.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\MinVideoView.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\PinnedVideo.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\GridVideo.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\TracksConfigure.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\RTMConfigure.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\Controls\\Remote\\RemoteMutePopUp.tsx","D:\\MY FILES\\Calling Process\\node_modules\\agora-react-uikit\\src\\AgoraUIKit.tsx"],"sourcesContent":["// A type of promise-like that resolves synchronously and supports only one observer\nexport const _Pact = /*#__PURE__*/(function() {\n\tfunction _Pact() {}\n\t_Pact.prototype.then = function(onFulfilled, onRejected) {\n\t\tconst result = new _Pact();\n\t\tconst state = this.s;\n\t\tif (state) {\n\t\t\tconst callback = state & 1 ? onFulfilled : onRejected;\n\t\t\tif (callback) {\n\t\t\t\ttry {\n\t\t\t\t\t_settle(result, 1, callback(this.v));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t_settle(result, 2, e);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t\tthis.o = function(_this) {\n\t\t\ttry {\n\t\t\t\tconst value = _this.v;\n\t\t\t\tif (_this.s & 1) {\n\t\t\t\t\t_settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n\t\t\t\t} else if (onRejected) {\n\t\t\t\t\t_settle(result, 1, onRejected(value));\n\t\t\t\t} else {\n\t\t\t\t\t_settle(result, 2, value);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(result, 2, e);\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n\treturn _Pact;\n})();\n\n// Settles a pact synchronously\nexport function _settle(pact, state, value) {\n\tif (!pact.s) {\n\t\tif (value instanceof _Pact) {\n\t\t\tif (value.s) {\n\t\t\t\tif (state & 1) {\n\t\t\t\t\tstate = value.s;\n\t\t\t\t}\n\t\t\t\tvalue = value.v;\n\t\t\t} else {\n\t\t\t\tvalue.o = _settle.bind(null, pact, state);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif (value && value.then) {\n\t\t\tvalue.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n\t\t\treturn;\n\t\t}\n\t\tpact.s = state;\n\t\tpact.v = value;\n\t\tconst observer = pact.o;\n\t\tif (observer) {\n\t\t\tobserver(pact);\n\t\t}\n\t}\n}\n\nexport function _isSettledPact(thenable) {\n\treturn thenable instanceof _Pact && thenable.s & 1;\n}\n\n// Converts argument to a function that always returns a Promise\nexport function _async(f) {\n\treturn function() {\n\t\tfor (var args = [], i = 0; i < arguments.length; i++) {\n\t\t\targs[i] = arguments[i];\n\t\t}\n\t\ttry {\n\t\t\treturn Promise.resolve(f.apply(this, args));\n\t\t} catch(e) {\n\t\t\treturn Promise.reject(e);\n\t\t}\n\t}\n}\n\n// Awaits on a value that may or may not be a Promise (equivalent to the await keyword in ES2015, with continuations passed explicitly)\nexport function _await(value, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(value) : value;\n\t}\n\tif (!value || !value.then) {\n\t\tvalue = Promise.resolve(value);\n\t}\n\treturn then ? value.then(then) : value;\n}\n\n// Awaits on a value that may or may not be a Promise, then ignores it\nexport function _awaitIgnored(value, direct) {\n\tif (!direct) {\n\t\treturn value && value.then ? value.then(_empty) : Promise.resolve();\n\t}\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continue(value, then) {\n\treturn value && value.then ? value.then(then) : then(value);\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continueIgnored(value) {\n\tif (value && value.then) {\n\t\treturn value.then(_empty);\n\t}\n}\n\n// Asynchronously iterate through an object that has a length property, passing the index as the first argument to the callback (even as the length property changes)\nexport function _forTo(array, body, check) {\n\tvar i = -1, pact, reject;\n\tfunction _cycle(result) {\n\t\ttry {\n\t\t\twhile (++i < array.length && (!check || !check())) {\n\t\t\t\tresult = body(i);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (pact) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t} else {\n\t\t\t\tpact = result;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t}\n\t}\n\t_cycle();\n\treturn pact;\n}\n\n// Asynchronously iterate through an object's properties (including properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forIn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tkeys.push(key);\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\n// Asynchronously iterate through an object's own properties (excluding properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forOwn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tif (Object.prototype.hasOwnProperty.call(target, key)) {\n\t\t\tkeys.push(key);\n\t\t}\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\nexport const _iteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\"))) : \"@@iterator\";\n\n// Asynchronously iterate through an object's values\n// Uses for...of if the runtime supports it, otherwise iterates until length on a copy\nexport function _forOf(target, body, check) {\n\tif (typeof target[_iteratorSymbol] === \"function\") {\n\t\tvar iterator = target[_iteratorSymbol](), step, pact, reject;\n\t\tfunction _cycle(result) {\n\t\t\ttry {\n\t\t\t\twhile (!(step = iterator.next()).done && (!check || !check())) {\n\t\t\t\t\tresult = body(step.value);\n\t\t\t\t\tif (result && result.then) {\n\t\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pact) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t} else {\n\t\t\t\t\tpact = result;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t\t}\n\t\t}\n\t\t_cycle();\n\t\tif (iterator.return) {\n\t\t\tvar _fixup = function(value) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!step.done) {\n\t\t\t\t\t\titerator.return();\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tif (pact && pact.then) {\n\t\t\t\treturn pact.then(_fixup, function(e) {\n\t\t\t\t\tthrow _fixup(e);\n\t\t\t\t});\n\t\t\t}\n\t\t\t_fixup();\n\t\t}\n\t\treturn pact;\n\t}\n\t// No support for Symbol.iterator\n\tif (!(\"length\" in target)) {\n\t\tthrow new TypeError(\"Object is not iterable\");\n\t}\n\t// Handle live collections properly\n\tvar values = [];\n\tfor (var i = 0; i < target.length; i++) {\n\t\tvalues.push(target[i]);\n\t}\n\treturn _forTo(values, function(i) { return body(values[i]); }, check);\n}\n\nexport const _asyncIteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\"))) : \"@@asyncIterator\";\n\n// Asynchronously iterate on a value using it's async iterator if present, or its synchronous iterator if missing\nexport function _forAwaitOf(target, body, check) {\n\tif (typeof target[_asyncIteratorSymbol] === \"function\") {\n\t\tvar pact = new _Pact();\n\t\tvar iterator = target[_asyncIteratorSymbol]();\n\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\treturn pact;\n\t\tfunction _resumeAfterBody(result) {\n\t\t\tif (check && check()) {\n\t\t\t\treturn _settle(pact, 1, iterator.return ? iterator.return().then(function() { return result; }) : result);\n\t\t\t}\n\t\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\t}\n\t\tfunction _resumeAfterNext(step) {\n\t\t\tif (step.done) {\n\t\t\t\t_settle(pact, 1);\n\t\t\t} else {\n\t\t\t\tPromise.resolve(body(step.value)).then(_resumeAfterBody).then(void 0, _reject);\n\t\t\t}\n\t\t}\n\t\tfunction _reject(error) {\n\t\t\t_settle(pact, 2, iterator.return ? iterator.return().then(function() { return error; }) : error);\n\t\t}\n\t}\n\treturn Promise.resolve(_forOf(target, function(value) { return Promise.resolve(value).then(body); }, check));\n}\n\n// Asynchronously implement a generic for loop\nexport function _for(test, update, body) {\n\tvar stage;\n\tfor (;;) {\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t\tif (shouldContinue.then) {\n\t\t\tstage = 0;\n\t\t\tbreak;\n\t\t}\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.s;\n\t\t\t} else {\n\t\t\t\tstage = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (update) {\n\t\t\tvar updateValue = update();\n\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\tstage = 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvar pact = new _Pact();\n\tvar reject = _settle.bind(null, pact, 2);\n\t(stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tdo {\n\t\t\tif (update) {\n\t\t\t\tupdateValue = update();\n\t\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\t\tupdateValue.then(_resumeAfterUpdate).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tshouldContinue = test();\n\t\t\tif (!shouldContinue || (_isSettledPact(shouldContinue) && !shouldContinue.v)) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t}\n\t\t} while (!result || !result.then);\n\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterBody(result);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n\tfunction _resumeAfterUpdate() {\n\t\tif (shouldContinue = test()) {\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterTest(shouldContinue);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a do ... while loop\nexport function _do(body, test) {\n\tvar awaitBody;\n\tdo {\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t} else {\n\t\t\t\tawaitBody = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t} while (!shouldContinue.then);\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : shouldContinue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tfor (;;) {\n\t\t\tshouldContinue = test();\n\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t}\n\t\t\tif (!shouldContinue) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\tresult = result.v;\n\t\t\t\t} else {\n\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tdo {\n\t\t\t\tresult = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tshouldContinue = test();\n\t\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t\t}\n\t\t\t\tif (!shouldContinue) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} while (!shouldContinue.then);\n\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a switch statement\nexport function _switch(discriminant, cases) {\n\tvar dispatchIndex = -1;\n\tvar awaitBody;\n\touter: {\n\t\tfor (var i = 0; i < cases.length; i++) {\n\t\t\tvar test = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvar testValue = test();\n\t\t\t\tif (testValue && testValue.then) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tif (testValue === discriminant) {\n\t\t\t\t\tdispatchIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Found the default case, set it as the pending dispatch case\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tif (dispatchIndex !== -1) {\n\t\t\tdo {\n\t\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\t\twhile (!body) {\n\t\t\t\t\tdispatchIndex++;\n\t\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t\t}\n\t\t\t\tvar result = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tawaitBody = true;\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\t\tdispatchIndex++;\n\t\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t\treturn result;\n\t\t}\n\t}\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : testValue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterTest(value) {\n\t\tfor (;;) {\n\t\t\tif (value === discriminant) {\n\t\t\t\tdispatchIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (++i === cases.length) {\n\t\t\t\tif (dispatchIndex !== -1) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttest = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvalue = test();\n\t\t\t\tif (value && value.then) {\n\t\t\t\t\tvalue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tvar result = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tdispatchIndex++;\n\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterBody(result) {\n\t\tfor (;;) {\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tif (!fallthroughCheck || fallthroughCheck()) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdispatchIndex++;\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _call(body, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(body()) : body();\n\t}\n\ttry {\n\t\tvar result = Promise.resolve(body());\n\t\treturn then ? result.then(then) : result;\n\t} catch (e) {\n\t\treturn Promise.reject(e);\n\t}\n}\n\n// Asynchronously call a function and swallow the result\nexport function _callIgnored(body, direct) {\n\treturn _call(body, _empty, direct);\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _invoke(body, then) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(then);\n\t}\n\treturn then(result);\n}\n\n// Asynchronously call a function and swallow the result\nexport function _invokeIgnored(body) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(_empty);\n\t}\n}\n\n// Asynchronously call a function and send errors to recovery continuation\nexport function _catch(body, recover) {\n\ttry {\n\t\tvar result = body();\n\t} catch(e) {\n\t\treturn recover(e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(void 0, recover);\n\t}\n\treturn result;\n}\n\n// Asynchronously await a promise and pass the result to a finally continuation\nexport function _finallyRethrows(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer(true, e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n\t}\n\treturn finalizer(false, result);\n}\n\n// Asynchronously await a promise and invoke a finally continuation that always overrides the result\nexport function _finally(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer();\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer, finalizer);\n\t}\n\treturn finalizer();\n}\n\n// Rethrow or return a value from a finally continuation\nexport function _rethrow(thrown, value) {\n\tif (thrown)\n\t\tthrow value;\n\treturn value;\n}\n\n// Empty function to implement break and other control flow that ignores asynchronous results\nexport function _empty() {\n}\n\n// Sentinel value for early returns in generators \nexport const _earlyReturn = /*#__PURE__*/ {};\n\n// Asynchronously call a function and send errors to recovery continuation, skipping early returns\nexport function _catchInGenerator(body, recover) {\n\treturn _catch(body, function(e) {\n\t\tif (e === _earlyReturn) {\n\t\t\tthrow e;\n\t\t}\n\t\treturn recover(e);\n\t});\n}\n\n// Asynchronous generator class; accepts the entrypoint of the generator, to which it passes itself when the generator should start\nexport const _AsyncGenerator = /*#__PURE__*/(function() {\n\tfunction _AsyncGenerator(entry) {\n\t\tthis._entry = entry;\n\t\tthis._pact = null;\n\t\tthis._resolve = null;\n\t\tthis._return = null;\n\t\tthis._promise = null;\n\t}\n\n\tfunction _wrapReturnedValue(value) {\n\t\treturn { value: value, done: true };\n\t}\n\tfunction _wrapYieldedValue(value) {\n\t\treturn { value: value, done: false };\n\t}\n\n\t_AsyncGenerator.prototype._yield = function(value) {\n\t\t// Yield the value to the pending next call\n\t\tthis._resolve(value && value.then ? value.then(_wrapYieldedValue) : _wrapYieldedValue(value));\n\t\t// Return a pact for an upcoming next/return/throw call\n\t\treturn this._pact = new _Pact();\n\t};\n\t_AsyncGenerator.prototype.next = function(value) {\n\t\t// Advance the generator, starting it if it has yet to be started\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tconst _entry = _this._entry;\n\t\t\t\tif (_entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the next call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Start the generator\n\t\t\t\t_this._entry = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\tfunction returnValue(value) {\n\t\t\t\t\t_this._resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t_this._resolve = null;\n\t\t\t\t}\n\t\t\t\tvar result = _entry(_this);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tresult.then(returnValue, function(error) {\n\t\t\t\t\t\tif (error === _earlyReturn) {\n\t\t\t\t\t\t\treturnValue(_this._return);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst pact = new _Pact();\n\t\t\t\t\t\t\t_this._resolve(pact);\n\t\t\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t\t\t_this._resolve = null;\n\t\t\t\t\t\t\t_resolve(pact, 2, error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturnValue(result);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Generator is started and a yield expression is pending, settle it\n\t\t\t\t_this._pact = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\t_settle(_pact, 1, value);\n\t\t\t}\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.return = function(value) {\n\t\t// Early return from the generator if started, otherwise abandons the generator\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the return call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return the specified value\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t}\n\t\t\t// Settle the yield expression with a rejected \"early return\" value\n\t\t\t_this._return = value;\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, _earlyReturn);\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.throw = function(error) {\n\t\t// Inject an exception into the pending yield expression\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve, reject) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the throw call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return a rejected Promise containing the error\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn reject(error);\n\t\t\t}\n\t\t\t// Settle the yield expression with the value as a rejection\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, error);\n\t\t});\n\t};\n\n\t_AsyncGenerator.prototype[_asyncIteratorSymbol] = function() {\n\t\treturn this;\n\t};\n\t\n\treturn _AsyncGenerator;\n})();\n","import React from 'react'\nimport {\n  IAgoraRTCClient,\n  ILocalAudioTrack,\n  ILocalVideoTrack,\n  UID\n} from 'agora-rtc-react'\nimport { CallbacksInterface, mediaStore } from './PropsContext'\n\nexport type DispatchType = <\n  T extends keyof CallbacksInterface,\n  V extends Parameters<CallbacksInterface[T]>\n>(action: {\n  type: T\n  value: V\n}) => void\n\n/**\n * Interface for the RtcContext\n */\nexport interface RtcContextInterface {\n  /**\n   * The client object used by the web SDK\n   */\n  client: IAgoraRTCClient\n  /**\n   * The local user's video track\n   */\n  localVideoTrack: ILocalVideoTrack | null\n  /**\n   * The local user's audio track\n   */\n  localAudioTrack: ILocalAudioTrack | null\n  /**\n   * An object containing a key value store of tracks mapped to users UIDs\n   */\n  mediaStore: mediaStore\n  /**\n   * React dispatch to update values in the reducer\n   */\n  dispatch: DispatchType\n  /**\n   * The local UID returned by the SDK when using local uid as 0.\n   */\n  localUid: React.MutableRefObject<UID | undefined>\n  /**\n   * Is the UIKit in a channel\n   */\n  channelJoined: boolean\n  toggleScreensharing: () => Promise<void>\n  isScreensharing: boolean\n}\n/**\n * Context to access local/remote tracks, client, dispatch and localuid. It's setup by {@link RtcConfigure}.\n */\nconst RtcContext = React.createContext<RtcContextInterface>(\n  {} as RtcContextInterface\n)\n\nexport interface ActionInterface<T extends keyof CallbacksInterface> {\n  type: T\n  value: Parameters<CallbacksInterface[T]>\n}\nexport type ActionType<T extends keyof CallbacksInterface> = ActionInterface<T>\n\nexport const RtcProvider = RtcContext.Provider\nexport const RtcConsumer = RtcContext.Consumer\nexport default RtcContext\n","import {\n  IAgoraRTCClient,\n  VideoPlayerConfig,\n  IRemoteAudioTrack,\n  IRemoteVideoTrack,\n  ILocalVideoTrack,\n  ILocalAudioTrack,\n  UID,\n  RemoteStreamFallbackType,\n  ConnectionState,\n  ConnectionDisconnectedReason,\n  IAgoraRTCRemoteUser,\n  RemoteStreamType,\n  ChannelMediaRelayState,\n  ChannelMediaRelayError,\n  ChannelMediaRelayEvent,\n  NetworkQuality,\n  AgoraRTCError,\n  IMicrophoneAudioTrack,\n  ICameraVideoTrack\n} from 'agora-rtc-react'\n// import {RtmChannelEvents} from 'agora-rtm-react'\nimport React from 'react'\nimport { rtmCallbacks } from './RtmContext'\n\ninterface media {\n  videoTrack?: IRemoteVideoTrack\n  audioTrack?: IRemoteAudioTrack\n}\ninterface localMedia {\n  videoTrack?: ILocalVideoTrack\n  audioTrack?: ILocalAudioTrack\n}\n\nexport type mediaStore = {\n  [key in UID]: media | localMedia\n}\n\nexport enum remoteTrackState {\n  yes = 0, // remote published\n  subbed = 1, // remote published and subscribed\n  no = 2 // remote unpublished\n}\n\n/**\n * Data type for a UIKitUser\n */\nexport type UIKitUser = RemoteUIKitUser | LocalUIKitUser\nexport interface LocalUIKitUser {\n  /**\n   * The ID of the remote user.\n   */\n  uid: 0\n  /**\n   * Whether the remote user is sending an audio track.\n   * - `true`: The remote user is sending an audio track.\n   * - `false`: The remote user is not sending an audio track.\n   */\n  hasAudio: ToggleState\n  /**\n   * Whether the remote user is sending a video track.\n   * - `true`: The remote user is sending an audio track.\n   * - `false`: The remote user is not sending an audio track.\n   */\n  hasVideo: ToggleState\n}\nexport interface RemoteUIKitUser {\n  /**\n   * The ID of the remote user.\n   */\n  uid: UID\n  /**\n   * Whether the remote user is sending an audio track.\n   * - `true`: The remote user is sending an audio track.\n   * - `false`: The remote user is not sending an audio track.\n   */\n  hasAudio: remoteTrackState\n  /**\n   * Whether the remote user is sending a video track.\n   * - `true`: The remote user is sending an audio track.\n   * - `false`: The remote user is not sending an audio track.\n   */\n  hasVideo: remoteTrackState\n}\n\n/**\n * Remote Buttons styles\n */\ninterface remoteBtnStylesInterface {\n  /**\n   * Style for the remote mute audio button\n   */\n  muteRemoteAudio?: React.CSSProperties\n  /**\n   * Style for the remote mute video button\n   */\n  muteRemoteVideo?: React.CSSProperties\n  /**\n   * Style for the remote swap button in pinned layout\n   */\n  remoteSwap?: React.CSSProperties\n  /**\n   * Style for the overlay close button\n   */\n  minCloseBtnStyles?: React.CSSProperties\n}\n\n/**\n * Local Buttons styles\n */\ninterface localBtnStylesInterface {\n  /**\n   * Style for the local mute audio button\n   */\n  muteLocalAudio?: React.CSSProperties\n  /**\n   * Style for the local screenshare button\n   */\n  screenshare?: React.CSSProperties\n  /**\n   * Style for the local mute video button\n   */\n  muteLocalVideo?: React.CSSProperties\n  /**\n   * Style for the switch camera button\n   */\n  switchCamera?: React.CSSProperties\n  /**\n   * Style for the end call button\n   */\n  endCall?: React.CSSProperties\n}\n\n/**\n * Props object for customising the UI Kit, takes in react native styling\n */\nexport interface StylePropInterface {\n  /**\n   * Sets the scaling of the video\n   */\n  videoMode?: {\n    max?: VideoPlayerConfig['fit']\n    min?: VideoPlayerConfig['fit']\n  }\n  /**\n   * Color tint for icons\n   */\n  theme?: string\n  /**\n   * Color tint for icons\n   */\n  iconSize?: number\n  /**\n   * Custom base64 string for icon\n   */\n  customIcon?: Partial<IconsInterface>\n  /**\n   * Globals style for the local buttons (except end call)\n   */\n  BtnTemplateStyles?: React.CSSProperties\n  /**\n   * Style for the big view in pinned layout\n   */\n  maxViewStyles?: React.CSSProperties\n  /**\n   * Style for the small view in pinned layout\n   */\n  minViewStyles?: React.CSSProperties\n  /**\n   * Style for the small view container\n   */\n  minViewContainer?: React.CSSProperties\n  /**\n   * Style for the big view container\n   */\n  maxViewContainer?: React.CSSProperties\n  /**\n   * Style for the overlay on small user view when pressed in pinned layout\n   */\n  minViewOverlayContainer?: React.CSSProperties\n  /**\n   * Style for the overlay on small user view when pressed in pinned layout\n   */\n  maxViewOverlayContainer?: React.CSSProperties\n  /**\n   * Style for the remote button\n   */\n  remoteBtnStyles?: remoteBtnStylesInterface\n  /**\n   * Style for the remote button container\n   */\n  remoteBtnContainer?: React.CSSProperties\n  /**\n   * Style for specific local buttons, overrides the style applied by BtnTemplateStyles prop\n   */\n  localBtnStyles?: localBtnStylesInterface\n  /**\n   * Style for the local button container\n   */\n  localBtnContainer?: React.CSSProperties\n  /**\n   * Applies style to the individual cell (view) containing the video in the grid layout\n   */\n  gridVideoCells?: React.CSSProperties\n  /**\n   * Applies style to the grid container\n   */\n  gridVideoContainer?: React.CSSProperties\n  /**\n   * Applies style to the grid container\n   */\n  pinnedVideoContainer?: React.CSSProperties\n  /**\n   * Applies style to the pinned scrollview container\n   */\n  scrollViewContainer?: React.CSSProperties\n  /**\n   * Applies style to the global view containing the UI Kit\n   */\n  UIKitContainer?: React.CSSProperties\n  /**\n   * Applies style to the pop up container for remote mute requests\n   */\n  popUpContainer?: React.CSSProperties\n  /**\n   * Applies style to the displayed username text container\n   */\n  usernameText?: React.CSSProperties\n}\n\n/**\n * Props for the VideoPlaceholder component\n */\nexport interface VideoPlaceholderProps {\n  user: UIKitUser\n  /**\n   * State value to display buttons\n   */\n  isShown: boolean\n  showButtons?: boolean\n  showSwap?: boolean\n}\n\n/**\n * Props object for customising the UI Kit functionality\n */\nexport interface RtcPropsInterface {\n  /**\n   * React functional component for overriding the default video placeholder\n   */\n  CustomVideoPlaceholder?: React.FunctionComponent<VideoPlaceholderProps>\n  /**\n   * enable screensharing feature\n   */\n  enableScreensharing?: boolean\n  /**\n   * Agora App ID - used to authenticate the request\n   */\n  appId: string\n  /**\n   * Channel name to join - users in the same channel can communicate with each other\n   */\n  channel: string\n  /**\n   * UID for local user to join the channel (default: 0)\n   */\n  uid?: number\n  /**\n   * UID for local user to join the channel (default: 1)\n   */\n  screenshareUid?: number\n  /**\n   * Token used to join a channel when using secured mode (default: null)\n   */\n  token?: string | null\n  /**\n   * Token used to join a channel when using secured mode (default: null)\n   */\n   screenshareToken?: string | null\n  /**\n   * URL for token server, manages fetching and updating tokens automatically. Must follow the schema here - https://github.com/AgoraIO-Community/agora-token-service/\n   */\n  tokenUrl?: string\n  /**\n   * Set to true to enable active speaker callback, switches the pinned video to active speaker if you're using the pinned layout. (default: false)\n   */\n  activeSpeaker?: boolean\n  /**\n   * Once set to true, the UI Kit attempts to join the channel. Can be set to false to initialise the SDK and wait before joining the channel. (default: true)\n   */\n  callActive?: boolean\n  /**\n   * Pass in a custom RTC client, to use your own implementation of the AgoraRTCClient.\n   */\n  customRtcClient?: IAgoraRTCClient\n  /**\n   * Enables dual stream mode. (default: false)\n   */\n  enableDualStream?: boolean\n  /**\n   * Enable dual stream mode with selected fallback option. (default: disabled)\n   */\n  dualStreamMode?: RemoteStreamFallbackType\n  /**\n   * Choose between grid layout and pinned layout. (default: pinned layout)\n   */\n  layout?: layout\n  /**\n   * Set local user's role between audience and host. Use with mode set to livestreaming. (default: host)\n   */\n  role?: role\n  /**\n   * Enable the mic before joining the call. (default: true)\n   */\n  enableAudio?: boolean\n  /**\n   * Enable the camera before joining the call. Only use for initiak(default: true)\n   */\n  enableVideo?: boolean\n  /**\n   * Disable Agora RTM, this also disables the use of usernames and remote mute functionality\n   */\n  disableRtm?: boolean\n}\n\n/**\n * Props object for customising the UI Kit signalling functionality\n */\nexport interface RtmPropsInterface {\n  /**\n   * Username for the RTM Client, this value can be accessed using the userData object\n   */\n   username?: string\n   /**\n    * Token used to join an RTM channel when using secured mode (default: null)\n    */\n   token?: string | undefined\n   /**\n    * UID for local user to join the RTM channel (default: uses the RTC UID)\n    */\n   uid?: string\n   /**\n    * Show a pop up with option to accept mute request instead of directly muting the remote user (default: true), if set to false you cannot unmute users. \n    */\n   showPopUpBeforeRemoteMute?: boolean\n   /**\n    * Display RTM usernames in the Videocall (default: false)\n    */\n   displayUsername?: boolean\n}\n\n/**\n * Select a pre built layout\n */\nexport enum layout {\n  /**\n   * 0: Grid layout: each user occupies a cell in the grid\n   */\n  grid = 0,\n  /**\n   * 2: Pinned layout: MaxUser occupies the main view, the other users are in a floating view on top\n   */\n  pin = 1\n}\n\n/**\n * User role for live streaming mode\n */\ntype role = 'audience' | 'host'\n\n\nexport enum ToggleState {\n  disabled, // set as 0 - to evaluate falsy\n  enabled, // set as 1 - to evaluate truthy\n  disabling, // enabled -> disabling -> disabled\n  enabling // disabled -> enabling -> enabled\n}\n\n/**\n * Callbacks exposed by the UIKit\n */\nexport type CallbacksInterface = UIKitEventsInterface &\n  RtcEventsInterface\nexport interface UIKitEventsInterface {\n  EndCall(): void\n  ActiveSpeaker(uid: UID): void\n  Screensharing(state: boolean): void\n  ['update-user-video'](\n    tracks: [IMicrophoneAudioTrack, ICameraVideoTrack]\n  ): void\n  ['user-swap'](user: UIKitUser): void\n  ['local-user-mute-video'](status: ToggleState): void\n  ['local-user-mute-audio'](status: ToggleState): void\n  ['remote-user-mute-video'](user: UIKitUser, status: remoteTrackState): void\n  ['remote-user-mute-audio'](user: UIKitUser, status: remoteTrackState): void\n  ['leave-channel'](): void\n}\nexport interface RtcEventsInterface {\n  ['connection-state-change'](\n    curState: ConnectionState,\n    revState: ConnectionState,\n    reason?: ConnectionDisconnectedReason\n  ): void\n  ['user-joined'](user: IAgoraRTCRemoteUser): void\n  ['user-left'](user: IAgoraRTCRemoteUser, reason: string): void\n  ['user-published'](\n    user: IAgoraRTCRemoteUser,\n    mediaType: 'audio' | 'video'\n  ): void\n  ['user-unpublished'](\n    user: IAgoraRTCRemoteUser,\n    mediaType: 'audio' | 'video'\n  ): void\n  ['user-info-updated'](\n    uid: UID,\n    msg:\n      | 'mute-audio'\n      | 'mute-video'\n      | 'enable-local-video'\n      | 'unmute-audio'\n      | 'unmute-video'\n      | 'disable-local-video'\n  ): void\n  ['media-reconnect-start'](uid: UID, streamType: RemoteStreamType): void\n  ['media-reconnect-end'](uid: UID, streamType: RemoteStreamType): void\n  ['stream-type-changed'](uid: UID, streamType: RemoteStreamType): void\n  ['stream-fallback'](\n    uid: UID,\n    isFallbackOrRecover: 'fallback' | 'recover'\n  ): void\n  ['channel-media-relay-state'](\n    state: ChannelMediaRelayState,\n    code: ChannelMediaRelayError\n  ): void\n  ['channel-media-relay-event'](event: ChannelMediaRelayEvent): void\n  ['volume-indicator'](\n    result: {\n      level: number\n      uid: UID\n    }[]\n  ): void\n  ['crypt-error'](): void\n  ['token-privilege-will-expire'](): void\n  ['token-privilege-did-expire'](): void\n  ['network-quality'](stats: NetworkQuality): void\n  ['live-streaming-error'](url: string, err: AgoraRTCError): void\n  ['live-streaming-warning'](url: string, warning: AgoraRTCError): void\n  ['stream-inject-status'](\n    status: InjectStreamEventStatus,\n    uid: UID,\n    url: string\n  ): void\n  ['is-using-cloud-proxy'](isUsingProxy: boolean): void\n}\nexport interface PropsInterface {\n  /**\n   * Props used to customise the UIKit communication functionality\n   */\n  rtcProps: RtcPropsInterface\n  /**\n   * Props used to customise the UIKit signalling functionality\n   */\n  rtmProps?: RtmPropsInterface\n  /**\n   * Props used to customise the UI Kit's appearance (accepts style object for different components)\n   */\n  styleProps?: Partial<StylePropInterface>\n  /**\n   * Callbacks for different functions of the UI Kit\n   */\n  callbacks?: Partial<CallbacksInterface>\n  /**\n   * Callbacks for different functions of the UI Kit\n   */\n  rtmCallbacks?: rtmCallbacks\n}\n\n/**\n * Interface for icons supplied with the UIKit (curtosy of https://feathericons.com/)\n */\nexport interface IconsInterface {\n  /**\n   * Icon for Camera/Video mute in on state\n   */\n  videocam: string\n  /**\n   * Icon for Camera/Video mute in off state\n   */\n  videocamOff: string\n  /**\n   * Icon for Mic/Audio mute in on state\n   */\n  mic: string\n  /**\n   * Icon for Mic/Audio mute in off state\n   */\n  micOff: string\n  /**\n   * Icon to switch between device cameras\n   */\n  switchCamera: string\n  /**\n   * Icon to end the call\n   */\n  callEnd: string\n  /**\n   * Icon to swap the min user to max view\n   */\n  remoteSwap: string\n  /**\n   * Icon to close the overlay in floating layout\n   */\n  close: string\n}\n\nconst initialValue: PropsInterface = {\n  rtcProps: {\n    appId: '',\n    channel: '',\n    role: 'host'\n  },\n  rtmProps: {}\n}\n/**\n * React Context to manage the user props\n */\nconst PropsContext = React.createContext<PropsInterface>(initialValue)\n\nexport const PropsProvider = PropsContext.Provider\nexport const PropsConsumer = PropsContext.Consumer\n\nconst enum InjectStreamEventStatus {\n  /**\n   * Successfully injects the online media stream.\n   */\n  INJECT_STREAM_STATUS_START_SUCCESS = 0,\n  /**\n   * The online media stream already exists.\n   */\n  INJECT_STREAM_STATUS_START_ALREADY_EXISTS = 1,\n  /**\n   * Injecting the online media stream is not authorized.\n   */\n  INJECT_STREAM_STATUS_START_UNAUTHORIZED = 2,\n  /**\n   * Timeout when injecting the online media stream.\n   */\n  INJECT_STREAM_STATUS_START_TIMEOUT = 3,\n  /**\n   * Fails to inject the online media stream.\n   */\n  INJECT_STREAM_STATUS_START_FAILED = 4,\n  /**\n   * Succeessfully stops injecting the online media stream.\n   */\n  INJECT_STREAM_STATUS_STOP_SUCCESS = 5,\n  /**\n   * Fails to find the online media stream.\n   */\n  INJECT_STREAM_STATUS_STOP_NOT_FOUND = 6,\n  /**\n   * Stopping injecting the online media stream is not authorized.\n   */\n  INJECT_STREAM_STATUS_STOP_UNAUTHORIZED = 7,\n  /**\n   * Timeout when stopping the online media stream.\n   */\n  INJECT_STREAM_STATUS_STOP_TIMEOUT = 8,\n  INJECT_STREAM_STATUS_STOP_FAILED = 9,\n  /**\n   * The online media stream is corrupted.\n   */\n  INJECT_STREAM_STATUS_BROKEN = 10\n}\n\nexport default PropsContext\n","import React from 'react'\nimport { UIKitUser } from './PropsContext'\n\n/**\n * React context to expose user array displayed in the maximised view\n */\nconst MaxUidContext = React.createContext<UIKitUser[]>([])\n\nexport const MaxUidProvider = MaxUidContext.Provider\nexport const MaxUidConsumer = MaxUidContext.Consumer\nexport default MaxUidContext\n","import React from 'react'\nimport { UIKitUser } from './PropsContext'\n\n/**\n * React context to expose user array displayed in the minimized view\n */\nconst MinUidContext = React.createContext<UIKitUser[]>([])\n\nexport const MinUidProvider = MinUidContext.Provider\nexport const MinUidConsumer = MinUidContext.Consumer\nexport default MinUidContext\n","import React from 'react'\nimport { ILocalAudioTrack, ILocalVideoTrack } from 'agora-rtc-react'\n\nexport interface TracksContextInterface {\n  localVideoTrack: ILocalVideoTrack | null\n  localAudioTrack: ILocalAudioTrack | null\n}\n/**\n * React context that contains the local audio and video tracks. It's setup by {@link TracksConfigure}.\n */\nconst TracksContext = React.createContext<TracksContextInterface>(\n  {} as TracksContextInterface\n)\n\nexport const TracksProvider = TracksContext.Provider\nexport const TracksConsumer = TracksContext.Consumer\nexport default TracksContext\n","import { ActionType } from './RtcContext'\nimport {\n  UIKitUser,\n  remoteTrackState,\n  CallbacksInterface,\n  RemoteUIKitUser,\n  ToggleState\n} from './PropsContext'\nimport { UID } from 'agora-rtc-react'\nimport { actionTypeGuard } from './Utils/actionTypeGuard'\n\ntype stateType = {\n  max: UIKitUser[]\n  min: UIKitUser[]\n  isScreensharing: boolean\n}\n\nexport const initState = {\n  max: [\n    {\n      uid: 0,\n      hasAudio: remoteTrackState.no,\n      hasVideo: remoteTrackState.no\n    }\n  ] as UIKitUser[],\n  min: [] as UIKitUser[],\n  isScreensharing: false\n}\n\nconst reducer = (\n  state: stateType,\n  action: ActionType<keyof CallbacksInterface>\n) => {\n  let stateUpdate: Partial<stateType> = initState\n  const uids: UID[] = [...state.max, ...state.min].map((u: UIKitUser) => u.uid)\n\n  switch (action.type) {\n    case 'Screensharing':\n      if (actionTypeGuard(action, action.type)) {\n        stateUpdate = { ...state, isScreensharing: action.value[0] }\n        console.log('!Screensharingstate', state, stateUpdate)\n      }\n      break\n    case 'update-user-video':\n      if (actionTypeGuard(action, action.type)) {\n        stateUpdate = {\n          min: state.min.map((user: UIKitUser) => {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: remoteTrackState.subbed,\n                hasVideo: remoteTrackState.subbed\n              }\n            } else {\n              return user\n            }\n          }),\n          max: state.max.map((user: UIKitUser) => {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: remoteTrackState.subbed,\n                hasVideo: remoteTrackState.subbed\n              }\n            } else {\n              return user\n            }\n          }),\n          isScreensharing: state.isScreensharing\n        }\n      }\n      break\n    case 'user-joined':\n      if (actionTypeGuard(action, action.type)) {\n        if (uids.indexOf(action.value[0].uid) === -1) {\n          const minUpdate: stateType['min'] = [\n            ...state.min,\n            {\n              uid: action.value[0].uid,\n              hasAudio: remoteTrackState.no,\n              hasVideo: remoteTrackState.no\n            }\n          ]\n          if (minUpdate.length === 1 && state.max[0].uid === 0) {\n            stateUpdate = {\n              max: minUpdate,\n              min: state.max,\n              isScreensharing: state.isScreensharing\n            }\n          } else {\n            stateUpdate = {\n              min: minUpdate,\n              max: state.max,\n              isScreensharing: state.isScreensharing\n            }\n          }\n          // console.log('new user joined!\\n', action.value[0].uid)\n        }\n      }\n      break\n    case 'user-unpublished':\n      if (actionTypeGuard(action, action.type)) {\n        if (state.max[0].uid === action.value[0].uid) {\n          stateUpdate = {\n            max: [\n              {\n                uid: action.value[0].uid,\n                hasAudio:\n                  action.value[1] === 'audio'\n                    ? remoteTrackState.no\n                    : (state.max[0].hasAudio as remoteTrackState),\n                hasVideo:\n                  action.value[1] === 'video'\n                    ? remoteTrackState.no\n                    : (state.max[0].hasVideo as remoteTrackState)\n              }\n            ],\n            min: state.min,\n            isScreensharing: state.isScreensharing\n          }\n        } else {\n          const UIKitUser = state.min.find(\n            (user: UIKitUser) => user.uid === action.value[0].uid\n          )\n          if (UIKitUser) {\n            const minUpdate: stateType['min'] = [\n              ...state.min.filter(\n                (user: UIKitUser) => user.uid !== action.value[0].uid\n              ),\n              {\n                uid: action.value[0].uid,\n                hasAudio:\n                  action.value[1] === 'audio'\n                    ? remoteTrackState.no\n                    : (UIKitUser.hasAudio as remoteTrackState),\n                hasVideo:\n                  action.value[1] === 'video'\n                    ? remoteTrackState.no\n                    : (UIKitUser.hasVideo as remoteTrackState)\n              }\n            ]\n            stateUpdate = {\n              min: minUpdate,\n              max: state.max,\n              isScreensharing: state.isScreensharing\n            }\n          }\n        }\n      }\n      break\n    case 'user-published':\n      if (actionTypeGuard(action, action.type)) {\n        if (state.max[0].uid === action.value[0].uid) {\n          stateUpdate = {\n            max: [\n              {\n                uid: action.value[0].uid,\n                hasAudio:\n                  action.value[1] === 'audio'\n                    ? remoteTrackState.subbed\n                    : (state.max[0].hasAudio as remoteTrackState),\n                hasVideo:\n                  action.value[1] === 'video'\n                    ? remoteTrackState.subbed\n                    : (state.max[0].hasVideo as remoteTrackState)\n              }\n            ],\n            min: state.min,\n            isScreensharing: state.isScreensharing\n          }\n        } else {\n          stateUpdate = {\n            min: state.min.map((user) => {\n              if (user.uid !== action.value[0].uid) {\n                return user\n              } else {\n                return {\n                  uid: user.uid,\n                  hasAudio:\n                    action.value[1] === 'audio'\n                      ? remoteTrackState.subbed\n                      : (user.hasAudio as remoteTrackState),\n                  hasVideo:\n                    action.value[1] === 'video'\n                      ? remoteTrackState.subbed\n                      : (user.hasVideo as remoteTrackState)\n                }\n              }\n            }),\n            max: state.max,\n            isScreensharing: state.isScreensharing\n          }\n        }\n      }\n      break\n    case 'user-left':\n      if (actionTypeGuard(action, action.type)) {\n        if (state.max[0].uid === action.value[0].uid) {\n          const minUpdate = [...state.min]\n          stateUpdate = {\n            max: [minUpdate.pop() as UIKitUser],\n            min: minUpdate,\n            isScreensharing: state.isScreensharing\n          }\n        } else {\n          stateUpdate = {\n            min: state.min.filter((user) => user.uid !== action.value[0].uid),\n            max: state.max,\n            isScreensharing: state.isScreensharing\n          }\n        }\n      }\n      break\n    case 'user-swap':\n      if (actionTypeGuard(action, action.type)) {\n        if (state.max[0].uid === action.value[0].uid) {\n        } else {\n          stateUpdate = {\n            max: [action.value[0]],\n            min: [\n              ...state.min.filter(\n                (user: UIKitUser) => user.uid !== action.value[0].uid\n              ),\n              state.max[0]\n            ],\n            isScreensharing: state.isScreensharing\n          }\n        }\n      }\n      break\n    case 'local-user-mute-video':\n      if (actionTypeGuard(action, action.type)) {\n        stateUpdate = {\n          min: state.min.map((user: UIKitUser) => {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: user.hasAudio as ToggleState,\n                hasVideo: action.value[0]\n              }\n            } else {\n              return user\n            }\n          }),\n          max: state.max.map((user: UIKitUser) => {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: user.hasAudio as ToggleState,\n                hasVideo: action.value[0]\n              }\n            } else {\n              return user\n            }\n          }),\n          isScreensharing: state.isScreensharing\n        }\n      }\n      break\n    case 'local-user-mute-audio':\n      if (actionTypeGuard(action, action.type)) {\n        stateUpdate = {\n          min: state.min.map((user) => {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: action.value[0],\n                hasVideo: user.hasVideo as ToggleState\n              }\n            } else {\n              return user\n            }\n          }),\n          max: state.max.map((user) => {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: action.value[0],\n                hasVideo: user.hasVideo as ToggleState\n              }\n            } else {\n              return user\n            }\n          }),\n          isScreensharing: state.isScreensharing\n        }\n      }\n      break\n    case 'remote-user-mute-video':\n      if (actionTypeGuard(action, action.type)) {\n        // window['track'] = action.value.videoTrack\n        // window['client'] = client\n        stateUpdate = {\n          min: state.min.map((user: UIKitUser) => {\n            if (user.uid === action.value[0].uid) {\n              return {\n                uid: user.uid,\n                hasVideo: action.value[1],\n                hasAudio: user.hasAudio\n              } as RemoteUIKitUser\n            } else return user\n          }),\n          max: state.max.map((user: UIKitUser) => {\n            if (user.uid === action.value[0].uid)\n              return {\n                uid: user.uid,\n                hasVideo: action.value[1],\n                hasAudio: user.hasAudio\n              } as RemoteUIKitUser\n            else return user\n          }),\n          isScreensharing: state.isScreensharing\n        }\n      }\n      break\n    case 'remote-user-mute-audio':\n      if (actionTypeGuard(action, action.type)) {\n        stateUpdate = {\n          min: state.min.map((user: UIKitUser) => {\n            if (user.uid === action.value[0].uid)\n              return {\n                uid: user.uid,\n                hasAudio: action.value[1],\n                hasVideo: user.hasVideo\n              } as RemoteUIKitUser\n            else return user\n          }),\n          max: state.max.map((user: UIKitUser) => {\n            if (user.uid === action.value[0].uid)\n              return {\n                uid: user.uid,\n                hasAudio: action.value[1],\n                hasVideo: user.hasVideo\n              } as RemoteUIKitUser\n            else return user\n          }),\n          isScreensharing: state.isScreensharing\n        }\n      }\n      break\n    case 'leave-channel':\n      stateUpdate = initState\n      break\n    case 'ActiveSpeaker':\n      if (actionTypeGuard(action, action.type)) {\n        if (state.max[0].uid === action.value[0]) {\n          stateUpdate = { ...state }\n        } else {\n          stateUpdate = {\n            max: [\n              state.min.find(\n                (user) => user.uid === action.value[0]\n              ) as UIKitUser\n            ],\n            min: [\n              ...state.min.filter(\n                (user: UIKitUser) => user.uid !== action.value[0]\n              ),\n              state.max[0]\n            ],\n            isScreensharing: state.isScreensharing\n          }\n        }\n      }\n      break\n  }\n\n  console.log('!state-update', { ...state, ...stateUpdate }, stateUpdate)\n  return { ...state, ...stateUpdate }\n}\n\nexport default reducer\n","import AgoraRTC, { ILocalVideoTrack, UID } from 'agora-rtc-react'\n\nconst startScreenshare = async (\n  appId: string,\n  channel: string,\n  track: ILocalVideoTrack,\n  screenshareToken?: string | null,\n  screenshareUid?: number,\n  tokenUrl?: string,\n  enableDualStream?: boolean\n) => {\n  const screenClient = AgoraRTC.createClient({\n    mode: 'live',\n    role: 'host',\n    codec: 'vp8'\n  })\n  let returnedUid: UID = 0\n\n  const uid = screenshareUid || 1 // 1 is default\n\n  let localVideoTrackHasPublished = false\n\n  async function init() {\n    try {\n      console.log(screenClient)\n      if (tokenUrl) {\n        screenClient.on('token-privilege-will-expire', async () => {\n          console.log('token will expire')\n          const res = await fetch(\n            tokenUrl + '/rtc/' + channel + '/publisher/uid/' + uid + '/'\n          )\n          const data = await res.json()\n          const token = data.rtcToken\n          screenClient.renewToken(token)\n        })\n\n        screenClient.on('token-privilege-did-expire', async () => {\n          const res = await fetch(\n            tokenUrl + '/rtc/' + channel + '/publisher/uid/' + uid + '/'\n          )\n          const data = await res.json()\n          const token = data.rtcToken\n          screenClient.renewToken(token)\n        })\n      }\n\n      track.on('track-ended', () => {\n        screenClient.leave()\n        screenClient.removeAllListeners()\n      })\n    } catch (e) {\n      console.log(e)\n    }\n  }\n\n  async function join(): Promise<void> {\n    screenClient.setClientRole('host')\n\n    if (tokenUrl) {\n      try {\n        const res = await fetch(\n          tokenUrl + '/rtc/' + channel + '/publisher/uid/' + uid + '/'\n        )\n        const data = await res.json()\n        const token = data.rtcToken\n        returnedUid = await screenClient.join(appId, channel, token, uid)\n      } catch (e) {\n        console.log(e)\n      }\n    } else {\n      returnedUid = await screenClient.join(\n        appId,\n        channel,\n        screenshareToken || null,\n        uid || 0\n      )\n    }\n  }\n\n  async function publish() {\n    if (enableDualStream) {\n      await screenClient.enableDualStream()\n    }\n    if (track.enabled) {\n      if (!localVideoTrackHasPublished) {\n        await screenClient.publish([track]).then(() => {\n          localVideoTrackHasPublished = true\n        })\n      }\n    }\n  }\n\n  const stop = async () => {\n    try {\n      track.close()\n      await screenClient.leave()\n      screenClient.removeAllListeners()\n    } catch (e) {\n      console.log(e)\n    }\n  }\n\n  stopScreenshare = stop\n\n  await init()\n  await join()\n  await publish()\n  if (returnedUid) console.log(returnedUid)\n}\n\nlet stopScreenshare = () => {}\n\nexport { startScreenshare, stopScreenshare }\n","import React, {\n  useState,\n  useEffect,\n  useContext,\n  useRef,\n  useReducer,\n  PropsWithChildren\n} from 'react'\nimport { RtcProvider } from './RtcContext'\nimport PropsContext, {\n  RtcPropsInterface,\n  UIKitUser,\n  mediaStore,\n  layout,\n  CallbacksInterface\n} from './PropsContext'\nimport { MaxUidProvider } from './MaxUidContext'\nimport AgoraRTC, { createClient, ILocalVideoTrack, UID } from 'agora-rtc-react'\nimport { MinUidProvider } from './MinUidContext'\nimport TracksContext from './TracksContext'\nimport reducer, { initState } from './Reducer'\nimport {\n  startScreenshare,\n  stopScreenshare\n} from './Controls/Local/screenshareFunctions'\n\nconst useClient = createClient({ codec: 'vp8', mode: 'live' }) // pass in another client if use h264\n\n/**\n * React component that contains the RTC logic. It manages the user state and provides it the children components by wrapping them with context providers.\n */\nconst RtcConfigure: React.FC<PropsWithChildren<Partial<RtcPropsInterface>>> = (\n  props\n) => {\n  const uid = useRef<UID>()\n  const screenTrack = useRef<ILocalVideoTrack>()\n  const isScreensharingRef = useRef<boolean>(false)\n  const { localVideoTrack, localAudioTrack } = useContext(TracksContext)\n  const { callbacks, rtcProps } = useContext(PropsContext)\n  const [ready, setReady] = useState<boolean>(false)\n  const [channelJoined, setChannelJoined] = useState<boolean>(false)\n  let joinRes: ((arg0: boolean) => void) | null = null // Resolve for canJoin -> to set canJoin to true\n  const canJoin = useRef(\n    new Promise<boolean | void>((resolve, reject) => {\n      joinRes = resolve\n      console.log(reject)\n    })\n  )\n\n  let client = useClient()\n  if (rtcProps.customRtcClient) {\n    // if customRtcClient prop is set then use custom client\n    client.removeAllListeners()\n    client = rtcProps.customRtcClient\n  }\n\n  let localVideoTrackHasPublished = false\n  let localAudioTrackHasPublished = false\n\n  const mediaStore = useRef<mediaStore>({})\n\n  let { callActive } = props\n  if (callActive === undefined) {\n    callActive = true\n  }\n\n  type stateType = {\n    max: UIKitUser[]\n    min: UIKitUser[]\n  }\n  const [uidState, dispatch] = useReducer<React.Reducer<stateType, any>>(\n    reducer,\n    initState\n  )\n\n  // init rtcEngine\n  useEffect(() => {\n    async function init() {\n      try {\n        console.log(client)\n        client.on('user-joined', async (...args) => {\n          const [remoteUser] = args\n          if (\n            (remoteUser.uid === props.screenshareUid &&\n              isScreensharingRef.current) ||\n            (remoteUser.uid === 1 && isScreensharingRef.current)\n          ) {\n          } else {\n            mediaStore.current[remoteUser.uid] = {}\n          }\n          dispatch({\n            type: 'user-joined',\n            value: args\n          })\n        })\n\n        client.on('user-published', async (...args) => {\n          // Get current peer IDs\n          const [remoteUser, mediaType] = args\n          console.log('user-published', remoteUser.uid)\n          if (\n            (remoteUser.uid === props.screenshareUid &&\n              isScreensharingRef.current) ||\n            (remoteUser.uid === 1 && isScreensharingRef.current)\n          ) {\n            dispatch({\n              type: 'user-published',\n              value: args\n            })\n          } else {\n            client\n              .subscribe(remoteUser, mediaType)\n              .then((_e) => {\n                mediaStore.current[remoteUser.uid][mediaType + 'Track'] =\n                  remoteUser[mediaType + 'Track']\n                if (mediaType === 'audio') {\n                  // eslint-disable-next-line no-unused-expressions\n                  remoteUser.audioTrack?.play()\n                } else {\n                  if (rtcProps.enableDualStream && rtcProps.dualStreamMode) {\n                    client.setStreamFallbackOption(\n                      remoteUser.uid,\n                      rtcProps.dualStreamMode\n                    )\n                  }\n                }\n                dispatch({\n                  type: 'user-published',\n                  value: args\n                })\n              })\n              .catch((e) => console.log(e))\n          }\n        })\n\n        client.on('user-unpublished', async (...args) => {\n          const [remoteUser, mediaType] = args\n          console.log('user-unpublished', remoteUser.uid)\n          if (mediaType === 'audio') {\n            // eslint-disable-next-line no-unused-expressions\n            remoteUser.audioTrack?.stop()\n          }\n          dispatch({\n            type: 'user-unpublished',\n            value: args\n          })\n          // }\n        })\n\n        client.on('connection-state-change', async (...args) => {\n          const [curState, prevState, reason] = args\n          console.log('connection', prevState, curState, reason)\n          if (curState === 'CONNECTED') {\n            setChannelJoined(true)\n          } else if (curState === 'DISCONNECTED') {\n            try {\n              stopScreenshare()\n              isScreensharingRef.current = false\n            } catch (e) {\n              console.log('stopscreenshare', e)\n            }\n            dispatch({ type: 'leave-channel', value: null })\n          } else {\n            setChannelJoined(false)\n          }\n        })\n\n        client.on('user-left', (...args) => {\n          dispatch({\n            type: 'user-left',\n            value: args\n          })\n        })\n\n        if (rtcProps.tokenUrl) {\n          const { tokenUrl, channel, uid } = rtcProps\n          client.on('token-privilege-will-expire', async () => {\n            console.log('token will expire')\n            const res = await fetch(\n              tokenUrl +\n                '/rtc/' +\n                channel +\n                '/publisher/uid/' +\n                (uid || 0) +\n                '/'\n            )\n            const data = await res.json()\n            const token = data.rtcToken\n            client.renewToken(token)\n          })\n\n          client.on('token-privilege-did-expire', async () => {\n            const res = await fetch(\n              tokenUrl +\n                '/rtc/' +\n                channel +\n                '/publisher/uid/' +\n                (uid || 0) +\n                '/'\n            )\n            const data = await res.json()\n            const token = data.rtcToken\n            client.renewToken(token)\n          })\n        }\n\n        if (callbacks) {\n          const events: [keyof CallbacksInterface] = Object.keys(\n            callbacks\n          ) as any\n          // !!!! fix type, validate event\n          events.map((e) => {\n            try {\n              client.on(e, (...args: any[]) => {\n                // eslint-disable-next-line prefer-spread\n                ;(callbacks[e] as Function).apply(null, args)\n              })\n            } catch (e) {\n              console.log(e)\n            }\n          })\n        }\n        ;(joinRes as (arg0: boolean) => void)(true)\n        setReady(true)\n      } catch (e) {\n        console.log('!!!', e)\n      }\n    }\n\n    if (joinRes) {\n      init()\n      return () => {\n        try {\n          client.removeAllListeners()\n        } catch (e) {\n          console.log(e)\n        }\n      }\n    } else return () => {}\n  }, [rtcProps.appId]) //, ready])\n\n  // Dynamically switches channel when channel prop changes\n  useEffect(() => {\n    let ignore = false\n    async function join(): Promise<void> {\n      await canJoin.current\n      const { tokenUrl, channel, uid: userUid, appId, token } = rtcProps\n      if (client && !ignore) {\n        if (rtcProps.role === 'audience') {\n          client.setClientRole(rtcProps.role)\n        } else {\n          client.setClientRole('host')\n        }\n        if (tokenUrl) {\n          try {\n            const res = await fetch(\n              tokenUrl +\n                '/rtc/' +\n                channel +\n                '/publisher/uid/' +\n                (userUid || 0) +\n                '/'\n            )\n            const data = await res.json()\n            const token = data.rtcToken\n            uid.current = await client.join(appId, channel, token, userUid || 0)\n          } catch (e) {\n            console.log(e)\n          }\n        } else {\n          uid.current = await client.join(\n            appId,\n            channel,\n            token || null,\n            userUid || 0\n          )\n        }\n        // console.log('!uid: ', uid.current)\n      } else {\n        console.error('trying to join before RTC Engine was initialized')\n      }\n    }\n    if (callActive) {\n      join()\n      console.log('Attempted join: ', rtcProps.channel)\n    } else {\n      console.log('In precall - waiting to join')\n    }\n    return (): void => {\n      ignore = true\n      if (callActive) {\n        console.log('Leaving channel')\n        try {\n          stopScreenshare()\n          isScreensharingRef.current = false\n        } catch (e) {\n          console.log(e)\n        }\n        canJoin.current = client\n          .leave()\n          .catch((err: unknown) => console.log(err))\n      }\n    }\n  }, [rtcProps.channel, rtcProps.uid, callActive, rtcProps.tokenUrl])\n\n  // publish local stream\n  useEffect(() => {\n    async function publish() {\n      if (rtcProps.enableDualStream) {\n        await client.enableDualStream()\n      }\n      // handle publish fail if track is not enabled\n      if (localAudioTrack?.enabled && channelJoined) {\n        if (!localAudioTrackHasPublished) {\n          await client.publish([localAudioTrack]).then(() => {\n            localAudioTrackHasPublished = true\n          })\n        }\n      }\n      if (localVideoTrack?.enabled && channelJoined) {\n        if (!localVideoTrackHasPublished) {\n          await client.publish([localVideoTrack]).then(() => {\n            localVideoTrackHasPublished = true\n          })\n        }\n      }\n    }\n    console.log('Publish', localVideoTrack, localAudioTrack, callActive)\n    if (callActive) {\n      publish()\n    }\n  }, [\n    callActive,\n    localVideoTrack?.enabled,\n    localAudioTrack?.enabled,\n    channelJoined\n  ])\n\n  // update local state if tracks are not null\n  useEffect(() => {\n    if (localVideoTrack && localAudioTrack !== (null && undefined)) {\n      mediaStore.current[0] = {\n        audioTrack: localAudioTrack,\n        videoTrack: localVideoTrack\n      }\n      dispatch({\n        type: 'update-user-video',\n        value: [localAudioTrack, localVideoTrack]\n      })\n    }\n  }, [rtcProps.channel, channelJoined])\n\n  // renew token if token is updated\n  useEffect(() => {\n    if (channelJoined && rtcProps.token) {\n      client\n        .renewToken(rtcProps.token)\n        .then((e) => console.log('renewed token', e))\n    }\n  }, [rtcProps.token, channelJoined])\n\n  // set role if role is updated\n  useEffect(() => {\n    if (rtcProps.role) {\n      client\n        .setClientRole(rtcProps.role)\n        .then((e) => console.log('changed role', e))\n    }\n  }, [rtcProps.role, channelJoined])\n\n  // active speaker\n  useEffect(() => {\n    async function enableActiveSpeaker() {\n      if (rtcProps.activeSpeaker && rtcProps.layout !== layout.grid) {\n        client.on('volume-indicator', (volumes) => {\n          const highestvolumeObj = volumes.reduce(\n            (\n              highestVolume: {\n                level: number\n                uid: UID\n              },\n              volume\n            ) => {\n              if (highestVolume === null) {\n                return volume\n              } else {\n                if (volume.level > highestVolume.level) {\n                  return volume\n                }\n                return highestVolume\n              }\n            },\n            null\n          )\n          const activeSpeaker = highestvolumeObj\n            ? highestvolumeObj.uid\n            : undefined\n          const mapActiveSpeakerToZero =\n            activeSpeaker === uid.current ? 0 : activeSpeaker\n          if (activeSpeaker !== undefined) {\n            dispatch({\n              type: 'ActiveSpeaker',\n              value: [mapActiveSpeakerToZero]\n            })\n          }\n        })\n        await client.enableAudioVolumeIndicator()\n      }\n    }\n    if (callActive) {\n      enableActiveSpeaker()\n    }\n    return () => {\n      client.removeAllListeners('volume-indicator')\n    }\n  }, [rtcProps.activeSpeaker, rtcProps.layout])\n\n  const toggleScreensharing = async () => {\n    const start = async () => {\n      dispatch({\n        type: 'Screensharing',\n        value: [true]\n      })\n      screenTrack.current = await AgoraRTC.createScreenVideoTrack({}, 'disable')\n      const uid = rtcProps.screenshareUid || 1 // 1 is default\n      mediaStore.current[uid] = { videoTrack: screenTrack.current }\n      screenTrack.current.on('track-ended', () => {\n        isScreensharingRef.current = false\n        dispatch({\n          type: 'Screensharing',\n          value: [false]\n        })\n      })\n      isScreensharingRef.current = true\n      await startScreenshare(\n        rtcProps.appId,\n        rtcProps.channel,\n        screenTrack.current,\n        rtcProps.screenshareToken,\n        rtcProps.screenshareUid,\n        rtcProps.tokenUrl,\n        rtcProps.enableDualStream\n      )\n    }\n\n    const stop = () => {\n      stopScreenshare()\n      isScreensharingRef.current = false\n    }\n\n    if (isScreensharingRef.current) {\n      stop()\n    } else {\n      start()\n    }\n  }\n\n  return (\n    <RtcProvider\n      value={{\n        client,\n        mediaStore: mediaStore.current,\n        localVideoTrack,\n        localAudioTrack,\n        dispatch,\n        localUid: uid,\n        channelJoined,\n        toggleScreensharing: toggleScreensharing,\n        isScreensharing: isScreensharingRef.current\n      }}\n    >\n      <MaxUidProvider value={uidState.max}>\n        <MinUidProvider value={uidState.min}>\n          {/* <MinUidProvider value={uidState.min}> */}\n          {ready ? props.children : null}\n        </MinUidProvider>\n      </MaxUidProvider>\n    </RtcProvider>\n  )\n}\n\nexport default RtcConfigure\n","import React from 'react'\n\nconst icons = {\n  videocam: (\n    <React.Fragment>\n      <polygon points='23 7 16 12 23 17 23 7' />\n      <rect x='1' y='5' width='15' height='14' rx='2' ry='2' />\n    </React.Fragment>\n  ),\n  videocamOff: (\n    <React.Fragment>\n      <path d='M16 16v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h2m5.66 0H14a2 2 0 0 1 2 2v3.34l1 1L23 7v10' />\n      <line x1='1' y1='1' x2='23' y2='23' />\n    </React.Fragment>\n  ),\n  remoteSwap: (\n    <React.Fragment>\n      <polyline points='15 3 21 3 21 9' />\n      <polyline points='9 21 3 21 3 15' />\n      <line x1='21' y1='3' x2='14' y2='10' />\n      <line x1='3' y1='21' x2='10' y2='14' />\n    </React.Fragment>\n  ),\n  callEnd: (\n    <React.Fragment>\n      <path d='M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91' />\n      <line x1='23' y1='1' x2='1' y2='23' />\n    </React.Fragment>\n  ),\n  mic: (\n    <React.Fragment>\n      <path d='M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z' />\n      <path d='M19 10v2a7 7 0 0 1-14 0v-2' />\n      <line x1='12' y1='19' x2='12' y2='23' />\n      <line x1='8' y1='23' x2='16' y2='23' />\n    </React.Fragment>\n  ),\n  micOff: (\n    <React.Fragment>\n      <line x1='1' y1='1' x2='23' y2='23' />\n      <path d='M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6' />\n      <path d='M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23' />\n      <line x1='12' y1='19' x2='12' y2='23' />\n      <line x1='8' y1='23' x2='16' y2='23' />\n    </React.Fragment>\n  ),\n  screen: (\n    <React.Fragment>\n      <rect x='2' y='3' width='20' height='14' rx='2' ry='2' />\n      <line x1='8' y1='21' x2='16' y2='21' />\n      <line x1='12' y1='17' x2='12' y2='21' />\n    </React.Fragment>\n  ),\n  stop: (\n    <React.Fragment>\n      <line x1='18' y1='6' x2='6' y2='18' />\n      <line x1='6' y1='6' x2='18' y2='18' />\n    </React.Fragment>\n  )\n}\n\nexport default icons\n","import React, { useContext } from 'react'\nimport PropsContext from '../PropsContext'\nimport Icons from './Icons'\ninterface BtnTemplateInterface {\n  name: string\n  color?: string\n  onClick: () => void\n  disabled?: boolean\n  style?: React.CSSProperties\n}\n\nconst BtnTemplate = (props: BtnTemplateInterface) => {\n  const { onClick, name, disabled, style } = props\n  const { styleProps } = useContext(PropsContext)\n  const { theme, BtnTemplateStyles, iconSize, customIcon } = styleProps || {}\n\n  return (\n    <div\n      style={{\n        ...{\n          width: 35,\n          height: 35,\n          borderRadius: '100%',\n          borderWidth: 2,\n          borderStyle: 'solid',\n          borderColor: '#fff',\n          backgroundColor: 'rgba(0,80,180,0.2)',\n          alignItems: 'center',\n          justifyContent: 'center',\n          display: 'flex',\n          cursor: disabled ? 'auto' : 'pointer',\n          margin: 4\n        },\n        ...BtnTemplateStyles,\n        ...style\n      }}\n      onClick={onClick}\n    >\n      {customIcon ? (\n        <img src={customIcon[name]} alt={name} />\n      ) : (\n        <svg\n          style={{\n            width: iconSize || 24,\n            height: iconSize || 24\n          }}\n          xmlns='http://www.w3.org/2000/svg'\n          width='24'\n          height='24'\n          viewBox='0 0 24 24'\n          fill='none'\n          opacity={disabled ? '0.5' : '1'}\n          stroke={theme || '#fff'}\n          strokeWidth='2'\n          strokeLinecap='round'\n          strokeLinejoin='round'\n          // className='feather feather-video'\n        >\n          {Icons[name]}\n        </svg>\n      )}\n    </div>\n  )\n}\n\nexport default BtnTemplate\n","import React, { useContext } from 'react'\nimport PropsContext from '../../PropsContext'\n// import RtcContext from '../../RtcContext'\nimport BtnTemplate from '../BtnTemplate'\n\nfunction EndCall() {\n  const { styleProps, callbacks } = useContext(PropsContext)\n  const { localBtnStyles } = styleProps || {}\n  const { endCall } = localBtnStyles || {}\n  // const { dispatch } = useContext(RtcContext)\n\n  return (\n    <BtnTemplate\n      style={endCall || { backgroundColor: '#ef5588', borderColor: '#f00' }}\n      name='callEnd'\n      onClick={() => callbacks?.EndCall && callbacks.EndCall()}\n    />\n  )\n}\n\nexport default EndCall\n","import React, { useContext, createContext, PropsWithChildren } from 'react'\nimport MaxUidContext from './MaxUidContext'\nimport MinUidContext from './MinUidContext'\nimport { LocalUIKitUser } from './PropsContext'\n\nexport const LocalContext = createContext<LocalUIKitUser>({} as LocalUIKitUser)\nexport const LocalProvider = LocalContext.Provider\nexport const LocalConsumer = LocalContext.Consumer\n\ninterface LocalUserContextInterface {\n  children: React.ReactNode\n}\n/**\n * React context that exposes the {@link LocalUIKitUser} data object\n */\nconst LocalUserContext: React.FC<\n  PropsWithChildren<LocalUserContextInterface>\n> = (props) => {\n  const max = useContext(MaxUidContext)\n  const min = useContext(MinUidContext)\n\n  let localUser: LocalUIKitUser\n  if (max[0].uid === 0) {\n    localUser = max[0] as LocalUIKitUser\n  } else {\n    localUser = min.find((u) => u.uid === 0) as LocalUIKitUser\n  }\n  return (\n    <LocalContext.Provider value={localUser}>\n      {props.children}\n    </LocalContext.Provider>\n  )\n}\n\nexport default LocalUserContext\n","import { DispatchType } from '../../RtcContext'\nimport { LocalUIKitUser, ToggleState } from '../../PropsContext'\nimport { ILocalAudioTrack } from 'agora-rtc-react'\nimport { CallbacksInterface } from '../..'\n\nexport default async (\n  user: LocalUIKitUser,\n  dispatch: DispatchType,\n  localAudioTrack: ILocalAudioTrack,\n  callbacks?: Partial<CallbacksInterface>\n) => {\n  // console.log('!mute audio', user)\n  if (user.uid === 0) {\n    const localState = user.hasAudio\n    if (\n      localState === ToggleState.enabled ||\n      localState === ToggleState.disabled\n    ) {\n      // Disable UI\n      let newState =\n        localState === ToggleState.enabled\n          ? ToggleState.disabling\n          : ToggleState.enabling\n      dispatch({\n        type: 'local-user-mute-audio',\n        value: [newState]\n      })\n      callbacks &&\n        callbacks['local-user-mute-audio'] &&\n        callbacks['local-user-mute-audio'](newState)\n      try {\n        await localAudioTrack?.setEnabled(localState !== ToggleState.enabled)\n        // Enable UI\n        newState =\n          localState === ToggleState.enabled\n            ? ToggleState.disabled\n            : ToggleState.enabled\n        callbacks &&\n          callbacks['local-user-mute-audio'] &&\n          callbacks['local-user-mute-audio'](newState)\n        dispatch({\n          type: 'local-user-mute-audio',\n          value: [\n            localState === ToggleState.enabled\n              ? ToggleState.disabled\n              : ToggleState.enabled\n          ]\n        })\n      } catch (e) {\n        dispatch({\n          type: 'local-user-mute-audio',\n          value: [localState]\n        })\n      }\n    }\n  }\n}\n","import React, { useContext } from 'react'\nimport RtcContext from '../../RtcContext'\nimport BtnTemplate from '../BtnTemplate'\nimport { LocalContext } from '../../LocalUserContext'\nimport PropsContext, { ToggleState } from '../../PropsContext'\nimport muteAudio from './muteAudio'\n\nfunction LocalAudioMute() {\n  const { styleProps, callbacks } = useContext(PropsContext)\n  const { localBtnStyles } = styleProps || {}\n  const { muteLocalAudio } = localBtnStyles || {}\n  const { dispatch, localAudioTrack } = useContext(RtcContext)\n  const local = useContext(LocalContext)\n\n  return (\n    <div>\n      <BtnTemplate\n        style={muteLocalAudio}\n        name={local.hasAudio === ToggleState.enabled ? 'mic' : 'micOff'}\n        onClick={() =>\n          localAudioTrack &&\n          muteAudio(local, dispatch, localAudioTrack, callbacks)\n        }\n      />\n    </div>\n  )\n}\n\nexport default LocalAudioMute\n","import React, { useContext } from 'react'\nimport RtcContext from '../../RtcContext'\nimport BtnTemplate from '../BtnTemplate'\nimport PropsContext from '../../PropsContext'\n\nfunction Screenshare() {\n  const { styleProps } = useContext(PropsContext)\n  const { localBtnStyles } = styleProps || {}\n  const { screenshare } = localBtnStyles || {}\n  const { toggleScreensharing, isScreensharing } = useContext(RtcContext)\n\n  return (\n    <div>\n      <BtnTemplate\n        style={screenshare}\n        name={isScreensharing ? 'stop' : 'screen'}\n        onClick={() => toggleScreensharing()}\n      />\n    </div>\n  )\n}\n\nexport default Screenshare\n","import { DispatchType } from '../../RtcContext'\nimport {\n  CallbacksInterface,\n  LocalUIKitUser,\n  ToggleState\n} from '../../PropsContext'\nimport { ILocalVideoTrack } from 'agora-rtc-react'\n\nexport default async (\n  user: LocalUIKitUser,\n  dispatch: DispatchType,\n  localVideoTrack: ILocalVideoTrack,\n  callbacks?: Partial<CallbacksInterface>\n) => {\n  if (user.uid === 0) {\n    const localState = user.hasVideo\n    if (\n      localState === ToggleState.enabled ||\n      localState === ToggleState.disabled\n    ) {\n      // Disable UI\n      let newState =\n        localState === ToggleState.enabled\n          ? ToggleState.disabling\n          : ToggleState.enabling\n      dispatch({\n        type: 'local-user-mute-video',\n        value: [newState]\n      })\n      callbacks &&\n        callbacks['local-user-mute-video'] &&\n        callbacks['local-user-mute-video'](newState)\n      try {\n        await localVideoTrack?.setEnabled(localState !== ToggleState.enabled)\n        // Enable UI\n        newState =\n          localState === ToggleState.enabled\n            ? ToggleState.disabled\n            : ToggleState.enabled\n        callbacks &&\n          callbacks['local-user-mute-video'] &&\n          callbacks['local-user-mute-video'](newState)\n        dispatch({\n          type: 'local-user-mute-video',\n          value: [newState]\n        })\n      } catch (e) {\n        dispatch({\n          type: 'local-user-mute-video',\n          value: [localState]\n        })\n      }\n    }\n  }\n}\n","import React, { useContext } from 'react'\nimport RtcContext from '../../RtcContext'\nimport BtnTemplate from '../BtnTemplate'\nimport { LocalContext } from '../../LocalUserContext'\nimport PropsContext, { ToggleState } from '../../PropsContext'\nimport muteVideo from './muteVideo'\n\nfunction LocalVideoMute() {\n  const { styleProps, callbacks } = useContext(PropsContext)\n  const { localBtnStyles } = styleProps || {}\n  const { muteLocalVideo } = localBtnStyles || {}\n  const { dispatch, localVideoTrack } = useContext(RtcContext)\n  const local = useContext(LocalContext)\n\n  return (\n    <div>\n      <BtnTemplate\n        style={muteLocalVideo}\n        name={\n          local.hasVideo === ToggleState.enabled ? 'videocam' : 'videocamOff'\n        }\n        onClick={() =>\n          localVideoTrack &&\n          muteVideo(local, dispatch, localVideoTrack, callbacks)\n        }\n      />\n    </div>\n  )\n}\n\nexport default LocalVideoMute\n","import React, { useContext } from 'react'\nimport EndCall from './Local/EndCall'\nimport LocalAudioMute from './Local/LocalAudioMute'\nimport Screenshare from './Local/Screenshare'\nimport LocalVideoMute from './Local/LocalVideoMute'\nimport PropsContext from '../PropsContext'\n\nfunction LocalControls() {\n  const { styleProps, rtcProps } = useContext(PropsContext)\n  const { localBtnContainer } = styleProps || {}\n\n  return (\n    <div\n      style={{\n        ...{\n          backgroundColor: '#007bff',\n          width: '100%',\n          height: 70,\n          zIndex: 10,\n          display: 'flex',\n          flexDirection: 'row',\n          justifyContent: 'space-evenly',\n          alignItems: 'center'\n        },\n        ...localBtnContainer\n      }}\n    >\n      {rtcProps.role !== 'audience' && <LocalVideoMute />}\n      {rtcProps.role !== 'audience' && <LocalAudioMute />}\n      {rtcProps.role !== 'audience' && rtcProps.enableScreensharing && (\n        <Screenshare />\n      )}\n      <EndCall />\n    </div>\n  )\n}\n\nexport default LocalControls\n","import { UID } from 'agora-rtc-react'\nimport { RtmClient, RtmEvents } from 'agora-rtm-react'\nimport { createContext } from 'react'\n\n/**\n * Callbacks to pass to RTM events\n */\nexport type rtmCallbacks = {\n  channel?: Partial<RtmEvents.RtmChannelEvents>\n  client?: Partial<RtmEvents.RtmClientEvents>\n}\n\nexport enum rtmStatusEnum {\n  // Initialisation failed\n  initFailed,\n  // Login has not been attempted\n  offline,\n  // RTM is initialising, process is not yet complete\n  initialising,\n  // Currently attempting to log in\n  loggingIn,\n  // RTM has logged in\n  loggedIn,\n  // RTM is logged in, and connected to the current channel\n  connected,\n  // RTM Login Failed\n  loginFailed\n}\n\nexport type messageType = 'UserData' | 'MuteRequest'\n\nexport type messageObject = userData | muteRequest | genericAction\n\nexport enum clientRoleRaw {\n  broadcaster,\n  audience\n}\n\nexport enum mutingDevice {\n  camera,\n  microphone\n}\n\nexport type genericAction = {\n  messageType: 'RtmDataRequest'\n  type: 'ping' | 'pong' | 'userData'\n}\n\nexport type muteRequest = {\n  messageType: 'MuteRequest'\n  rtcId: UID\n  mute: boolean\n  device: mutingDevice\n  isForceful: boolean\n}\n\nexport type userData = {\n  messageType: 'UserData'\n  rtmId: string\n  rtcId: UID\n  username?: string\n  role: clientRoleRaw\n  uikit: {\n    platform: string\n    framework: string\n    version: string\n  }\n  agora: {\n    rtm: string\n    rtc: string\n  }\n}\n\nexport enum popUpStateEnum {\n  closed,\n  muteMic,\n  muteCamera,\n  unmuteMic,\n  unmuteCamera\n}\n/**\n * Interface for RTM Context\n */\ninterface rtmContext {\n  /**\n   * rtm connection status\n   */\n  rtmStatus: rtmStatusEnum\n  /**\n   * send message to everyone in the channel\n   */\n  sendChannelMessage: (msg: messageObject) => void\n  /**\n   * send message to a specific user\n   */\n  sendPeerMessage: (msg: messageObject, uid: string) => void\n  /**\n   * RTM Client instance\n   */\n  rtmClient: RtmClient\n  /**\n   * map with userdata for each rtc uid in the channel\n   */\n  userDataMap: Object\n  /**\n   * map with rtm uid for each rtc uid in the channel\n   */\n  uidMap: Object\n  /**\n   * Send a mute request\n   */\n  sendMuteRequest: (device: mutingDevice, rtcId: UID, mute: boolean) => void\n  /**\n   * RTM usernames\n   */\n  usernames: {}\n  /**\n   * state to display pop up on remote mute request\n   */\n  popUpState: popUpStateEnum\n  /**\n   * set state to hide pop up\n   */\n  setPopUpState: React.Dispatch<React.SetStateAction<popUpStateEnum>>\n}\n/**\n * Context to access RTM data. It's setup by {@link RtmConfigure}.\n */\nconst RtmContext = createContext(null as unknown as rtmContext)\n\nexport const RtmProvider = RtmContext.Provider\nexport const RtmConsumer = RtmContext.Consumer\nexport default RtmContext\n","import React, { useContext } from 'react'\nimport BtnTemplate from '../BtnTemplate'\nimport PropsContext, { remoteTrackState, UIKitUser } from '../../PropsContext'\nimport RtmContext, { mutingDevice } from '../../RtmContext'\n\nfunction RemoteVideoMute(props: { UIKitUser: UIKitUser }) {\n  const { styleProps } = useContext(PropsContext)\n  const { sendMuteRequest, uidMap } = useContext(RtmContext)\n  const { remoteBtnStyles } = styleProps || {}\n  const { muteRemoteVideo } = remoteBtnStyles || {}\n  const { UIKitUser } = props\n  const isMuted = UIKitUser.hasVideo === remoteTrackState.no\n\n  return UIKitUser.uid !== 0 && uidMap[UIKitUser.uid] ? (\n    <div>\n      <BtnTemplate\n        name={\n          UIKitUser.hasVideo === remoteTrackState.subbed\n            ? 'videocam'\n            : 'videocamOff'\n        }\n        style={muteRemoteVideo}\n        onClick={() =>\n          sendMuteRequest(mutingDevice.camera, UIKitUser.uid, !isMuted)\n        }\n      />\n    </div>\n  ) : null\n}\n\nexport default RemoteVideoMute\n","import React, { useContext } from 'react'\nimport BtnTemplate from '../BtnTemplate'\nimport PropsContext, { remoteTrackState, UIKitUser } from '../../PropsContext'\nimport RtmContext, { mutingDevice } from '../../RtmContext'\n\nfunction RemoteAudioMute(props: { UIKitUser: UIKitUser }) {\n  const { styleProps } = useContext(PropsContext)\n  const { remoteBtnStyles } = styleProps || {}\n  const { sendMuteRequest, uidMap } = useContext(RtmContext)\n  const { muteRemoteAudio } = remoteBtnStyles || {}\n  const { UIKitUser } = props\n  const isMuted = UIKitUser.hasAudio === remoteTrackState.no\n\n  return UIKitUser.uid !== 0 && uidMap[UIKitUser.uid] ? (\n    <div>\n      <BtnTemplate\n        style={muteRemoteAudio}\n        name={UIKitUser.hasAudio === remoteTrackState.subbed ? 'mic' : 'micOff'}\n        onClick={() =>\n          sendMuteRequest(mutingDevice.microphone, UIKitUser.uid, !isMuted)\n        }\n      />\n    </div>\n  ) : null\n}\n\nexport default RemoteAudioMute\n","import React, { useContext } from 'react'\nimport RtcContext from './../RtcContext'\nimport BtnTemplate from './BtnTemplate'\nimport { UIKitUser } from './../PropsContext'\n\nfunction SwapUser(props: { UIKitUser: UIKitUser }) {\n  const { dispatch } = useContext(RtcContext)\n  const { UIKitUser } = props\n\n  return (\n    <div>\n      <BtnTemplate\n        name='remoteSwap'\n        onClick={() => dispatch({ type: 'user-swap', value: [UIKitUser] })}\n      />\n    </div>\n  )\n}\n\nexport default SwapUser\n","import React, { useContext } from 'react'\nimport RemoteVideoMute from './Controls/Remote/RemoteVideoMute'\nimport RemoteAudioMute from './Controls/Remote/RemoteAudioMute'\nimport PropsContext, { VideoPlaceholderProps } from './PropsContext'\nimport SwapUser from './Controls/SwapUser'\n/**\n * React component that is renderd when the video track is muted.\n */\nconst VideoPlaceholder = (props: VideoPlaceholderProps) => {\n  const { styleProps, rtcProps } = useContext(PropsContext)\n  const { maxViewStyles, maxViewOverlayContainer } = styleProps || {}\n  const { user } = props\n  const { CustomVideoPlaceholder } = rtcProps\n\n  return !CustomVideoPlaceholder ? (\n    <div\n      key={user.uid}\n      style={{\n        ...style.max,\n        ...maxViewStyles\n      }}\n    >\n      <div style={style.imgContainer}>\n        <img\n          style={style.img}\n          src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJmZWF0aGVyIGZlYXRoZXItdXNlciI+PHBhdGggZD0iTTIwIDIxdi0yYTQgNCAwIDAgMC00LTRIOGE0IDQgMCAwIDAtNCA0djIiPjwvcGF0aD48Y2lyY2xlIGN4PSIxMiIgY3k9IjciIHI9IjQiPjwvY2lyY2xlPjwvc3ZnPg=='\n        />\n      </div>\n      {props.isShown && (\n        <div\n          style={{\n            ...style.btnContainer,\n            ...maxViewOverlayContainer\n          }}\n        >\n          {props.showButtons && (\n            <React.Fragment>\n              {!rtcProps.disableRtm && <RemoteVideoMute UIKitUser={user} />}\n              {!rtcProps.disableRtm && <RemoteAudioMute UIKitUser={user} />}\n              {props.showSwap && <SwapUser UIKitUser={user} />}\n            </React.Fragment>\n          )}\n        </div>\n      )}\n    </div>\n  ) : (\n    CustomVideoPlaceholder && CustomVideoPlaceholder({ ...props }, null)\n  )\n}\n\nconst style = {\n  max: {\n    flex: 1,\n    display: 'flex',\n    backgroundColor: '#007bff33',\n    flexDirection: 'row',\n    position: 'relative'\n  } as React.CSSProperties,\n  imgContainer: {\n    flex: 10,\n    display: 'flex',\n    justifyContent: 'center'\n  },\n  img: {\n    width: 100,\n    height: 100,\n    position: 'absolute',\n    alignSelf: 'center',\n    justifySelf: 'center',\n    margin: 'auto',\n    display: 'flex'\n  } as React.CSSProperties,\n  btnContainer: {\n    position: 'absolute',\n    margin: 5,\n    flexDirection: 'column',\n    display: 'flex'\n  } as React.CSSProperties\n}\n\nexport default VideoPlaceholder\n","import React, { CSSProperties, useContext } from 'react'\nimport RtmContext from './RtmContext'\nimport PropsContext, { UIKitUser } from './PropsContext'\n\nconst Username = (props: { user: UIKitUser; style?: React.CSSProperties }) => {\n  const { usernames } = useContext(RtmContext)\n  const { rtmProps, styleProps } = useContext(PropsContext)\n  const { user } = props\n\n  return rtmProps?.displayUsername ? (\n    <p style={{ ...styles.username, ...styleProps?.usernameText }}>\n      {user.uid === 1 ? 'Screenshare' : usernames[user.uid]}\n    </p>\n  ) : (\n    <React.Fragment />\n  )\n}\n\nconst styles = {\n  username: {\n    position: 'absolute',\n    background: '#007bffaa',\n    padding: '2px 8px',\n    color: '#fff',\n    margin: 0,\n    bottom: 0,\n    right: 0,\n    zIndex: 90\n  } as CSSProperties\n}\n\nexport default Username\n","import React, { CSSProperties, useContext, useState } from 'react'\nimport RtcContext from './RtcContext'\nimport { AgoraVideoPlayer, IRemoteVideoTrack } from 'agora-rtc-react'\nimport RemoteVideoMute from './Controls/Remote/RemoteVideoMute'\nimport RemoteAudioMute from './Controls/Remote/RemoteAudioMute'\nimport PropsContext, { UIKitUser } from './PropsContext'\nimport VideoPlaceholder from './VideoPlaceholder'\nimport Username from './Username'\n/**\n * React component to display the user video in maximized view\n */\nconst MaxVideoView = (props: {\n  user: UIKitUser\n  style?: React.CSSProperties\n}) => {\n  const { mediaStore } = useContext(RtcContext)\n  const { styleProps, rtcProps } = useContext(PropsContext)\n  const { maxViewStyles, videoMode, maxViewOverlayContainer } = styleProps || {}\n  const renderModeProp = videoMode?.max\n  const [isShown, setIsShown] = useState(false)\n  const { user } = props\n\n  return (\n    <div\n      style={{\n        ...styles.container,\n        ...props.style,\n        ...maxViewStyles\n      }}\n      onMouseEnter={() => setIsShown(true)}\n      onMouseLeave={() => setIsShown(false)}\n    >\n      {user.hasVideo === 1 ? (\n        // hasVideo is 1 if the local user has video enabled, or if remote user video is subbed\n        <div style={styles.videoContainer}>\n          {!rtcProps.disableRtm && <Username user={user} />}\n          <AgoraVideoPlayer\n            style={styles.videoplayer}\n            config={{\n              fit: renderModeProp || 'cover'\n            }}\n            videoTrack={mediaStore[user.uid].videoTrack as IRemoteVideoTrack}\n          />\n          {isShown && (\n            <div\n              style={{\n                ...styles.overlay,\n                ...maxViewOverlayContainer\n              }}\n            >\n              {!rtcProps.disableRtm && <RemoteVideoMute UIKitUser={user} />}\n              {!rtcProps.disableRtm && <RemoteAudioMute UIKitUser={user} />}\n            </div>\n          )}\n        </div>\n      ) : (\n        <div style={styles.videoContainer}>\n          {!rtcProps.disableRtm && <Username user={user} />}\n          <VideoPlaceholder user={user} isShown={isShown} showButtons />\n        </div>\n      )}\n    </div>\n  )\n}\n\nconst styles = {\n  container: { display: 'flex', flex: 1 },\n  videoContainer: {\n    display: 'flex',\n    flex: 1,\n    position: 'relative'\n  } as CSSProperties,\n  videoplayer: {\n    width: '100%',\n    display: 'flex',\n    flex: 1\n  },\n  overlay: {\n    position: 'absolute',\n    margin: 5,\n    flexDirection: 'column',\n    display: 'flex'\n  } as CSSProperties,\n  username: {\n    position: 'absolute',\n    background: '#007bffaa',\n    padding: '2px 8px',\n    color: '#fff',\n    margin: 0,\n    bottom: 0,\n    right: 0,\n    zIndex: 90\n  } as CSSProperties\n}\n\nexport default MaxVideoView\n","import React, { useContext, useState } from 'react'\nimport RtcContext from './RtcContext'\nimport { AgoraVideoPlayer, IRemoteVideoTrack } from 'agora-rtc-react'\nimport RemoteVideoMute from './Controls/Remote/RemoteVideoMute'\nimport RemoteAudioMute from './Controls/Remote/RemoteAudioMute'\nimport SwapUser from './Controls/SwapUser'\nimport PropsContext, { UIKitUser } from './PropsContext'\nimport VideoPlaceholder from './VideoPlaceholder'\n\n/**\n * React context to expose user array displayed in the smaller view\n */\nconst MinVideoView = (props: { user: UIKitUser }) => {\n  const { mediaStore } = useContext(RtcContext)\n  const { styleProps, rtcProps } = useContext(PropsContext)\n  const { minViewStyles, videoMode, minViewOverlayContainer } = styleProps || {}\n  const renderModeProp = videoMode?.min\n  const [isShown, setIsShown] = useState(false)\n  const { user } = props\n\n  return (\n    <div\n      style={{\n        ...{ display: 'flex', flex: 1 },\n        ...minViewStyles\n      }}\n      onMouseEnter={() => setIsShown(true)}\n      onMouseLeave={() => setIsShown(false)}\n    >\n      {user.hasVideo === 1 ? (\n        <div\n          style={{\n            ...{\n              display: 'flex',\n              flex: 1,\n              position: 'relative'\n            }\n          }}\n        >\n          <AgoraVideoPlayer\n            style={{ flex: 10, display: 'flex' }}\n            config={{\n              fit: renderModeProp !== undefined ? renderModeProp : 'cover'\n            }}\n            videoTrack={mediaStore[user.uid].videoTrack as IRemoteVideoTrack}\n          />\n          {isShown && (\n            <div\n              style={{\n                ...{\n                  margin: 4,\n                  position: 'absolute',\n                  flex: 1,\n                  display: 'flex',\n                  flexDirection: 'column'\n                },\n                ...minViewOverlayContainer\n              }}\n            >\n              {!rtcProps.disableRtm && <RemoteVideoMute UIKitUser={user} />}\n              {!rtcProps.disableRtm && <RemoteAudioMute UIKitUser={user} />}\n              <SwapUser UIKitUser={user} />\n            </div>\n          )}\n        </div>\n      ) : (\n        <VideoPlaceholder user={user} isShown={isShown} showButtons showSwap />\n      )}\n    </div>\n  )\n}\n\nexport default MinVideoView\n","import React, { useContext, useEffect, useRef, useState } from 'react'\nimport { MinUidConsumer } from './MinUidContext'\nimport { MaxUidConsumer } from './MaxUidContext'\nimport MaxVideoView from './MaxVideoView'\nimport MinVideoView from './MinVideoView'\nimport PropsContext from './PropsContext'\nimport styles from './styles.module.css'\n\n/**\n * React Component to render the user videos in the pinned/spotlight layout\n */\nconst PinnedVideo: React.FC = () => {\n  const { styleProps, rtcProps } = useContext(PropsContext)\n  const {\n    minViewContainer,\n    pinnedVideoContainer,\n    maxViewContainer,\n    scrollViewContainer\n  } = styleProps || {}\n  const parentRef = useRef<HTMLDivElement>(null)\n  const [width, setWidth] = useState(0)\n  const [height, setHeight] = useState(0)\n  const isLandscape = width > height\n\n  useEffect(() => {\n    const handleResize = () => {\n      if (parentRef.current) {\n        setWidth(parentRef.current.offsetWidth)\n        setHeight(parentRef.current.offsetHeight)\n      }\n    }\n    window.addEventListener('resize', handleResize)\n    if (parentRef.current) {\n      setWidth(parentRef.current.offsetWidth)\n      setHeight(parentRef.current.offsetHeight)\n    }\n    return () => {\n      window.removeEventListener('resize', handleResize)\n    }\n  }, [])\n\n  return (\n    <div\n      ref={parentRef}\n      style={{\n        ...{\n          display: 'flex',\n          flex: 1,\n          flexDirection: isLandscape ? 'row' : 'column-reverse',\n          overflow: 'hidden'\n        },\n        ...pinnedVideoContainer\n      }}\n    >\n      <div\n        style={{\n          ...{\n            display: 'flex',\n            flex: isLandscape ? 5 : 4\n          },\n          ...maxViewContainer\n        }}\n      >\n        <MaxUidConsumer>\n          {(maxUsers) =>\n            rtcProps.role === 'audience' && maxUsers[0].uid === 0 ? null : (\n              <MaxVideoView user={maxUsers[0]} />\n            )\n          }\n        </MaxUidConsumer>\n      </div>\n      <div\n        className={styles.scrollbar}\n        style={{\n          ...{\n            overflowY: isLandscape ? 'scroll' : 'hidden',\n            overflowX: !isLandscape ? 'scroll' : 'hidden',\n            display: 'flex',\n            flex: 1,\n            flexDirection: isLandscape ? 'column' : 'row'\n          },\n          ...scrollViewContainer\n        }}\n      >\n        <MinUidConsumer>\n          {(minUsers) =>\n            minUsers.map((user) =>\n              rtcProps.role === 'audience' && user.uid === 0 ? null : (\n                <div\n                  style={{\n                    ...{\n                      minHeight: isLandscape ? '35vh' : '99%',\n                      minWidth: isLandscape ? '99%' : '40vw',\n                      margin: 2,\n                      display: 'flex'\n                    },\n                    ...minViewContainer\n                  }}\n                  key={user.uid}\n                >\n                  <MinVideoView user={user} />\n                </div>\n              )\n            )\n          }\n        </MinUidConsumer>\n      </div>\n    </div>\n  )\n}\n\nexport default PinnedVideo\n","import React, { useContext, useEffect, useRef, useState } from 'react'\nimport MinUidContext from './MinUidContext'\nimport MaxUidContext from './MaxUidContext'\nimport PropsContext from './PropsContext'\nimport MaxVideoView from './MaxVideoView'\n\n/**\n * React Component to render the user videos in a grid\n */\nconst GridVideo: React.FC = () => {\n  const { styleProps, rtcProps } = useContext(PropsContext)\n  const { gridVideoCells, gridVideoContainer } = styleProps || {}\n  const max = useContext(MaxUidContext)\n  const min = useContext(MinUidContext)\n  const users =\n    rtcProps.role === 'audience'\n      ? [...max, ...min].filter((user) => user.uid !== 0)\n      : [...max, ...min]\n  const parentRef = useRef<HTMLDivElement>(null)\n  const [width, setWidth] = useState(window.innerWidth)\n  const [height, setHeight] = useState(window.innerHeight)\n  const isLandscape = width > height\n  const unit = 'minmax(0, 1fr) '\n\n  useEffect(() => {\n    const handleResize = () => {\n      if (parentRef.current) {\n        setWidth(parentRef.current.offsetWidth)\n        setHeight(parentRef.current.offsetHeight)\n      }\n    }\n    window.addEventListener('resize', handleResize)\n    if (parentRef.current) {\n      setWidth(parentRef.current.offsetWidth)\n      setHeight(parentRef.current.offsetHeight)\n    }\n    return () => {\n      window.removeEventListener('resize', handleResize)\n    }\n  }, [])\n\n  return (\n    <div\n      ref={parentRef}\n      style={{\n        ...{\n          width: '100%',\n          height: '100%',\n          display: 'grid',\n          gridTemplateColumns: isLandscape\n            ? users.length > 9\n              ? unit.repeat(4)\n              : users.length > 4\n              ? unit.repeat(3)\n              : users.length > 1\n              ? unit.repeat(2)\n              : unit\n            : users.length > 8\n            ? unit.repeat(3)\n            : users.length > 2\n            ? unit.repeat(2)\n            : unit\n        },\n        ...gridVideoContainer\n      }}\n    >\n      {users.map((user) => (\n        <MaxVideoView\n          user={user}\n          style={{ ...{ height: '100%', width: '100%' }, ...gridVideoCells }}\n          key={user.uid}\n        />\n      ))}\n    </div>\n  )\n}\n\nexport default GridVideo\n","import React, { useState, useEffect, useRef, PropsWithChildren } from 'react'\nimport { RtcPropsInterface, mediaStore } from './PropsContext'\nimport {\n  ILocalVideoTrack,\n  ILocalAudioTrack,\n  createMicrophoneAndCameraTracks\n} from 'agora-rtc-react'\nimport { TracksProvider } from './TracksContext'\n\nconst useTracks = createMicrophoneAndCameraTracks(\n  { encoderConfig: {} },\n  { encoderConfig: {} }\n)\n/**\n * React component that create local camera and microphone tracks and assigns them to the child components\n */\nconst TracksConfigure: React.FC<PropsWithChildren<Partial<RtcPropsInterface>>> = (props) => {\n  const [ready, setReady] = useState<boolean>(false)\n  const [localVideoTrack, setLocalVideoTrack] =\n    useState<ILocalVideoTrack | null>(null)\n  const [localAudioTrack, setLocalAudioTrack] =\n    useState<ILocalAudioTrack | null>(null)\n  const { ready: trackReady, tracks, error } = useTracks()\n  const mediaStore = useRef<mediaStore>({})\n\n  useEffect(() => {\n    if (tracks !== null) {\n      setLocalAudioTrack(tracks[0])\n      setLocalVideoTrack(tracks[1])\n      mediaStore.current[0] = {\n        audioTrack: tracks[0],\n        videoTrack: tracks[1]\n      }\n      setReady(true)\n    } else if (error) {\n      console.error(error)\n      setReady(false)\n    }\n    return () => {\n      if (tracks) {\n        // eslint-disable-next-line no-unused-expressions\n        tracks[0]?.close()\n        // eslint-disable-next-line no-unused-expressions\n        tracks[1]?.close()\n      }\n    }\n  }, [trackReady, error]) //, ready])\n\n  return (\n    <TracksProvider\n      value={{\n        localVideoTrack: localVideoTrack,\n        localAudioTrack: localAudioTrack\n      }}\n    >\n      {ready ? props.children : null}\n    </TracksProvider>\n  )\n}\n\nexport default TracksConfigure\n","import React, { useState, useContext, useEffect, useRef } from 'react'\nimport AgoraRTM, {\n  createLazyClient,\n  createLazyChannel,\n  RtmEvents,\n  RtmMessage\n} from 'agora-rtm-react'\nimport PropsContext from './PropsContext'\nimport {\n  RtmProvider,\n  muteRequest,\n  mutingDevice,\n  rtmStatusEnum,\n  userData,\n  popUpStateEnum,\n  messageObject\n} from './RtmContext'\nimport RtcContext from './RtcContext'\nimport AgoraRTC, { UID } from 'agora-rtc-react'\nimport { LocalContext } from './LocalUserContext'\nimport muteAudio from './Controls/Local/muteAudio'\nimport muteVideo from './Controls/Local/muteVideo'\n\nconst timeNow = () => new Date().getTime()\nconst useChannel = createLazyChannel()\nconst useClient = createLazyClient()\n/**\n * React component that contains the RTM logic. It manages the usernames, remote mute requests and provides data to the children components by wrapping them with context providers.\n */\nconst RtmConfigure = (props: any) => {\n  const { rtcProps, rtmProps } = useContext(PropsContext)\n  const [isLoggedIn, setLoggedIn] = useState<boolean>(false)\n  const rtmClient = useClient(rtcProps.appId)\n  const channel = useChannel(rtmClient, rtcProps.channel)\n  const localUid = useRef<string>('')\n  const timerValueRef: any = useRef(5)\n  const local = useContext(LocalContext)\n  const { rtmCallbacks } = useContext(PropsContext)\n  const [uidMap, setUidMap] = useState<Object>({})\n  const [usernames, setUsernames] = useState<Object>({})\n  const [userDataMap, setUserDataMap] = useState<Object>({})\n  const [popUpState, setPopUpState] = useState<popUpStateEnum>(\n    popUpStateEnum.closed\n  )\n  const [rtmStatus, setRtmStatus] = useState<rtmStatusEnum>(\n    rtmStatusEnum.offline\n  )\n  const {\n    localUid: rtcUid,\n    localAudioTrack,\n    localVideoTrack,\n    dispatch,\n    channelJoined\n  } = useContext(RtcContext)\n\n  const login = async () => {\n    const { tokenUrl } = rtcProps\n    if (tokenUrl) {\n      try {\n        const res = await fetch(\n          tokenUrl + '/rtm/' + (rtmProps?.uid || localUid.current)\n        )\n        const data = await res.json()\n        const serverToken = data.rtmToken\n        await rtmClient.login({\n          uid: rtmProps?.uid || localUid.current,\n          token: serverToken\n        })\n        timerValueRef.current = 5\n      } catch (error) {\n        setTimeout(async () => {\n          timerValueRef.current = timerValueRef.current + timerValueRef.current\n          login()\n        }, timerValueRef.current * 1000)\n      }\n    } else {\n      try {\n        await rtmClient.login({\n          uid: rtmProps?.uid || localUid.current,\n          token: rtmProps?.token || undefined\n        })\n        timerValueRef.current = 5\n      } catch (error) {\n        setTimeout(async () => {\n          timerValueRef.current = timerValueRef.current + timerValueRef.current\n          login()\n        }, timerValueRef.current * 1000)\n      }\n    }\n  }\n\n  const joinChannel = async () => {\n    try {\n      await channel.join()\n      timerValueRef.current = 5\n    } catch (error) {\n      setTimeout(async () => {\n        timerValueRef.current = timerValueRef.current + timerValueRef.current\n        joinChannel()\n      }, timerValueRef.current * 1000)\n    }\n  }\n\n  const init = async () => {\n    setRtmStatus(rtmStatusEnum.initialising)\n    // rtmProps?.uid\n    //   ? (localUid.current = String(rtmProps.uid))\n    //   :\n    rtcProps.uid\n      ? (localUid.current = String(rtcProps.uid))\n      : (localUid.current = String(timeNow()))\n\n    rtmClient.on('ConnectionStateChanged', (state, reason) => {\n      console.log(state, reason)\n    })\n\n    rtmClient.on('TokenExpired', async () => {\n      const { tokenUrl } = rtcProps\n      console.log('token expired - renewing')\n      if (tokenUrl) {\n        try {\n          const res = await fetch(\n            tokenUrl + '/rtm/' + (rtmProps?.uid || localUid.current)\n          )\n          const data = await res.json()\n          const serverToken = data.rtmToken\n          await rtmClient.renewToken(serverToken)\n          timerValueRef.current = 5\n        } catch (error) {\n          console.error('TokenExpiredError', error)\n        }\n      }\n    })\n\n    rtmClient.on('MessageFromPeer', (message, peerId) => {\n      handleReceivedMessage(message, peerId)\n    })\n\n    channel.on('ChannelMessage', (message, peerId) => {\n      handleReceivedMessage(message, peerId)\n    })\n\n    channel.on('MemberJoined', async (peerId) => {\n      await sendPeerMessage(createUserData(), peerId)\n    })\n    channel.on('MemberCountUpdated', async (count) => {\n      console.log('RTM-MemberCountUpdated: ', count)\n    })\n\n    // handle RTM callbacks\n    if (rtmCallbacks?.channel) {\n      Object.keys(rtmCallbacks.channel).map((callback) => {\n        if (rtmCallbacks.channel) {\n          channel.on(\n            callback as keyof RtmEvents.RtmChannelEvents,\n            rtmCallbacks.channel[callback]\n          )\n        }\n      })\n    } else if (rtmCallbacks?.client) {\n      Object.keys(rtmCallbacks.client).map((callback) => {\n        if (rtmCallbacks.client) {\n          rtmClient.on(\n            callback as keyof RtmEvents.RtmClientEvents,\n            rtmCallbacks.client[callback]\n          )\n        }\n      })\n    }\n\n    if (rtcProps.tokenUrl) {\n      const { tokenUrl, uid } = rtcProps\n      rtmClient.on('TokenExpired', async () => {\n        console.log('token expired')\n        const res = await fetch(tokenUrl + '/rtm/' + (uid || 0) + '/')\n        const data = await res.json()\n        const token = data.rtmToken\n        rtmClient.renewToken(token)\n      })\n    }\n\n    setRtmStatus(rtmStatusEnum.loggingIn)\n    await login()\n    setRtmStatus(rtmStatusEnum.loggedIn)\n    await joinChannel()\n    setRtmStatus(rtmStatusEnum.connected)\n    // console.log('!rtcUid', rtcUid, channelJoined)\n    setUsernames((p) => {\n      return { ...p, 0: rtmProps?.username }\n    })\n    sendChannelMessage(createUserData())\n  }\n\n  const createUserData = () => {\n    return {\n      messageType: 'UserData',\n      rtmId: rtmProps?.uid || localUid.current,\n      rtcId: rtcUid.current,\n      username: rtmProps?.username,\n      role: rtcProps.role === 'audience' ? 1 : 0,\n      uikit: {\n        platform: 'web',\n        framework: 'react',\n        version: '1.2.0'\n      },\n      agora: {\n        rtm: AgoraRTM.VERSION,\n        rtc: AgoraRTC.VERSION\n      }\n    } as userData\n  }\n\n  const sendMuteRequest = (device: mutingDevice, rtcId: UID, mute: boolean) => {\n    const forced = rtmProps?.showPopUpBeforeRemoteMute === false\n    const payload: muteRequest = {\n      messageType: 'MuteRequest',\n      device,\n      rtcId,\n      mute,\n      isForceful: forced\n    }\n    const peerId = uidMap[rtcId]\n    if (forced && !mute) {\n      console.log('cannot send force unmute request')\n    } else if (peerId) {\n      sendPeerMessage(payload, peerId)\n    } else {\n      console.log('peer not found')\n    }\n  }\n\n  const handleReceivedMessage = (message: RtmMessage, peerId: string) => {\n    let messageObject: messageObject | undefined\n    if (message.messageType === 'RAW') {\n      messageObject = parsePayload(message.rawMessage)\n    } else if (message.messageType === 'TEXT') {\n      messageObject = JSON.parse(message.text)\n    }\n    console.log(messageObject, peerId)\n    if (messageObject) {\n      switch (messageObject.messageType) {\n        case 'UserData':\n          handleReceivedUserDataMessage(messageObject)\n          break\n        case 'MuteRequest':\n          handleReceivedMuteMessage(messageObject)\n          break\n        case 'RtmDataRequest':\n          switch (messageObject.type) {\n            case 'ping':\n              handlePing(peerId)\n              break\n            case 'userData':\n              handleUserDataRequest(peerId)\n              break\n            default:\n              console.log(peerId)\n          }\n          break\n        default:\n          console.log('unknown message content')\n      }\n    } else {\n      console.log('unknown rtm message type')\n    }\n  }\n\n  const handleReceivedUserDataMessage = (userData: userData) => {\n    setUidMap((p) => {\n      return { ...p, [userData.rtcId]: userData.rtmId }\n    })\n    setUsernames((p) => {\n      return { ...p, [userData.rtcId]: userData.username }\n    })\n    setUserDataMap((p) => {\n      return { ...p, [userData.rtmId]: userData }\n    })\n    // console.log('userData', userData, userDataMap, uidMap)\n  }\n\n  const handleReceivedMuteMessage = (muteRequest: muteRequest) => {\n    // console.log('!muteRequest', muteRequest)\n    if (rtcUid.current === muteRequest.rtcId) {\n      if (muteRequest.isForceful) {\n        if (muteRequest.mute) {\n          if (muteRequest.device === mutingDevice.microphone) {\n            localAudioTrack && muteAudio(local, dispatch, localAudioTrack)\n          } else if (muteRequest.device === mutingDevice.camera) {\n            localVideoTrack && muteVideo(local, dispatch, localVideoTrack)\n          }\n        } else console.error('cannot force unmute')\n      } else {\n        if (muteRequest.device === mutingDevice.microphone) {\n          if (muteRequest.mute) setPopUpState(popUpStateEnum.muteMic)\n          else setPopUpState(popUpStateEnum.unmuteMic)\n        } else if (muteRequest.device === mutingDevice.camera) {\n          if (muteRequest.mute) setPopUpState(popUpStateEnum.muteCamera)\n          else setPopUpState(popUpStateEnum.unmuteCamera)\n        }\n      }\n    }\n  }\n\n  const handlePing = (peerId: string) => {\n    sendPeerMessage({ messageType: 'RtmDataRequest', type: 'pong' }, peerId)\n  }\n\n  const handleUserDataRequest = (peerId: string) => {\n    sendPeerMessage(createUserData(), peerId)\n  }\n\n  const sendChannelMessage = async (payload: messageObject) => {\n    const message = rtmClient.createMessage({\n      text: JSON.stringify(payload),\n      messageType: AgoraRTM.MessageType.TEXT\n    })\n    try {\n      await channel.sendMessage(message)\n    } catch (e) {\n      console.error(e)\n    }\n  }\n\n  const sendPeerMessage = async (payload: messageObject, peerId: string) => {\n    const message = rtmClient.createMessage({\n      text: JSON.stringify(payload),\n      messageType: AgoraRTM.MessageType.TEXT\n    })\n    try {\n      await rtmClient.sendMessageToPeer(message, String(peerId))\n    } catch (e) {\n      console.error(e)\n    }\n  }\n\n  const end = async () => {\n    await rtmClient.logout()\n    // await channel.leave()\n    await rtmClient.removeAllListeners()\n    // await channel.removeAllListeners()\n  }\n\n  useEffect(() => {\n    // if RTC has joined channel then init\n    if (channelJoined) {\n      init()\n      setLoggedIn(true)\n    }\n    return () => {\n      if (channelJoined) {\n        end()\n      }\n    }\n  }, [rtcProps.channel, rtcProps.appId, channelJoined])\n\n  return (\n    <RtmProvider\n      value={{\n        rtmStatus,\n        sendPeerMessage,\n        sendChannelMessage,\n        sendMuteRequest,\n        rtmClient,\n        uidMap,\n        usernames,\n        userDataMap,\n        popUpState,\n        setPopUpState\n      }}\n    >\n      {isLoggedIn ? props.children : <React.Fragment />}\n    </RtmProvider>\n  )\n}\n\nconst enc = new TextEncoder()\nconst dec = new TextDecoder()\n\n/**\n * Create an RTM raw message from any serilizable JS Object, decode using the {@link parsePayload} function\n * @param msg message object\n * @returns Uint8Array\n */\nexport const createRawMessage = (msg: any) => {\n  return enc.encode(JSON.stringify(msg))\n}\n/**\n * Decode the received RTM message or message created using {@link createRawMessage}\n * @param data encoded raw RTM message\n * @returns JS Object\n */\nexport const parsePayload = (data: BufferSource) => {\n  return JSON.parse(dec.decode(data))\n}\n\nexport default RtmConfigure\n","import React, { CSSProperties, useContext } from 'react'\nimport PropsContext from '../../PropsContext'\nimport RtmContext, { popUpStateEnum } from '../../RtmContext'\nimport RtcContext from '../../RtcContext'\nimport muteVideo from '../Local/muteVideo'\nimport { LocalContext } from '../../LocalUserContext'\nimport muteAudio from '../Local/muteAudio'\n\nfunction PopUp() {\n  const { styleProps } = useContext(PropsContext)\n  const { popUpState, setPopUpState } = useContext(RtmContext)\n  const { popUpContainer } = styleProps || {}\n  const { dispatch, localVideoTrack, localAudioTrack } = useContext(RtcContext)\n  const local = useContext(LocalContext)\n\n  return popUpState !== popUpStateEnum.closed ? (\n    <div\n      style={{\n        ...styles.container,\n        ...popUpContainer\n      }}\n    >\n      <div style={{ color: '#fff', fontSize: 18, fontWeight: 700 }}>\n        {popUpState === popUpStateEnum.muteCamera ||\n        popUpState === popUpStateEnum.muteMic\n          ? 'Mute '\n          : 'Unmute '}\n        {popUpState === popUpStateEnum.muteCamera ||\n        popUpState === popUpStateEnum.unmuteCamera\n          ? 'Camera'\n          : 'Mic'}\n        ?\n      </div>\n      <div\n        style={{\n          flexDirection: 'row',\n          display: 'flex',\n          width: '100%',\n          justifyContent: 'space-around'\n        }}\n      >\n        <div\n          onClick={() => {\n            switch (popUpState) {\n              case popUpStateEnum.muteCamera:\n                local.hasVideo &&\n                  localVideoTrack &&\n                  muteVideo(local, dispatch, localVideoTrack)\n                break\n              case popUpStateEnum.muteMic:\n                local.hasAudio &&\n                  localAudioTrack &&\n                  muteAudio(local, dispatch, localAudioTrack)\n                break\n              case popUpStateEnum.unmuteCamera:\n                !local.hasVideo &&\n                  localVideoTrack &&\n                  muteVideo(local, dispatch, localVideoTrack)\n                break\n              case popUpStateEnum.unmuteMic:\n                !local.hasAudio &&\n                  localAudioTrack &&\n                  muteAudio(local, dispatch, localAudioTrack)\n                break\n            }\n            setPopUpState(popUpStateEnum.closed)\n          }}\n          style={styles.button}\n        >\n          Confirm\n        </div>\n        <div\n          style={styles.buttonClose}\n          onClick={() => setPopUpState(popUpStateEnum.closed)}\n        >\n          Close\n        </div>\n      </div>\n    </div>\n  ) : null\n}\n\nconst styles = {\n  button: {\n    color: '#fff',\n    cursor: 'pointer',\n    borderWidth: 2,\n    borderStyle: 'solid',\n    borderColor: '#fff',\n    padding: '2px 4px',\n    borderRadius: 4\n  } as CSSProperties,\n  buttonClose: {\n    color: '#fff',\n    cursor: 'pointer',\n    borderWidth: 2,\n    borderStyle: 'solid',\n    borderColor: '#fff',\n    padding: '2px 4px',\n    borderRadius: 4\n  },\n  container: {\n    backgroundColor: '#007bffaa',\n    position: 'absolute',\n    width: 240,\n    height: 80,\n    top: '50%',\n    left: '50%',\n    transform: 'translate(-50%, -50%)',\n    zIndex: 100,\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'space-evenly',\n    alignItems: 'center'\n  } as CSSProperties\n}\n\nexport default PopUp\n","/**\n * @module AgoraUIKit\n */\nimport React, { useContext } from 'react'\nimport RtcConfigure from './RTCConfigure'\nimport PropsContext, {\n  PropsProvider,\n  PropsInterface,\n  layout\n} from './PropsContext'\nimport LocalControls from './Controls/LocalControls'\nimport PinnedVideo from './PinnedVideo'\nimport GridVideo from './GridVideo'\nimport TracksConfigure from './TracksConfigure'\nimport RtmConfigure from './RTMConfigure'\nimport LocalUserContext from './LocalUserContext'\nimport PopUp from './Controls/Remote/RemoteMutePopUp'\n\n/**\n * High level component to render the UI Kit\n * @param props {@link PropsInterface}\n */\nconst AgoraUIKit: React.FC<PropsInterface> = (props) => {\n  const { styleProps, rtcProps } = props\n  const { UIKitContainer } = styleProps || {}\n\n  return (\n    <PropsProvider value={props}>\n      <div\n        style={{\n          ...style,\n          ...UIKitContainer\n        }}\n      >\n        {rtcProps.role === 'audience' ? (\n          <VideocallUI />\n        ) : (\n          <TracksConfigure>\n            <VideocallUI />\n          </TracksConfigure>\n        )}\n      </div>\n    </PropsProvider>\n  )\n}\n\nexport const VideocallUI = () => {\n  const { rtcProps } = useContext(PropsContext)\n  return (\n    <RtcConfigure callActive={rtcProps.callActive}>\n      <LocalUserContext>\n        {rtcProps.disableRtm ? (\n          <React.Fragment>\n            {rtcProps?.layout === layout.grid ? <GridVideo /> : <PinnedVideo />}\n            <LocalControls />\n          </React.Fragment>\n        ) : (\n          <RtmConfigure>\n            <PopUp />\n            {rtcProps?.layout === layout.grid ? <GridVideo /> : <PinnedVideo />}\n            <LocalControls />\n          </RtmConfigure>\n        )}\n      </LocalUserContext>\n    </RtcConfigure>\n  )\n}\n\nconst style = {\n  display: 'flex',\n  flex: 1,\n  minHeight: 0,\n  flexDirection: 'column'\n} as React.CSSProperties\n\nexport default AgoraUIKit\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}